<Type Name="WebPartConnection" FullName="System.Web.UI.WebControls.WebParts.WebPartConnection">
  <Metadata><Meta Name="ms.openlocfilehash" Value="1d5d0fe79b1ff03367e8aba77257b26c4e72e0f2" /><Meta Name="ms.sourcegitcommit" Value="6b9d64332f31de312efea785fbb19e4d80f544d5" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="06/12/2019" /><Meta Name="ms.locfileid" Value="67026467" /></Metadata><TypeSignature Language="C#" Value="public sealed class WebPartConnection" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit WebPartConnection extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Web.UI.WebControls.WebParts.WebPartConnection" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class WebPartConnection" />
  <TypeSignature Language="C++ CLI" Value="public ref class WebPartConnection sealed" />
  <TypeSignature Language="F#" Value="type WebPartConnection = class" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.ComponentModel.TypeConverter(typeof(System.ComponentModel.ExpandableObjectConverter))</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Web.UI.ParseChildren(true, "Transformers")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="c9af2-101">提供一个对象，该对象可使两个 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控件形成连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-101">Provides an object that enables two <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> controls to form a connection.</span></span> <span data-ttu-id="c9af2-102">此类不能被继承。</span><span class="sxs-lookup"><span data-stu-id="c9af2-102">This class cannot be inherited.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-103">在 Web 部件控件集，连接是链接或两个之间的关联<xref:System.Web.UI.WebControls.WebParts.WebPart>（或其他服务器或用户） 可以共享数据的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-103">In the Web Parts control set, a connection is a link or association between two <xref:System.Web.UI.WebControls.WebParts.WebPart> (or other server or user) controls that enables them to share data.</span></span> <span data-ttu-id="c9af2-104">此功能共享数据可让连接的控件以在超过由独立的控件提供的功能的方法中使用。</span><span class="sxs-lookup"><span data-stu-id="c9af2-104">This ability to share data allows connected controls to be used in ways that exceed the functionality offered by the isolated controls.</span></span> <span data-ttu-id="c9af2-105">例如，如果一个控件提供了邮政编码数据，另一个控件可以读取该数据并提供基于邮政编码的本地天气信息，然后两个控件的连接的功能提供更多价值给用户。</span><span class="sxs-lookup"><span data-stu-id="c9af2-105">For example, if one control provides postal code data, and another control can read that data and provide local weather information based on the postal code, then the connected capability of the two controls provides more value to users.</span></span> <span data-ttu-id="c9af2-106">若要扩展此示例中，可以创建其他控件，它还基于邮政编码，如与本地新闻的链接控件的显示信息和可以使用邮政编码数据的所有这些控件可以与提供的单个控件共享数据邮政编码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-106">To extend this example, other controls could be created that also display information based on a postal code, such as a control with links to local news, and all these controls that can work with postal code data could share data with the single control that provides a postal code.</span></span> <span data-ttu-id="c9af2-107">Web 部件应用程序的最终用户可以创建和管理直接从 Web 浏览器中，使用标准连接用户界面 (UI) 提供的所有此类兼容的控件之间的连接<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控件，或使用提供的自定义 UI开发人员。</span><span class="sxs-lookup"><span data-stu-id="c9af2-107">End users of Web Parts applications can create and manage connections between all such compatible controls directly from a Web browser, using the standard connections user interface (UI) provided by the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control, or using a custom UI provided by a developer.</span></span>  
  
 <span data-ttu-id="c9af2-108">这<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>类概述是用于创建连接的基本详细信息的常规语句。</span><span class="sxs-lookup"><span data-stu-id="c9af2-108">This <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class overview is a general statement of the basic details for creating a connection.</span></span> <span data-ttu-id="c9af2-109">有关特定组件和创建连接所涉及的要求的详细信息，请参阅[Web 部件连接概述](https://docs.microsoft.com/previous-versions/aspnet/ms178187(v=vs.100))，或请参阅引用类和代码示例下面的讨论中所述。</span><span class="sxs-lookup"><span data-stu-id="c9af2-109">For more on specific components and requirements involved in creating connections, see [Web Parts Connections Overview](https://docs.microsoft.com/previous-versions/aspnet/ms178187(v=vs.100)), or see the reference classes and code examples mentioned in the following discussion.</span></span> <span data-ttu-id="c9af2-110">有几个基本方面的 Web 部件连接：</span><span class="sxs-lookup"><span data-stu-id="c9af2-110">There are several fundamental aspects of a Web Parts connection:</span></span>  
  
-   <span data-ttu-id="c9af2-111">两个<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-111">Two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-112">每个 Web 部件连接中包含两个控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-112">Every Web Parts connection consists of two controls.</span></span> <span data-ttu-id="c9af2-113">可以为控件同时参与多个连接但每个单个连接两个控件组成。</span><span class="sxs-lookup"><span data-stu-id="c9af2-113">It is possible for a control to participate in more than one connection simultaneously, but every single connection consists of exactly two controls.</span></span> <span data-ttu-id="c9af2-114">控件可以直接从派生<xref:System.Web.UI.WebControls.WebParts.WebPart>基类，也可以是其他服务器控件，包括 ASP.NET 控件、 自定义服务器控件和用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-114">The controls can derive directly from the <xref:System.Web.UI.WebControls.WebParts.WebPart> base class, or they can be other server controls, including ASP.NET controls, custom server controls, and user controls.</span></span> <span data-ttu-id="c9af2-115">无法从元素派生的控件<xref:System.Web.UI.WebControls.WebParts.WebPart>类中，如果按放置<xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase>区域，请使用自动换行<xref:System.Web.UI.WebControls.WebParts.GenericWebPart>对象在运行时，使他们能够继承<xref:System.Web.UI.WebControls.WebParts.WebPart>类和函数运行时作为<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-115">Controls that do not derive from the <xref:System.Web.UI.WebControls.WebParts.WebPart> class, if placed in a <xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase> zone, are automatically wrapped with a <xref:System.Web.UI.WebControls.WebParts.GenericWebPart> object at run time, which enables them to inherit from the <xref:System.Web.UI.WebControls.WebParts.WebPart> class and function as run-time <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span>  
  
-   <span data-ttu-id="c9af2-116">控件位于<xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase>区域。</span><span class="sxs-lookup"><span data-stu-id="c9af2-116">Controls residing in <xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase> zones.</span></span> <span data-ttu-id="c9af2-117">这两<xref:System.Web.UI.WebControls.WebParts.WebPart>控件和任何其他类型的服务器控件必须驻留在<xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase>区域能够参与 Web 部件连接 （以及大多数其他 Web 部件功能）。</span><span class="sxs-lookup"><span data-stu-id="c9af2-117">Both <xref:System.Web.UI.WebControls.WebParts.WebPart> controls and any other type of server control must reside in a <xref:System.Web.UI.WebControls.WebParts.WebPartZoneBase> zone to be able to participate in Web Parts connections (and most other Web Parts features).</span></span>  
  
-   <span data-ttu-id="c9af2-118">使用者和提供程序。</span><span class="sxs-lookup"><span data-stu-id="c9af2-118">Consumers and providers.</span></span> <span data-ttu-id="c9af2-119">每个 Web 部件连接中有两个控件： 数据和数据的使用者的提供程序。</span><span class="sxs-lookup"><span data-stu-id="c9af2-119">In every Web Parts connection there are two controls: a provider of data and a consumer of data.</span></span> <span data-ttu-id="c9af2-120">提供程序数据提供给使用者通过接口的形式返回数据的指定的回调方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-120">The provider furnishes data to the consumer through a specified callback method that returns data in the form of an interface.</span></span> <span data-ttu-id="c9af2-121">（有关如何创建和指定的回调方法的示例，请参阅本主题的示例部分）。此回调方法被称为提供者连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-121">(For an example of how to create and specify the callback method, see the Example section of this topic.) This callback method is known as a provider connection point.</span></span> <span data-ttu-id="c9af2-122">此连接点 （其"友好"名称、 ID 和返回的接口的类型） 的详细信息包含在<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>与提供者控件关联的对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-122">The details of this connection point (its "friendly" name, an ID, and the type of the returned interface) are contained in a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object associated with the provider control.</span></span> <span data-ttu-id="c9af2-123">通过指定的方法可以接受接口的实例，使用者接收的数据。</span><span class="sxs-lookup"><span data-stu-id="c9af2-123">The consumer receives the data through a specified method that can accept an instance of the interface.</span></span> <span data-ttu-id="c9af2-124">此方法称为使用者连接点，并且连接点 （名称、 ID 和类型的接口） 的详细信息包含在<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>与使用者控件关联的对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-124">This method is known as a consumer connection point, and the details of the connection point (name, ID, and type of interface) are contained in a <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object associated with the consumer control.</span></span>  
  
-   <span data-ttu-id="c9af2-125">兼容的控件或有效的转换器。</span><span class="sxs-lookup"><span data-stu-id="c9af2-125">Compatible controls or a valid transformer.</span></span> <span data-ttu-id="c9af2-126">若要运行的连接，为使用者和提供程序必须是兼容 （即其指定的连接点方法可以使用相同类型的接口） 或必须是<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>能够转换所提供的类型的对象使用者所理解的类型到提供程序。</span><span class="sxs-lookup"><span data-stu-id="c9af2-126">For a connection to work, the consumer and provider must either be compatible (meaning that their specified connection point methods can work with the same type of interface), or there must be a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object capable of translating the type offered by the provider into a type understood by the consumer.</span></span>  
  
-   <span data-ttu-id="c9af2-127">一个 <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> 对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-127">A <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span> <span data-ttu-id="c9af2-128">连接存在，必须有的一个实例<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>类，其中包含对提供程序和使用者控件，以及它们的连接点的详细信息的引用。</span><span class="sxs-lookup"><span data-stu-id="c9af2-128">For a connection to exist, there must be an instance of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class that contains references to the provider and consumer controls, along with the details of their connection points.</span></span> <span data-ttu-id="c9af2-129">如果提供程序和使用者不兼容，并改为使用<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>对象进行连接，连接引用转换器。</span><span class="sxs-lookup"><span data-stu-id="c9af2-129">If the provider and consumer are incompatible and instead use a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object to connect, the connection references the transformer.</span></span>  
  
-   <span data-ttu-id="c9af2-130">建立连接的方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-130">A means of establishing the connection.</span></span> <span data-ttu-id="c9af2-131">兼容的使用者和提供者控件具有已正确使用连接点方法设计并放置在一个区域后和<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>对象可用，最后一个必要的基本步骤是启动连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-131">After compatible consumer and provider controls have been properly designed with connection point methods and placed in a zone, and a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object is available, the last basic step necessary is to initiate the connection.</span></span> <span data-ttu-id="c9af2-132">发生这种情况的一种方法是为用户创建通过用户界面的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-132">One way this can happen is for users to create the connection through the UI.</span></span> <span data-ttu-id="c9af2-133">如果将置于`<asp:connectionszone>`元素上的网页和其他所需组件的连接是到位，请在运行时用户可以将页切换到连接显示模式，单击连接上的谓词提供程序或使用者的谓词菜单并连接用户界面 (基于<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控件) 将出现。</span><span class="sxs-lookup"><span data-stu-id="c9af2-133">If you place an `<asp:connectionszone>` element on the page, and the other required components for a connection are in place, at run time a user can switch the page into connect display mode, click a connect verb on the verbs menu of either the provider or consumer, and a connection UI (based on the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control) will appear.</span></span> <span data-ttu-id="c9af2-134">通过此 UI，用户可以发起连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-134">Through this UI, the user can initiate the connection.</span></span> <span data-ttu-id="c9af2-135">若要启动连接的另一种方法是以编程方式执行。</span><span class="sxs-lookup"><span data-stu-id="c9af2-135">Another way to initiate the connection is to do it programmatically.</span></span> <span data-ttu-id="c9af2-136">在任一情况下，是否通过用户界面或以编程方式，基础方法，启动的连接是相同的。</span><span class="sxs-lookup"><span data-stu-id="c9af2-136">In either case, whether through the UI or programmatically, the underlying method that initiates the connection is the same.</span></span> <span data-ttu-id="c9af2-137">应用程序调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法 (或<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法，如果使用的转换器) 上<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件，将其传递给提供程序、 使用者和其各自的连接点对象，然后该方法将返回<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-137">The application calls the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method (or the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method if using a transformer) on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control, passing to it the provider, the consumer, and their respective connection point objects, and the method returns a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span>  
  
 <span data-ttu-id="c9af2-138"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection>类定义封装两个连接的重要详细信息的对象<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-138">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class defines an object that encapsulates the essential details of a connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-139">类包含几乎完全与特定连接的详细信息相关的属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-139">The class consists almost entirely of properties related to the details of a particular connection.</span></span> <span data-ttu-id="c9af2-140">多个属性与连接中的使用者控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-140">Several properties concern the consumer control in a connection.</span></span> <span data-ttu-id="c9af2-141"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>属性引用本身的使用者控件和<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>属性引用使用者的 id。</span><span class="sxs-lookup"><span data-stu-id="c9af2-141">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property references the consumer control itself, and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property references the consumer's ID.</span></span> <span data-ttu-id="c9af2-142"><xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>对象，其中包含使用者的连接点的详细信息，由使用者的引用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-142">The <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object, which contains the details of the consumer's connection point, is referenced by the consumer's <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property.</span></span> <span data-ttu-id="c9af2-143"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>属性引用的 ID<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-143">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property references the ID of the <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object.</span></span> <span data-ttu-id="c9af2-144">所有这些与使用者相关的连接属性必须具有值分配给他们创建的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-144">All these consumer-related connection properties must have a value assigned to them to create a connection.</span></span>  
  
 <span data-ttu-id="c9af2-145"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection>类还具有几个与属性，在连接提供者控件和这些使用者对应于属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-145">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class also has several properties that relate to the provider control in a connection, and these correspond to the properties for a consumer.</span></span> <span data-ttu-id="c9af2-146"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>属性引用的提供者控件本身，而<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>属性引用其 id。</span><span class="sxs-lookup"><span data-stu-id="c9af2-146">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property references the provider control itself, while the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property references its ID.</span></span> <span data-ttu-id="c9af2-147"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>属性引用<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>对象，和<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>属性引用的提供者连接点的 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-147">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property references the <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object, and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property references the ID of the provider's connection point.</span></span>  
  
 <span data-ttu-id="c9af2-148">多个属性与连接的状态。</span><span class="sxs-lookup"><span data-stu-id="c9af2-148">Several properties concern the state of the connection.</span></span> <span data-ttu-id="c9af2-149"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A>属性指示连接是否处于活动状态 （当前交换数据） 或处于非活动状态 （仍已连接，但不是主动共享数据）。</span><span class="sxs-lookup"><span data-stu-id="c9af2-149">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A> property indicates whether the connection is active (currently exchanging data) or inactive (still connected but not actively sharing data).</span></span> <span data-ttu-id="c9af2-150"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>属性指示连接是否已在不共享 （适用于页的所有用户） 或特定于用户的连接，并<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>属性指示该控件是静态的 （声明在页标记中并因此是永久） 或动态 （以编程方式创建，这意味着它可以被删除）。</span><span class="sxs-lookup"><span data-stu-id="c9af2-150">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property indicates whether the connection is a shared (available to all users of a page) or a user-specific connection, and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> property indicates whether the control is static (declared in the page markup and thus permanent) or dynamic (created programmatically, meaning that it can be deleted).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-151">下面的代码示例演示如何创建两个之间的简单连接<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-151">The following code example demonstrates how to create a simple connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-152">该示例演示三种方式建立连接： 以声明方式，通过将连接标记放置在 Web 页在标记中以编程方式，通过在代码; 中创建连接并通过用户界面，通过将放置<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控件在页上，使用户能够建立的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-152">The example demonstrates three ways of forming a connection: declaratively, by placing tags for the connection in the markup of the Web page; programmatically, by creating the connection in code; and through the UI, by placing a <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control on the page, which enables users to establish a connection.</span></span>  
  
 <span data-ttu-id="c9af2-153">代码示例包含四个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-153">The code example has four parts:</span></span>  
  
-   <span data-ttu-id="c9af2-154">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-154">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-155">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-155">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-156">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-156">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-157">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-157">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-158">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-158">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-159">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-159">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-160">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-160">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Overview#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_Overview#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-161">代码示例的第二部分是为接口和控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-161">The second part of the code example is the source code for the interface and controls.</span></span> <span data-ttu-id="c9af2-162">源代码文件包含一个简单的接口名为`IZipCode`。</span><span class="sxs-lookup"><span data-stu-id="c9af2-162">The source file contains a simple interface named `IZipCode`.</span></span> <span data-ttu-id="c9af2-163">此外，还有<xref:System.Web.UI.WebControls.WebParts.WebPart>类名为`ZipCodeWebPart`的实现接口，并充当提供者控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-163">There is also a <xref:System.Web.UI.WebControls.WebParts.WebPart> class named `ZipCodeWebPart` that implements the interface and acts as the provider control.</span></span> <span data-ttu-id="c9af2-164">其`ProvideIZipCode`方法是实现接口的唯一成员的回调方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-164">Its `ProvideIZipCode` method is the callback method that implements the interface's only member.</span></span> <span data-ttu-id="c9af2-165">该方法只需返回接口的实例。</span><span class="sxs-lookup"><span data-stu-id="c9af2-165">The method simply returns an instance of the interface.</span></span> <span data-ttu-id="c9af2-166">请注意，该方法标记与`ConnectionProvider`其元数据中的属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-166">Note that the method is marked with a `ConnectionProvider` attribute in its metadata.</span></span> <span data-ttu-id="c9af2-167">这是用于标识提供者连接点的回调方法作为该方法的机制。</span><span class="sxs-lookup"><span data-stu-id="c9af2-167">This is the mechanism for identifying the method as the callback method for the provider's connection point.</span></span> <span data-ttu-id="c9af2-168">另<xref:System.Web.UI.WebControls.WebParts.WebPart>类命名为`WeatherWebPart`，并充当使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-168">The other <xref:System.Web.UI.WebControls.WebParts.WebPart> class is named `WeatherWebPart`, and it acts as the consumer for the connection.</span></span> <span data-ttu-id="c9af2-169">此类有一个名为方法`GetZipCode`获取的实例`IZipCode`从提供者控件的接口。</span><span class="sxs-lookup"><span data-stu-id="c9af2-169">This class has a method named `GetZipCode` that gets an instance of the `IZipCode` interface from the provider control.</span></span> <span data-ttu-id="c9af2-170">请注意，此方法标记为与使用者的连接点方法`ConnectionConsumer`其元数据中的属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-170">Note that this method is marked as the consumer's connection point method with a `ConnectionConsumer` attribute in its metadata.</span></span>  
  
 <span data-ttu-id="c9af2-171">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-171">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-172">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-172">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-173">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-173">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-174">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-174">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-175">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-175">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_Overview#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_Overview#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-176">代码示例的第三部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-176">The third part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-177">顶部附近是`Register`用户控件和自定义指令<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-177">Near the top are the `Register` directives for the user control and the custom <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-178">该示例假定动态编译的控件，因为控件的源代码应采用的 App_Code 子文件夹中;`Register`页中的标记引用仅任意标记前缀和控件的命名空间。</span><span class="sxs-lookup"><span data-stu-id="c9af2-178">Because the example assumes dynamic compilation of the controls, the source code for the controls should be in an App_Code subfolder; the `Register` tag in the page references only an arbitrary tag prefix and the namespace of the controls.</span></span> <span data-ttu-id="c9af2-179">自定义<xref:System.Web.UI.WebControls.WebParts.WebPart>控件 （提供程序和使用者） 声明 Web 页内`<asp:webpartzone>`元素中，内部`<zonetemplate>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-179">The custom <xref:System.Web.UI.WebControls.WebParts.WebPart> controls (the provider and consumer) are declared within the Web page's `<asp:webpartzone>` element, inside a `<zonetemplate>` element.</span></span>  
  
 <span data-ttu-id="c9af2-180">页提供了三种方式自定义控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-180">The page provides three ways to form a connection between the custom controls.</span></span> <span data-ttu-id="c9af2-181">第一种方法是声明性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-181">The first method is declarative.</span></span> <span data-ttu-id="c9af2-182">页上，在标记中`<StaticConnections>`元素声明，并在其中是`<asp:WebPartConnections>`元素中，并且为属性指定的连接的各种使用者和提供程序详细信息。</span><span class="sxs-lookup"><span data-stu-id="c9af2-182">In the markup for the page, a `<StaticConnections>` element is declared, and within that is an `<asp:WebPartConnections>` element, with the various consumer and provider details of the connection specified as attributes.</span></span> <span data-ttu-id="c9af2-183">这是一种方法创建的连接，具体而言是在直接在 Web 页中，声明`<asp:WebPartManager>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-183">This is one way to create a connection, by declaring it directly in the Web page, specifically within the `<asp:WebPartManager>` element.</span></span> <span data-ttu-id="c9af2-184">由于此静态连接，立即在页面加载的第一次创建两个自定义控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-184">Because of this static connection, a connection between the two custom controls is created immediately the first time the page loads.</span></span>  
  
 <span data-ttu-id="c9af2-185">构成控件之间的连接的第二个方法提供的`<asp:connectionszone>`页中的元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-185">A second method for forming a connection between the controls is provided by the `<asp:connectionszone>` element in the page.</span></span> <span data-ttu-id="c9af2-186">如果用户在运行时，将页切换为连接显示模式，并单击其中一个自定义控件上的连接谓词`<asp:connectionszone>`元素自动呈现的 UI 创建的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-186">If a user switches a page into connect display mode at run time, and clicks a connect verb on one of the custom controls, the `<asp:connectionszone>` element automatically renders the UI for creating a connection.</span></span>  
  
 <span data-ttu-id="c9af2-187">该页还演示了创建的连接，这是以编程方式执行第三种的方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-187">The page also demonstrates a third way of creating a connection, which is to do it programmatically.</span></span> <span data-ttu-id="c9af2-188">在中`Button1_Click`方法，该代码会创建<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>的对象提供程序控件，并检索其连接点的详细信息通过调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-188">In the `Button1_Click` method, the code creates a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object for the provider control, and retrieves its connection point details by calling the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints%2A> method.</span></span> <span data-ttu-id="c9af2-189">其执行的使用者控件类似的任务调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetConsumerConnectionPoints%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-189">It carries out a similar task for the consumer control, calling the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetConsumerConnectionPoints%2A> method.</span></span> <span data-ttu-id="c9af2-190">最后，它会创建新<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>对象通过调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-190">Finally, it creates the new <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object by calling the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Overview#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_Overview#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Overview/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-191">加载 Web 页在浏览器中后，第一个连接已存在的原因内声明了`<StaticConnections>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-191">After you load the Web page in a browser, the first connection already exists because it is declared within the `<StaticConnections>` element.</span></span> <span data-ttu-id="c9af2-192">输入中的某些文本**ZIP 代码提供程序**控件使用，而且将在使用者控件中显示。</span><span class="sxs-lookup"><span data-stu-id="c9af2-192">Enter some text in the **ZIP Code Provider** control, and it will be displayed in the consumer control.</span></span> <span data-ttu-id="c9af2-193">接下来，断开连接的两个控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-193">Next, disconnect the two controls.</span></span> <span data-ttu-id="c9af2-194">使用**显示模式**下拉列表控件中，更改页后，可以连接显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-194">Using the **Display Mode** drop-down list control, change the page to connect display mode.</span></span> <span data-ttu-id="c9af2-195">单击 （标题栏中的向下箭头表示） 的谓词菜单的每个<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，并请注意，每个都**Connect**选项。</span><span class="sxs-lookup"><span data-stu-id="c9af2-195">Click the verbs menu (represented by a downward arrow in the title bar) for each of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and notice that each has a **Connect** option.</span></span> <span data-ttu-id="c9af2-196">这是连接动词的谓词菜单中显示页面时才在连接模式下。</span><span class="sxs-lookup"><span data-stu-id="c9af2-196">This is a connect verb, which appears in the verbs menu only when the page is in connect mode.</span></span> <span data-ttu-id="c9af2-197">单击其中一个控件，并连接所提供的用户界面上连接谓词<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>显示控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-197">Click the connect verb on one of the controls, and the connection UI provided by the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control appears.</span></span> <span data-ttu-id="c9af2-198">单击**断开连接**按钮结束控件之间的静态连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-198">Click the **Disconnect** button to end the static connection between the controls.</span></span> <span data-ttu-id="c9af2-199">使用**显示模式**控件以返回页后，可以浏览模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-199">Use the **Display Mode** control to return the page to browse mode.</span></span> <span data-ttu-id="c9af2-200">请尝试再次，在提供程序中输入一些新的文本，并记下控件断开连接，因为文本不能更新使用者控件中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-200">Try to enter some new text in the provider again, and note that because the controls are disconnected, the text fails to update in the consumer control.</span></span>  
  
 <span data-ttu-id="c9af2-201">接下来，使用与上述相同的方法将页切换到连接显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-201">Next, use the same method as above to switch the page into connect display mode again.</span></span> <span data-ttu-id="c9af2-202">单击其中一个控件上的连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-202">Click a connect verb on one of the controls.</span></span> <span data-ttu-id="c9af2-203">单击**创建的连接**链接，并使用提供的用户界面<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控件创建控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-203">Click the **Create a Connection** link, and use the UI provided by the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control to create a connection between the controls.</span></span> <span data-ttu-id="c9af2-204">这是用于创建连接的第二个方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-204">This is the second method for creating a connection.</span></span> <span data-ttu-id="c9af2-205">请注意，一旦建立连接，最后一个字符串中输入的提供程序控件 （未显示，因为控件已断开连接） 会立即出现在使用者，因为已重新创建连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-205">Note that as soon as the connection is formed, the last string you entered in the provider control (that failed to appear because the controls were disconnected) suddenly appears in the consumer, because the connection has been recreated.</span></span> <span data-ttu-id="c9af2-206">单击**断开连接**按钮来终止您刚创建的当前连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-206">Click the **Disconnect** button to end the current connection that you just created.</span></span> <span data-ttu-id="c9af2-207">返回页后，可以浏览模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-207">Return the page to browse mode.</span></span> <span data-ttu-id="c9af2-208">要演示的文本不会更新，以及控件再次断开连接的提供程序中输入一些新的文本。</span><span class="sxs-lookup"><span data-stu-id="c9af2-208">Enter some new text in the provider to demonstrate that the text is not updated, and that the controls are again disconnected.</span></span>  
  
 <span data-ttu-id="c9af2-209">返回页后，可以连接显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-209">Return the page to connect display mode.</span></span> <span data-ttu-id="c9af2-210">而不是单击连接谓词，单击**连接 web 部件控件**按钮，说明了建立连接的第三个方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-210">Instead of clicking a connect verb, click the **Connect WebPart Controls** button, which illustrates the third method of forming a connection.</span></span> <span data-ttu-id="c9af2-211">这种方法连接控件以编程方式在一个简单的步骤中，而无需使用<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-211">This approach connects the controls programmatically in one simple step without having to use the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control.</span></span> <span data-ttu-id="c9af2-212">请注意，当创建连接后，您突然输入提供程序中的最后一个字符串将显示在使用者控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-212">Note that as the connection is created, the last string you entered in the provider suddenly appears in the consumer control.</span></span>  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Web.UI.WebControls.WebParts.ConnectionPoint" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartManager" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.ConnectionsZone" />
    <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />
    <altmember cref="M:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts(System.Web.UI.WebControls.WebParts.WebPart,System.Web.UI.WebControls.WebParts.ProviderConnectionPoint,System.Web.UI.WebControls.WebParts.WebPart,System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint)" />
    <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/ms178187(v=vs.100)"><span data-ttu-id="c9af2-213">Web 部件连接概述</span><span class="sxs-lookup"><span data-stu-id="c9af2-213">Web Parts Connections Overview</span></span></related>
    <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-214">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-214">ASP.NET Web Parts Controls</span></span></related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public WebPartConnection ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.WebPartConnection.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; WebPartConnection();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c9af2-215">初始化 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="c9af2-215">Initializes a new instance of the <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-216"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.%23ctor%2A>构造函数是公共的因此 ASP.NET 分析器可以创建实例，当在 Web 页的标记中声明一个连接; 此构造函数不应在开发人员代码中使用。</span><span class="sxs-lookup"><span data-stu-id="c9af2-216">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.%23ctor%2A> constructor is public so that the ASP.NET parser can create an instance when a connection is declared in the markup of a Web page; this constructor is not intended to be used in developer code.</span></span>  
  
 <span data-ttu-id="c9af2-217">如果想要创建<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>对象以编程方式，应使用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A?displayProperty=nameWithType>或<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A?displayProperty=nameWithType>方法中提供<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-217">When you want to create a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object programmatically, you should use the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A?displayProperty=nameWithType> or the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A?displayProperty=nameWithType> method provided in the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control.</span></span> <span data-ttu-id="c9af2-218">这些方法处理的许多详细信息创建连接，并返回<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-218">These methods handle the many details of creating a connection, and return a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span>  
  
 <span data-ttu-id="c9af2-219"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.%23ctor%2A>构造函数<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>类设置的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>并<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>属性设置为`true`。</span><span class="sxs-lookup"><span data-stu-id="c9af2-219">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.%23ctor%2A> constructor for the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> class sets the values of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> and <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> properties to `true`.</span></span> <span data-ttu-id="c9af2-220">因此，新的连接的默认状态是静态的 （这意味着在对包含网页的标记中声明） 和共享 （页上的所有用户可见）。</span><span class="sxs-lookup"><span data-stu-id="c9af2-220">Thus the default state of a new connection is to be static (meaning that it is declared in the markup of the containing Web page) and shared (visible to all users of the page).</span></span> <span data-ttu-id="c9af2-221">通过声明的标记中的页的连接，在典型的方案中，添加连接时，会遇到这种情况`<asp:webpartconnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-221">This will be the case when you add a connection in the typical scenario, by declaring the connection in the markup of the page with an `<asp:webpartconnection>` element.</span></span> <span data-ttu-id="c9af2-222">但是，在其他情况下连接将具有这些属性的不同值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-222">However, in other circumstances a connection will have different values for these properties.</span></span> <span data-ttu-id="c9af2-223">例如，当您添加的连接以编程方式在代码中，创建连接对象以及用户在默认用户个性化设置范围中查看页面，则连接创建为动态的每个 user(visible only to the specific user)连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-223">For example, when you add a connection programmatically by creating the connection object in code, and the user is viewing the page in the default user personalization scope, the connection is created as a dynamic, per-user(visible only to the specific user) connection.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c9af2-224"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>并<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>属性是只读的并会在内部设置这些属性用于确定连接的性质<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件，具体取决于如何创建的连接 (以声明方式在页标记中，或以编程方式通过代码或用户界面）。</span><span class="sxs-lookup"><span data-stu-id="c9af2-224">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> and <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> properties are read-only, and these properties that determine the nature of a connection are set internally by the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control depending on how a connection is created (declaratively in the page markup, or programmatically through your code or the user interface).</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts(System.Web.UI.WebControls.WebParts.WebPart,System.Web.UI.WebControls.WebParts.ProviderConnectionPoint,System.Web.UI.WebControls.WebParts.WebPart,System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint)" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-225">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-225">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Consumer">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.WebPart Consumer { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.WebPart Consumer" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Consumer As WebPart" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::WebPart ^ Consumer { System::Web::UI::WebControls::WebParts::WebPart ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Consumer : System.Web.UI.WebControls.WebParts.WebPart" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.WebPart</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-226">获取一个作为连接中的使用者控件的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-226">Gets a <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> object that is acting as the consumer control in a connection.</span></span></summary>
        <value><span data-ttu-id="c9af2-227">一个 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" />，表示作为连接中的使用者的 Web 部件控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-227">A <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> that represents the Web Parts control acting as the consumer in a connection.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-228">每个 Web 部件连接包含共享数据的两个控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-228">Every Web Parts connection consists of two controls that share data.</span></span> <span data-ttu-id="c9af2-229">一个控件充当数据的提供程序和其他控件充当使用者接收和处理从提供程序的数据。</span><span class="sxs-lookup"><span data-stu-id="c9af2-229">One control acts as the provider of data, and the other control acts as a consumer, receiving and processing the data from the provider.</span></span> <span data-ttu-id="c9af2-230"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>属性获取对<xref:System.Web.UI.WebControls.WebParts.WebPart>控件的控件作为连接关系中的使用者。</span><span class="sxs-lookup"><span data-stu-id="c9af2-230">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property gets a reference to the <xref:System.Web.UI.WebControls.WebParts.WebPart> control acting as a consumer in a connection relationship.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-231">下面的代码示例演示如何以编程方式将<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-231">The following code example demonstrates the programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-232">代码示例包含四个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-232">The code example has four parts:</span></span>  
  
-   <span data-ttu-id="c9af2-233">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-233">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-234">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-234">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-235">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-235">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-236">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-236">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-237">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-237">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-238">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-238">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-239">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-239">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Consumer#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_Consumer#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-240">代码示例的第二部分是为两个源代码<xref:System.Web.UI.WebControls.WebParts.WebPart>充当使用者和提供程序连接，以及用于连接点的接口的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-240">The second part of the code example is the source code for the two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls that serve as the consumer and the provider for the connection, and an interface used for the connection points.</span></span> <span data-ttu-id="c9af2-241">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-241">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-242">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-242">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-243">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-243">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-244">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-244">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-245">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-245">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_Consumer#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_Consumer#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-246">代码示例的第三个部分是 Web 页面承载的控件，并演示如何使用代码<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-246">The third part of the code example is the code for the Web page that hosts the controls and demonstrates the use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property.</span></span> <span data-ttu-id="c9af2-247">页面顶部附近是`Register`用于用户控件和自定义控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-247">Near the top of the page are the `Register` directives for the user control and the custom controls.</span></span> <span data-ttu-id="c9af2-248">因为此示例使用动态编译`Register`指令的源文件不需要引用程序集名称，其中包括仅任意标记前缀和控件的命名空间。</span><span class="sxs-lookup"><span data-stu-id="c9af2-248">Because this example uses dynamic compilation, the `Register` directive for the source file does not need to reference an assembly name; it includes only an arbitrary tag prefix and the namespace of the controls.</span></span> <span data-ttu-id="c9af2-249">在中`Button2_Click`方法中，代码访问通过连接对象<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件，并获取对使用者控件的引用。</span><span class="sxs-lookup"><span data-stu-id="c9af2-249">In the `Button2_Click` method, the code accesses the connection object through the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control, and gets a reference to the consumer control.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Consumer#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_Consumer#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Consumer/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-250">加载浏览器中的页面后，使用**显示模式**要切换页可连接模式下的下拉列表控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-250">After you load the page in a browser, use the **Display Mode** drop-down list control to switch the page to connect mode.</span></span> <span data-ttu-id="c9af2-251">单击 （标题栏中的向下箭头表示） 之一上的谓词菜单<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，并单击连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-251">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="c9af2-252">使用**连接 web 部件控件**按钮或提供的连接用户界面 (UI) 中，创建两个控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-252">Use the **Connect WebPart Controls** button, or the provided connection user interface (UI), to create a connection between the two controls.</span></span> <span data-ttu-id="c9af2-253">单击**显示使用者信息**按钮以运行代码，演示<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-253">Click the **Display Consumer Info** button to run the code that demonstrates the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="c9af2-254"><see cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID" /> 属性的长度为零。</span><span class="sxs-lookup"><span data-stu-id="c9af2-254">The length of the <see cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID" /> property is zero.</span></span></exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-255">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-255">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ConsumerConnectionPoint">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint ConsumerConnectionPoint { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint ConsumerConnectionPoint" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ConsumerConnectionPoint As ConsumerConnectionPoint" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::ConsumerConnectionPoint ^ ConsumerConnectionPoint { System::Web::UI::WebControls::WebParts::ConsumerConnectionPoint ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.ConsumerConnectionPoint : System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-256">获取一个对象，该对象作为连接中充当使用者的控件的连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-256">Gets the object that serves as a connection point for a control that is acting as a consumer in a connection.</span></span></summary>
        <value><span data-ttu-id="c9af2-257">与连接中的使用者控件关联的 <see cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />。</span><span class="sxs-lookup"><span data-stu-id="c9af2-257">A <see cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" /> associated with the consumer control in a connection.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-258">用于创建两个连接所需的步骤之一<xref:System.Web.UI.WebControls.WebParts.WebPart>控件是创建每个控件的连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-258">One of the required steps for creating a connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls is to create connection points for each control.</span></span> <span data-ttu-id="c9af2-259">使用者连接点是包含有关如何连接到作为使用者的控件的信息的对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-259">The consumer connection point is an object that contains the information about how to connect to the control acting as a consumer.</span></span> <span data-ttu-id="c9af2-260">在使用者的源代码，一种方法必须标识与`ConnectionConsumer`属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-260">In the consumer's source code, one of the methods must be identified with the `ConnectionConsumer` attribute.</span></span> <span data-ttu-id="c9af2-261"><xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>与使用者控件关联的对象包含有关方法和属性，包括对于方法，以便在用户界面 (UI) 中使用的显示名称的 ID 的详细信息，何种类型的接口方法可以检索。</span><span class="sxs-lookup"><span data-stu-id="c9af2-261">The <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object that is associated with a consumer control contains details about the method and the attribute, including an ID for the method, a display name for use in the user interface (UI), and what type of interface the method can retrieve.</span></span> <span data-ttu-id="c9af2-262">这套有关使用者的信息、 用于形成连接和理解，接口的类型及其方法共同形成了使用者连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-262">This set of information about the consumer, its method for forming connections, and the type of interface it understands, collectively forms a consumer connection point.</span></span>  
  
 <span data-ttu-id="c9af2-263">默认情况下<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>对象可以连接到仅一个<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>对象一次。</span><span class="sxs-lookup"><span data-stu-id="c9af2-263">By default, a <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object can connect to only one <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object at a time.</span></span> <span data-ttu-id="c9af2-264">使用者可能有多个方法标识为可能的使用者连接点，但使用者只能参与一个是作为使用者连接 （因此，仅其中一个其使用者连接点可以处于活动状态） 一次。</span><span class="sxs-lookup"><span data-stu-id="c9af2-264">A consumer could have multiple methods identified as possible consumer connection points, but a consumer can only participate in one connection as a consumer (hence, only one of its consumer connection points can be active) at a time.</span></span> <span data-ttu-id="c9af2-265">与此相反，<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>可以连接到任意数量的<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-265">In contrast, a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> can connect to any number of <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> objects.</span></span> <span data-ttu-id="c9af2-266">可以通过替代来更改此默认行为<xref:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute.AllowsMultipleConnections%2A>属性上的<xref:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-266">This default behavior can be changed by overriding the <xref:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute.AllowsMultipleConnections%2A> property on the <xref:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-267">下面的代码示例演示如何以编程方式将<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-267">The following code example demonstrates the programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-268">该示例包含四个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-268">The example has four parts:</span></span>  
  
-   <span data-ttu-id="c9af2-269">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-269">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-270">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-270">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-271">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-271">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-272">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-272">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-273">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-273">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-274">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-274">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-275">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-275">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerConnectionPoint#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerConnectionPoint#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-276">代码示例的第二部分是为两个源代码<xref:System.Web.UI.WebControls.WebParts.WebPart>充当使用者和提供程序连接，以及用于连接点的接口的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-276">The second part of the code example is the source code for the two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls that serve as the consumer and the provider for the connection, and an interface used for the connection points.</span></span> <span data-ttu-id="c9af2-277">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-277">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-278">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-278">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-279">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-279">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-280">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-280">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-281">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-281">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ConsumerConnectionPoint#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ConsumerConnectionPoint#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-282">代码示例的第三个部分是 Web 页面承载的控件，并演示如何使用代码<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-282">The third part of the code example is the code for the Web page that hosts the controls and demonstrates the use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property.</span></span> <span data-ttu-id="c9af2-283">在中`Button1_Click`方法，以形成连接所需的所有对象都创建，其中包括<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-283">In the `Button1_Click` method, all the objects required to form a connection are created, including a <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object.</span></span> <span data-ttu-id="c9af2-284">这些对象将传递给<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法以创建连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-284">These objects are all passed to the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method to create the connection.</span></span> <span data-ttu-id="c9af2-285">在中`Button2_Click`方法中，代码访问<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>属性并显示点的连接的一些详细信息。</span><span class="sxs-lookup"><span data-stu-id="c9af2-285">In the `Button2_Click` method, the code accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property and displays some details of the connection point.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerConnectionPoint#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerConnectionPoint#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPoint/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-286">加载浏览器中的页面后，使用**显示模式**要切换页可连接模式下的下拉列表控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-286">After you load the page in a browser, use the **Display Mode** drop-down list control to switch the page to connect mode.</span></span> <span data-ttu-id="c9af2-287">单击 （标题栏中的向下箭头表示） 之一上的谓词菜单<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，并单击连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-287">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="c9af2-288">使用**连接 web 部件控件**按钮或提供的连接用户界面，以创建两个控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-288">Use the **Connect WebPart Controls** button, or the provided connection UI, to create a connection between the two controls.</span></span> <span data-ttu-id="c9af2-289">单击**连接点的详细信息**按钮以运行代码，演示<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-289">Click the **ConnectionPoint Details** button to run the code that demonstrates the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPoint%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConnectionConsumerAttribute" />
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-290">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-290">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ConsumerConnectionPointID">
      <MemberSignature Language="C#" Value="public string ConsumerConnectionPointID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ConsumerConnectionPointID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID" />
      <MemberSignature Language="VB.NET" Value="Public Property ConsumerConnectionPointID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ConsumerConnectionPointID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ConsumerConnectionPointID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("default")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-291">获取或设置连接上的属性值，该值引用作为该连接的使用者连接点的对象的 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-291">Gets or sets the property value on a connection that references the ID of the object serving as the consumer connection point for that connection.</span></span></summary>
        <value><span data-ttu-id="c9af2-292">包含使用者连接点的 ID 的字符串。</span><span class="sxs-lookup"><span data-stu-id="c9af2-292">A string that contains the ID for the consumer connection point.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-293">对于在 Web 页的标记中声明静态连接，开发人员可以指定哪些使用者连接点将用于通过将分配到的值连接`ConsumerConnectionPointID`特性，可以在`<asp:webpartconnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-293">For a static connection declared in the markup of a Web page, developers can specify which consumer connection point will be used for the connection by assigning a value to the `ConsumerConnectionPointID` attribute on the `<asp:webpartconnection>` element.</span></span> <span data-ttu-id="c9af2-294">如果不将值分配给该属性，<xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID>使用属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-294">If a value is not assigned to the attribute, the <xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID> property value is used.</span></span>  
  
 <span data-ttu-id="c9af2-295">在创建动态 （以编程方式） 连接时，通常您不应设置的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-295">When you create dynamic (programmatic) connections, normally you should not set the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property.</span></span> <span data-ttu-id="c9af2-296">您可以简单地调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件，将其传递给使用者和使用者连接点 （以及其他必需的参数），对象和该方法将确定要使用使用者的连接的正确 ID点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-296">You can simply call the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control, passing to it the consumer and consumer connection point objects (along with the other required parameters), and that method determines the correct ID to use for the consumer's connection point.</span></span> <span data-ttu-id="c9af2-297">同样，断开连接后，您可以调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.DisconnectWebParts%2A>方法，而无需指定<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-297">Similarly, when you disconnect, you can call the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.DisconnectWebParts%2A> method without needing to specify the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property value.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c9af2-298">当你指定时，可确定使用者连接点的 ID<xref:System.Web.UI.WebControls.WebParts.WebPart>或其他服务器控件作为使用者。</span><span class="sxs-lookup"><span data-stu-id="c9af2-298">The ID of a consumer's connection point can be determined when you designate a <xref:System.Web.UI.WebControls.WebParts.WebPart> or other server control as a consumer.</span></span> <span data-ttu-id="c9af2-299">必须确定检索的提供者控件或转换器提供的接口的实例的使用者中的方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-299">You must identify a method in the consumer that retrieves an instance of an interface furnished by either a provider control or a transformer.</span></span> <span data-ttu-id="c9af2-300">若要标识的方法，将其与标记`ConnectionConsumer`code 属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-300">To identify the method, mark it with the `ConnectionConsumer` code attribute.</span></span> <span data-ttu-id="c9af2-301">当添加此属性时，可以添加一个可选的字符串值参数，充当使用者的 ID<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-301">When you add this attribute, you can add an optional string value parameter that serves as an ID for the consumer's <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> object.</span></span> <span data-ttu-id="c9af2-302">如果提供可选的 ID 参数的值，该值将成为的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>连接属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-302">If you supply a value for the optional ID parameter, that value becomes the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property for the connection.</span></span> <span data-ttu-id="c9af2-303">如果未提供 ID 值，<xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID>使用属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-303">If you do not supply an ID value, the <xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID> property value is used.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-304">下面的代码示例演示如何声明和编程方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-304">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-305">该示例包含四个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-305">The example has four parts:</span></span>  
  
-   <span data-ttu-id="c9af2-306">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-306">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-307">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-307">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-308">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-308">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-309">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-309">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-310">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-310">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-311">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-311">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-312">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-312">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerConnectionPointID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerConnectionPointID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-313">代码示例的第二部分是为接口和使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-313">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-314">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-314">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-315">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-315">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-316">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-316">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-317">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-317">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-318">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-318">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ConsumerConnectionPointID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ConsumerConnectionPointID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-319">代码示例的第三部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-319">The third part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-320">请注意，在页标记中，声明一个连接使用`<StaticConnections>`和`<asp:WebPartsConnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-320">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="c9af2-321">连接声明包含所需`ConsumerConnectionPointID`属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-321">The connection declaration includes the required `ConsumerConnectionPointID` attribute.</span></span> <span data-ttu-id="c9af2-322">创建连接的第二个方法将出现在`Button1_Click`方法，该代码在其中创建新的连接，使用使用者控件中定义的连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-322">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point defined in the consumer control.</span></span> <span data-ttu-id="c9af2-323">然后，在`Button2_Click`方法中，代码访问<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-323">Then, in the `Button2_Click` method, the code accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerConnectionPointID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerConnectionPointID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerConnectionPointID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-324">加载浏览器中的页面后，连接已存在由于页面中声明静态连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-324">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="c9af2-325">在提供程序控件中，输入一些文本，并记下它会显示在该连接由于使用者。</span><span class="sxs-lookup"><span data-stu-id="c9af2-325">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="c9af2-326">接下来，断开的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-326">Next, disconnect the controls.</span></span> <span data-ttu-id="c9af2-327">使用**显示模式**下拉列表控件中，切换页可连接模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-327">Using the **Display Mode** drop-down list control, switch the page to connect mode.</span></span> <span data-ttu-id="c9af2-328">单击 （标题栏中的向下箭头表示） 之一上的谓词菜单<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，并单击连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-328">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="c9af2-329">单击**断开连接**按钮。</span><span class="sxs-lookup"><span data-stu-id="c9af2-329">Click the **Disconnect** button.</span></span> <span data-ttu-id="c9af2-330">使用**连接 web 部件控件**按钮以重新创建两个控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-330">Use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="c9af2-331">单击**连接点的详细信息**按钮以运行访问的代码<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A>属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-331">Click the **ConnectionPoint Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerConnectionPointID%2A> property value.</span></span> <span data-ttu-id="c9af2-332">值标签控件的下方中写出。</span><span class="sxs-lookup"><span data-stu-id="c9af2-332">The value is written out in a label below the controls.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.ConnectionPoint.ID" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-333">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-333">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ConsumerID">
      <MemberSignature Language="C#" Value="public string ConsumerID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ConsumerID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID" />
      <MemberSignature Language="VB.NET" Value="Public Property ConsumerID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ConsumerID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ConsumerID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-334">获取或设置连接上的属性值，该值引用作为该连接的使用者的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控件的 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-334">Gets or sets the property value on a connection that references the ID of the <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> control acting as a consumer for that connection.</span></span></summary>
        <value><span data-ttu-id="c9af2-335">一个字符串，包含作为连接中的使用者的控件的 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-335">A string that contains the ID of the control acting as a consumer in a connection.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-336"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>属性值是必需的当创建之间的连接时<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-336">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property value is required when you create a connection between <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-337">如果值未分配给该属性，将引发异常时<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件尝试激活连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-337">If a value is not assigned to the property, an exception is thrown when the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control attempts to activate the connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-338">下面的代码示例演示如何声明和编程方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-338">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-339">该示例包含四个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-339">The example has four parts:</span></span>  
  
-   <span data-ttu-id="c9af2-340">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-340">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-341">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-341">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-342">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-342">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-343">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-343">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-344">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-344">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-345">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-345">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-346">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-346">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-347">代码示例的第二部分是为接口和使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-347">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-348">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-348">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-349">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-349">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-350">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-350">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-351">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-351">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-352">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-352">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ConsumerID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ConsumerID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-353">代码示例的第三部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-353">The third part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-354">请注意，在页标记中，声明一个连接使用`<StaticConnections>`和`<asp:WebPartsConnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-354">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="c9af2-355">连接声明包含所需`ConsumerID`属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-355">The connection declaration includes the required `ConsumerID` attribute.</span></span> <span data-ttu-id="c9af2-356">创建连接的第二个方法将出现在`Button1_Click`方法，该代码在其中创建新的连接，使用使用者控件中定义的连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-356">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point defined in the consumer control.</span></span> <span data-ttu-id="c9af2-357">然后，在`Button2_Click`方法中，代码访问的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>属性并将其显示在标签中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-357">Then, in the `Button2_Click` method, the code accesses the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property and displays it in a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ConsumerID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ConsumerID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ConsumerID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-358">加载浏览器中的页面后，连接已存在由于页面中声明静态连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-358">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="c9af2-359">在提供程序控件中，输入一些文本，并记下它会显示在该连接由于使用者。</span><span class="sxs-lookup"><span data-stu-id="c9af2-359">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="c9af2-360">接下来，断开的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-360">Next, disconnect the controls.</span></span> <span data-ttu-id="c9af2-361">使用**显示模式**下拉列表控件中，切换页可连接模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-361">Using the **Display Mode** drop-down list control, switch the page to connect mode.</span></span> <span data-ttu-id="c9af2-362">单击 （标题栏中的向下箭头表示） 之一上的谓词菜单<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，并单击连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-362">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="c9af2-363">单击**断开连接**按钮。</span><span class="sxs-lookup"><span data-stu-id="c9af2-363">Click the **Disconnect** button.</span></span> <span data-ttu-id="c9af2-364">使用**连接 web 部件控件**按钮以重新创建两个控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-364">Use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="c9af2-365">单击**使用者的详细信息**按钮以运行访问的代码<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A>属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-365">Click the **Consumer Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ConsumerID%2A> property value.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-366">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-366">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ID">
      <MemberSignature Language="C#" Value="public string ID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ID" />
      <MemberSignature Language="VB.NET" Value="Public Property ID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-367">获取或设置 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 对象的 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-367">Gets or sets the ID of a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> object.</span></span></summary>
        <value><span data-ttu-id="c9af2-368">包含 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 的 ID 的字符串。</span><span class="sxs-lookup"><span data-stu-id="c9af2-368">A string that contains the ID of a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-369">每个<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>的对象的唯一值分配给其<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-369">Every <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object has a unique value assigned to its <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A> property.</span></span> <span data-ttu-id="c9af2-370">这是为了确保有一种方法来区分多个连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-370">This is to ensure that there is a way to distinguish between multiple connections.</span></span>  
  
 <span data-ttu-id="c9af2-371">如果通过声明创建静态连接`<asp:webpartconnection>`元素中的网页，你不将值赋给`ID`时引发连接异常属性<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件尝试激活连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-371">If you create a static connection by declaring an `<asp:webpartconnection>` element in a Web page, and you do not assign a value to the `ID` attribute for the connection, an exception is thrown when the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control attempts to activate the connection.</span></span>  
  
 <span data-ttu-id="c9af2-372">当<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件创建新的动态连接时，它将调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.CreateDynamicConnectionID%2A>方法来生成连接的唯一 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-372">When the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control creates a new dynamic connection, it calls the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.CreateDynamicConnectionID%2A> method to generate a unique ID for the connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-373">下面的代码示例演示如何声明和编程方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-373">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-374">该示例包含四个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-374">The example has four parts:</span></span>  
  
-   <span data-ttu-id="c9af2-375">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-375">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-376">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-376">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-377">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-377">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-378">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-378">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-379">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-379">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-380">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-380">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-381">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-381">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-382">代码示例的第二部分是为接口和使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-382">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-383">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-383">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-384">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-384">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-385">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-385">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-386">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-386">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-387">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-387">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-388">代码示例的第三部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-388">The third part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-389">请注意，在页标记中，声明一个连接使用`<StaticConnections>`和`<asp:WebPartsConnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-389">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="c9af2-390">连接声明包含所需`ID`属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-390">The connection declaration includes the required `ID` attribute.</span></span> <span data-ttu-id="c9af2-391">创建连接的第二个方法将出现在`Button1_Click`方法，该代码在其中创建新的连接，使用使用者控件中定义的连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-391">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point defined in the consumer control.</span></span> <span data-ttu-id="c9af2-392">在这里，ID 属性不是必需的因为连接是动态的并且<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件为连接分配一个 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-392">Here, the ID property is not required, because the connection is dynamic, and the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control assigns an ID to the connection.</span></span> <span data-ttu-id="c9af2-393">在中`Button2_Click`方法中，代码访问的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A>属性并将其显示在标签中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-393">In the `Button2_Click` method, the code accesses the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A> property and displays it in a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-394">加载浏览器中的页面后，连接已存在由于页面中声明静态连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-394">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="c9af2-395">在提供程序控件中，输入一些文本，并记下它会显示在该连接由于使用者。</span><span class="sxs-lookup"><span data-stu-id="c9af2-395">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="c9af2-396">接下来，断开的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-396">Next, disconnect the controls.</span></span> <span data-ttu-id="c9af2-397">使用**显示模式**下拉列表控件中，切换页可连接模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-397">Using the **Display Mode** drop-down list control, switch the page to connect mode.</span></span> <span data-ttu-id="c9af2-398">单击 （标题栏中的向下箭头表示） 之一上的谓词菜单<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，并单击连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-398">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="c9af2-399">单击**断开连接**按钮。</span><span class="sxs-lookup"><span data-stu-id="c9af2-399">Click the **Disconnect** button.</span></span> <span data-ttu-id="c9af2-400">使用**连接 web 部件控件**按钮以重新创建两个控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-400">Use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="c9af2-401">单击**连接详细信息**按钮以运行访问的代码<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A>属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-401">Click the **Connection Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ID%2A> property value.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-402">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-402">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="IsActive">
      <MemberSignature Language="C#" Value="public bool IsActive { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool IsActive" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property IsActive As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool IsActive { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.IsActive : bool" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-403">获取一个值，该值指示 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 对象当前是否已经建立并且能够在其提供者和使用者控件之间交换数据。</span><span class="sxs-lookup"><span data-stu-id="c9af2-403">Gets a value that indicates whether a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> object is currently established and able to exchange data between its provider and consumer controls.</span></span></summary>
        <value><span data-ttu-id="c9af2-404">如果连接处于活动状态，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c9af2-404"><see langword="true" /> if the connection is active; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-405"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A>属性指示的状态<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-405">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A> property indicates a state of a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span> <span data-ttu-id="c9af2-406">当连接处于此状态时，在连接中的提供程序和使用者控件进行通信，并且能够通过公共接口的数据交换或<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-406">When the connection is in this state, the provider and consumer controls in the connection are communicating and able to exchange data through a common interface or a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object.</span></span>  
  
 <span data-ttu-id="c9af2-407">当用户查看呈现的页面在正常浏览模式中包含已建立的连接时，连接通常是活动 （除非它无法加载页面时激活由于某些冲突或其他问题）。</span><span class="sxs-lookup"><span data-stu-id="c9af2-407">When a user views a rendered page that includes an established connection in normal browse mode, the connection is typically active (unless it failed to be activated due to some conflict or other issue when the page loaded).</span></span> <span data-ttu-id="c9af2-408">在页面和控件生命周期的早期阶段，属性值是`false`。</span><span class="sxs-lookup"><span data-stu-id="c9af2-408">In the early stages of the page and control life cycle, the property value is `false`.</span></span> <span data-ttu-id="c9af2-409">该连接后将激活<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated>上的事件<xref:System.Web.UI.WebControls.WebParts.WebPartManager>引发控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-409">The connection is activated just after the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated> event on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control is raised.</span></span> <span data-ttu-id="c9af2-410">具体而言，该连接将激活后使用者是否已从提供程序检索指定接口的实例或<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-410">Specifically, the connection is activated after the consumer has retrieved an instance of the specified interface from the provider or a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object.</span></span>  
  
 <span data-ttu-id="c9af2-411">最好先了解连接是否处于活动状态的情况下可能存在冲突或由于页上的多个连接的同步问题。</span><span class="sxs-lookup"><span data-stu-id="c9af2-411">It is useful to know whether a connection is active in situations where there might be conflicts or synchronization issues due to multiple connections on a page.</span></span> <span data-ttu-id="c9af2-412">例如，如果没有某种类型的两个连接之间的冲突<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件具有未激活的多个连接的选项，以避免冲突。</span><span class="sxs-lookup"><span data-stu-id="c9af2-412">For example, if there is some kind of conflict between two connections, the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control has the option of not activating one of the connections to avoid the conflict.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-413">下面的代码示例演示如何使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-413">The following code example demonstrates use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-414">该示例包含三个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-414">The example has three parts:</span></span>  
  
-   <span data-ttu-id="c9af2-415">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-415">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-416">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-416">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-417">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-417">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-418">代码示例的第一部分是接口，并且使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-418">The first part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-419">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-419">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-420">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-420">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-421">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-421">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-422">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-422">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-423">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-423">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_IsActive#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsActive/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_IsActive#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsActive/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-424">代码示例的第二部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-424">The second part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-425">顶部附近是`Register`指的是两个动态编译的源代码的指令<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-425">Near the top is a `Register` directive that refers to the source code for the two dynamically compiled <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-426">中声明静态连接`<StaticConnections>`页上的元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-426">The static connection is declared within the `<StaticConnections>` element on the page.</span></span> <span data-ttu-id="c9af2-427">在`<script>`元素是四个事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="c9af2-427">Within the `<script>` element are four event handlers.</span></span> <span data-ttu-id="c9af2-428">每个事件处理程序检查的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A>属性为静态的连接，并写入到消息<xref:System.Web.UI.WebControls.Label>，该值指示连接在该状态的页面和控件生命周期中是否为活动或非活动的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-428">Each event handler checks the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsActive%2A> property on the static connection, and writes a message to the <xref:System.Web.UI.WebControls.Label> control indicating whether the connection is active or inactive at that state of the page and control life cycle.</span></span> <span data-ttu-id="c9af2-429">此示例演示在哪个点的连接成为活动状态，并呈现，它将保持活动页之后。</span><span class="sxs-lookup"><span data-stu-id="c9af2-429">This demonstrates at what point the connection becomes active, and that it remains active after the page is rendered.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_IsActive#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsActive/CS/wpConnectIsActiveCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_IsActive#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsActive/VB/wpConnectIsActiveVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-430">在浏览器页面加载。</span><span class="sxs-lookup"><span data-stu-id="c9af2-430">Load the page in a browser.</span></span> <span data-ttu-id="c9af2-431">已创建静态连接，并且消息已写入到显示页面和控件生命周期中是否连接处于活动状态的不同位置的标签。</span><span class="sxs-lookup"><span data-stu-id="c9af2-431">The static connection is already created, and messages have already been written to the labels showing whether the connection was active at various points in the page and control life cycle.</span></span> <span data-ttu-id="c9af2-432">单击**连接详细信息**按钮，并请注意，该连接未处于活动状态，但连接被重新激活后每次<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated>事件，并且，它仍处于活动状态 （会保持操作） 之后<xref:System.Web.UI.Control.PreRender>页面的事件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-432">Click the **Connection Details** button, and note that the connection is not active at that point, but that the connection is reactivated each time after the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated> event, and that it is still active (and will remain so) after the <xref:System.Web.UI.Control.PreRender> event of the page.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPart.IsStatic" />
        <altmember cref="M:System.Web.UI.WebControls.WebParts.WebPartManager.ActivateConnections" />
        <altmember cref="E:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivated" />
        <altmember cref="E:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectionsActivating" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-433">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-433">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="IsShared">
      <MemberSignature Language="C#" Value="public bool IsShared { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool IsShared" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property IsShared As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool IsShared { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.IsShared : bool" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-434">获取一个值，该值指示 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 对象是对所有用户可见还是仅对当前用户可见。</span><span class="sxs-lookup"><span data-stu-id="c9af2-434">Gets a value that indicates whether a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> object is visible to all users or only to the current user.</span></span></summary>
        <value><span data-ttu-id="c9af2-435">如果连接是共享的，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c9af2-435"><see langword="true" /> if the connection is shared; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-436">与单个一样<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>对象可以是共享或每个用户实例。</span><span class="sxs-lookup"><span data-stu-id="c9af2-436">As with individual <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object can be a shared or a per-user instance.</span></span> <span data-ttu-id="c9af2-437">共享的实例表示的连接是可见的网页，所有用户的每个用户实例表示的连接是仅对特定用户可见。</span><span class="sxs-lookup"><span data-stu-id="c9af2-437">A shared instance means that the connection is visible to all users of a Web page, and a per-user instance means the connection is visible only to a specific user.</span></span>  
  
 <span data-ttu-id="c9af2-438">一般情况下，将连接添加到页面的方式确定是否共享此连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-438">In general, the way a connection is added to a page determines whether the connection is shared.</span></span> <span data-ttu-id="c9af2-439">如果在 Web 页面的标记中声明连接，则共享此连接并<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>属性值是`true`。</span><span class="sxs-lookup"><span data-stu-id="c9af2-439">If the connection is declared in the markup of a Web page, then the connection is shared and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property value is `true`.</span></span> <span data-ttu-id="c9af2-440">此外，如果 Web 页处于共享个性化设置范围内，添加一个连接时，连接也会共享。</span><span class="sxs-lookup"><span data-stu-id="c9af2-440">In addition, if the Web page is in shared personalization scope when a connection is added, the connection is also shared.</span></span> <span data-ttu-id="c9af2-441">通常情况下，当用户使用`<asp:connectionszone>`用户界面 (UI) 来添加连接时，页面是在用户个性化设置范围内，因此不共享此连接并<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>属性值是`false`。</span><span class="sxs-lookup"><span data-stu-id="c9af2-441">Typically, when a user uses the `<asp:connectionszone>` user interface (UI) to add a connection, the page is in user personalization scope, so the connection is not shared and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property value is `false`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-442">下面的代码示例演示如何以编程方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-442">The following code example demonstrates programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-443">代码示例包含五个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-443">The code example has five parts:</span></span>  
  
-   <span data-ttu-id="c9af2-444">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-444">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-445">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-445">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-446">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-446">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-447">若要运行示例所需的 Web.config 文件中的条目。</span><span class="sxs-lookup"><span data-stu-id="c9af2-447">An entry in the Web.config file that is required to run the example.</span></span>  
  
-   <span data-ttu-id="c9af2-448">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-448">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-449">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-449">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-450">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-450">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-451">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-451">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_IsShared#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_IsShared#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-452">代码示例的第二部分是为接口和使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-452">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-453">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-453">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-454">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-454">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-455">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-455">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-456">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-456">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-457">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-457">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_IsShared#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_IsShared#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-458">代码示例的第三部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-458">The third part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-459">在`Button2_Click`方法，它会检查<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>现有连接的属性，并在页上显示结果。</span><span class="sxs-lookup"><span data-stu-id="c9af2-459">In the `Button2_Click` method, it checks the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property of the existing connection and displays the result on the page.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_IsShared#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_IsShared#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsShared/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-460">代码示例的第四个部分是将运行示例后，若要能够编辑共享个性化设置范围中的页的用户帐户需要 Web.config 文件中的条目。</span><span class="sxs-lookup"><span data-stu-id="c9af2-460">The fourth part of the code example is an entry in the Web.config file that is required for the user account that will be running the example to be able to edit the page in shared personalization scope.</span></span> <span data-ttu-id="c9af2-461">若要启用此功能，必须具有一个条目中的 Web.config 文件内`<system.web>`部分如以下示例所示。</span><span class="sxs-lookup"><span data-stu-id="c9af2-461">To enable this, you must have an entry in the Web.config file within the `<system.web>` section that looks like the following example.</span></span>  
  
```  
<webParts>  
  <personalization>  
    <authorization>  
      <allow users="UserAccount"  
             roles="admin"  
             verbs="enterSharedScope"/>  
    </authorization>            
  </personalization>  
</webParts>  
```  
  
 <span data-ttu-id="c9af2-462">加载浏览器中的页面后，使用**显示模式**下拉列表控件切换页后，可以连接显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-462">After you load the page in a browser, use the **Display Mode** drop-down list control to switch the page to connect display mode.</span></span> <span data-ttu-id="c9af2-463">单击**连接 web 部件控件**按钮以形成连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-463">Click the **Connect WebPart Controls** button to form a connection.</span></span> <span data-ttu-id="c9af2-464">接下来，单击**连接详细信息**按钮以显示是否共享此连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-464">Next, click the **Connection Details** button to display whether the connection is shared.</span></span> <span data-ttu-id="c9af2-465">如果使用的页中的默认用户个性化设置范围，创建连接<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>属性值应为`false`连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-465">If you created the connection with the page in the default user personalization scope, the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property value should be `false` for the connection.</span></span>  
  
 <span data-ttu-id="c9af2-466">其中一个的谓词菜单上<xref:System.Web.UI.WebControls.WebParts.WebPart>控件 （由标题栏中的向下箭头指示），单击连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-466">On the verbs menu of one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls (indicated by the downward arrow in the title bar), click the connect verb.</span></span> <span data-ttu-id="c9af2-467">连接用户界面出现时，单击**断开连接**按钮终止连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-467">When the connection UI appears, click the **Disconnect** button to end the connection.</span></span> <span data-ttu-id="c9af2-468">使用**显示模式**控件以返回页后，可以浏览模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-468">Use the **Display Mode** control to return the page to browse mode.</span></span>  
  
 <span data-ttu-id="c9af2-469">在中**显示模式**控件中，选择**共享**选项切换到页共享个性化设置范围。</span><span class="sxs-lookup"><span data-stu-id="c9af2-469">In the **Display Mode** control, select the **Shared** option to switch the page into shared personalization scope.</span></span> <span data-ttu-id="c9af2-470">按照相同的步骤与创建的连接，并再次单击这些上面**连接详细信息**按钮以显示是否共享此连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-470">Follow the same steps as those above to create a connection, and again click the **Connection Details** button to display whether the connection is shared.</span></span> <span data-ttu-id="c9af2-471">在本示例中的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A>属性应为`true`。</span><span class="sxs-lookup"><span data-stu-id="c9af2-471">In this case, the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsShared%2A> property should be `true`.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPart.IsShared" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-472">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-472">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="IsStatic">
      <MemberSignature Language="C#" Value="public bool IsStatic { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool IsStatic" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property IsStatic As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool IsStatic { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.IsStatic : bool" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-473">获取一个值，该值指示 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 对象是在网页的标记中声明的，还是以编程方式创建的。</span><span class="sxs-lookup"><span data-stu-id="c9af2-473">Gets a value that indicates whether a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> object is declared in the markup of a Web page, or created programmatically.</span></span></summary>
        <value><span data-ttu-id="c9af2-474">如果连接是静态的，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="c9af2-474"><see langword="true" /> if the connection is static; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-475">Web 部件控件之间的连接可以是静态或动态。</span><span class="sxs-lookup"><span data-stu-id="c9af2-475">Connections between Web Parts controls can be either static or dynamic.</span></span> <span data-ttu-id="c9af2-476">在 Web 页面的标记中声明静态连接使用`<asp:WebPartConnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-476">A static connection is declared in the markup of a Web page, using an `<asp:WebPartConnection>` element.</span></span> <span data-ttu-id="c9af2-477">以编程方式创建动态连接或当用户创建的连接通过用户界面 (UI) 由定义<xref:System.Web.UI.WebControls.WebParts.ConnectionsZone>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-477">Dynamic connections are created programmatically or when a user creates a connection through the user interface (UI) defined by the <xref:System.Web.UI.WebControls.WebParts.ConnectionsZone> control.</span></span>  
  
 <span data-ttu-id="c9af2-478">静态连接是共享的对象，这意味着它们可供 Web 页的所有用户。</span><span class="sxs-lookup"><span data-stu-id="c9af2-478">Static connections are shared objects, meaning they are available to all users of the Web page.</span></span> <span data-ttu-id="c9af2-479">此外，它们是永久实质上是因为，喜欢静态<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，它们不能被永久删除。</span><span class="sxs-lookup"><span data-stu-id="c9af2-479">Also, they are essentially permanent because, like a static <xref:System.Web.UI.WebControls.WebParts.WebPart> control, they cannot be permanently deleted.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c9af2-480">虽然不能永久删除静态连接对象，它可以被永久断开。</span><span class="sxs-lookup"><span data-stu-id="c9af2-480">While a static connection object cannot be permanently deleted, it can be permanently disconnected.</span></span> <span data-ttu-id="c9af2-481">在这种情况下，断开连接的对象将存在的服务器上，但最终用户将永远不会知道在页面中的对象存在。</span><span class="sxs-lookup"><span data-stu-id="c9af2-481">In this case, the disconnected object would exist on the server, but an end user would never be aware of the object's existence in a page.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-482">下面的代码示例演示如何以编程方式将<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-482">The following code example demonstrates the programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-483">代码示例包含三个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-483">The code example has three parts:</span></span>  
  
-   <span data-ttu-id="c9af2-484">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-484">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-485">若要承载控件和运行代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-485">A Web page to host the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-486">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-486">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-487">代码示例的第一部分是接口，并且使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-487">The first part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-488">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-488">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-489">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-489">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-490">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-490">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-491">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-491">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-492">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-492">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_IsStatic#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsStatic/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_IsStatic#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsStatic/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-493">代码示例的第二部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-493">The second part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-494">顶部附近是`Register`指的是两个动态编译的源代码的指令<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-494">Near the top is a `Register` directive that refers to the source code for the two dynamically compiled <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-495">中声明静态连接`<StaticConnections>`页上的元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-495">The static connection is declared within the `<StaticConnections>` element on the page.</span></span> <span data-ttu-id="c9af2-496">`Button1_Click`方法访问<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>要检查连接是否为静态属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-496">The `Button1_Click` method accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> property to check whether the connection is static.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_IsStatic#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_IsStatic/CS/wpConnectIsStaticCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_IsStatic#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_IsStatic/VB/wpConnectIsStaticVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-497">在浏览器页面加载。</span><span class="sxs-lookup"><span data-stu-id="c9af2-497">Load the page in a browser.</span></span> <span data-ttu-id="c9af2-498">已创建静态连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-498">The static connection is already created.</span></span> <span data-ttu-id="c9af2-499">在提供程序控件中，输入一些文本，并记下的使用者控件中的显示文本。</span><span class="sxs-lookup"><span data-stu-id="c9af2-499">Enter some text in the provider control, and note that the text is displayed in the consumer control.</span></span> <span data-ttu-id="c9af2-500">单击**连接详细信息**按钮以显示的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-500">Click the **Connection Details** button to display the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.IsStatic%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartManager.StaticConnections" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-501">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-501">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Provider">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.WebPart Provider { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.WebPart Provider" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Provider As WebPart" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::WebPart ^ Provider { System::Web::UI::WebControls::WebParts::WebPart ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Provider : System.Web.UI.WebControls.WebParts.WebPart" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.Provider" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.WebPart</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-502">获取作为 Web 部件连接中的提供者的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-502">Gets a <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> control that acts as the provider in a Web Parts connection.</span></span></summary>
        <value><span data-ttu-id="c9af2-503">作为数据提供者的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" />。</span><span class="sxs-lookup"><span data-stu-id="c9af2-503">A <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> that acts as the provider of data.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-504">每个 Web 部件连接中包含两个<xref:System.Web.UI.WebControls.WebParts.WebPart>控件-使用者和提供程序--和<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>属性返回在连接中对提供程序控件的引用。</span><span class="sxs-lookup"><span data-stu-id="c9af2-504">Every Web Parts connection consists of two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls--a consumer and a provider--and the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property returns a reference to the provider control in a connection.</span></span>  
  
 <span data-ttu-id="c9af2-505">等连接 （使用者控件） 中其对应的提供者控件需要建立连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-505">Like its counterpart in a connection (the consumer control), the provider control is required to establish a connection.</span></span> <span data-ttu-id="c9af2-506">是否以编程方式或通过声明以页持久性格式创建的连接，必须指定控件充当用于连接的提供程序。</span><span class="sxs-lookup"><span data-stu-id="c9af2-506">Whether you create the connection programmatically, or by declaring it in page persistence format, you must specify a control to act as the provider for a connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-507">下面的代码示例演示如何使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-507">The following code example demonstrates use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-508">代码示例包含三个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-508">The code example has three parts:</span></span>  
  
-   <span data-ttu-id="c9af2-509">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-509">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-510">若要承载控件和运行代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-510">A Web page to host the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-511">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-511">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-512">代码示例的第一部分是接口，并且使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-512">The first part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-513">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-513">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-514">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-514">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-515">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-515">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-516">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-516">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-517">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-517">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_Provider#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Provider/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_Provider#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Provider/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-518">代码示例的第二部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-518">The second part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-519">顶部附近是`Register`指的是两个动态编译的源代码的指令<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-519">Near the top is a `Register` directive that refers to the source code for the two dynamically compiled <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-520">中声明静态连接`<StaticConnections>`页上的元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-520">The static connection is declared within the `<StaticConnections>` element on the page.</span></span> <span data-ttu-id="c9af2-521">请注意，在`<asp:webpartconnection>`元素，`ProviderID`属性具有分配给它的提供者控件的 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-521">Notice that in the `<asp:webpartconnection>` element, the `ProviderID` attribute has the ID of the provider control assigned to it.</span></span> <span data-ttu-id="c9af2-522">这是标识用于静态连接的提供程序所需的。</span><span class="sxs-lookup"><span data-stu-id="c9af2-522">This is required to identify the provider for the static connection.</span></span> <span data-ttu-id="c9af2-523">`Button1_Click`方法访问<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>属性并将一些其详细信息写入到一个标签。</span><span class="sxs-lookup"><span data-stu-id="c9af2-523">The `Button1_Click` method accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property and writes some of its details to a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_Provider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_Provider/CS/wpConnectProviderCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_Provider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_Provider/VB/wpConnectProviderVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-524">在浏览器页面加载。</span><span class="sxs-lookup"><span data-stu-id="c9af2-524">Load the page in a browser.</span></span> <span data-ttu-id="c9af2-525">已创建静态连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-525">The static connection is already created.</span></span> <span data-ttu-id="c9af2-526">在提供程序控件中，输入一些文本，并记下的使用者控件中的显示文本。</span><span class="sxs-lookup"><span data-stu-id="c9af2-526">Enter some text in the provider control, and note that the text is displayed in the consumer control.</span></span> <span data-ttu-id="c9af2-527">单击**提供程序详细信息**按钮以显示通过访问的属性值的一些<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-527">Click the **Provider Details** button to display some of the property values accessed through the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="c9af2-528"><see cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" /> 属性值的长度为零。</span><span class="sxs-lookup"><span data-stu-id="c9af2-528">The length of the <see cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" /> property value is zero.</span></span></exception>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Consumer" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-529">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-529">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ProviderConnectionPoint">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.ProviderConnectionPoint ProviderConnectionPoint { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.ProviderConnectionPoint ProviderConnectionPoint" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ProviderConnectionPoint As ProviderConnectionPoint" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::ProviderConnectionPoint ^ ProviderConnectionPoint { System::Web::UI::WebControls::WebParts::ProviderConnectionPoint ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.ProviderConnectionPoint : System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.ProviderConnectionPoint</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-530">获取一个对象，该对象作为充当连接提供者的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控件的连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-530">Gets the object that serves as a connection point for a <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> control acting as a provider for a connection.</span></span></summary>
        <value><span data-ttu-id="c9af2-531">与连接中的提供者控件关联的 <see cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" />。</span><span class="sxs-lookup"><span data-stu-id="c9af2-531">A <see cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" /> associated with the provider control in a connection.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-532">用于创建两个连接所需的步骤之一<xref:System.Web.UI.WebControls.WebParts.WebPart>控件是创建每个控件的连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-532">One of the required steps for creating a connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls is to create connection points for each control.</span></span> <span data-ttu-id="c9af2-533">提供者连接点是包含有关如何连接到作为一个提供程序的控件的信息的对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-533">The provider connection point is an object that contains the information about how to connect to the control acting as a provider.</span></span> <span data-ttu-id="c9af2-534">在提供程序的源代码，一种方法必须标识与`ConnectionProvider`属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-534">In the provider's source code, one of the methods must be identified with the `ConnectionProvider` attribute.</span></span> <span data-ttu-id="c9af2-535"><xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> ，它是关联控件与提供程序包含有关方法和属性，包括对于方法，以便在用户界面 (UI) 中使用的显示名称的 ID 的详细信息，何种类型的接口实例方法可以返回到使用者控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-535">The <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> that is associated with a provider control contains details about the method and the attribute, including an ID for the method, a display name for use in the user interface (UI), and what type of interface instance the method can return to a consumer control.</span></span> <span data-ttu-id="c9af2-536">此提供程序有关的信息、 用于形成连接和它提供的接口的类型及其方法的共同形成提供者连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-536">This set of information about the provider, its method for forming connections, and the type of interface it provides, collectively forms a provider connection point.</span></span>  
  
 <span data-ttu-id="c9af2-537">默认情况下<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>可以连接到仅一个<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>对象一次。</span><span class="sxs-lookup"><span data-stu-id="c9af2-537">By default, a <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> can connect to only one <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object at a time.</span></span> <span data-ttu-id="c9af2-538">使用者可能有多个方法标识为可能的使用者连接点，但使用者只能参与一个是作为使用者连接 （因此，仅其中一个其使用者连接点可以处于活动状态） 一次。</span><span class="sxs-lookup"><span data-stu-id="c9af2-538">A consumer could have multiple methods identified as possible consumer connection points, but a consumer can only participate in one connection as a consumer (hence, only one of its consumer connection points can be active) at a time.</span></span> <span data-ttu-id="c9af2-539">与此相反，<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>可以连接到任意数量的<xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint>默认情况下的对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-539">In contrast, a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> can connect to any number of <xref:System.Web.UI.WebControls.WebParts.ConsumerConnectionPoint> objects by default.</span></span> <span data-ttu-id="c9af2-540">例如，提供邮政编码的提供程序控件无法连接到邮政代码用于创建各种类型的数据基于邮政编码，例如天气数据、 新闻等的多个使用者控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-540">For example, a provider control that provides a postal code could be connected to multiple consumer controls that use a postal code to create various kinds of data based on a postal code, such as weather data, news, and so on.</span></span> <span data-ttu-id="c9af2-541">可以通过替代来更改此默认行为<xref:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute.AllowsMultipleConnections%2A>属性上的<xref:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-541">This default behavior can be changed by overriding the <xref:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute.AllowsMultipleConnections%2A> property on the <xref:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute> attribute.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-542">下面的代码示例演示如何以编程方式将<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-542">The following code example demonstrates the programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-543">该示例包含四个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-543">The example has four parts:</span></span>  
  
-   <span data-ttu-id="c9af2-544">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-544">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-545">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-545">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-546">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-546">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-547">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-547">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-548">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-548">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-549">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-549">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-550">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-550">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderConnectionPoint#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderConnectionPoint#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-551">代码示例的第二部分是为两个源代码<xref:System.Web.UI.WebControls.WebParts.WebPart>充当使用者和提供程序连接，以及用于连接点的接口的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-551">The second part of the code example is the source code for the two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls that serve as the consumer and the provider for the connection, and an interface used for the connection points.</span></span> <span data-ttu-id="c9af2-552">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-552">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-553">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-553">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-554">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-554">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-555">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-555">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-556">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-556">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ProviderConnectionPoint#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ProviderConnectionPoint#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-557">代码示例的第三个部分是 Web 页面承载的控件，并演示如何使用代码<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-557">The third part of the code example is the code for the Web page that hosts the controls and demonstrates the use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property.</span></span> <span data-ttu-id="c9af2-558">在中`Button1_Click`方法，以形成连接所需的所有对象都创建，其中包括<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-558">In the `Button1_Click` method, all the objects required to form a connection are created, including a <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object.</span></span> <span data-ttu-id="c9af2-559">请注意在调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints%2A>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-559">Note the call to the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints%2A> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control.</span></span> <span data-ttu-id="c9af2-560">创建的对象将传递给<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法以创建连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-560">The various created objects are all passed to the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method to create the connection.</span></span> <span data-ttu-id="c9af2-561">在中`Button2_Click`方法中，代码访问<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>属性并显示点的连接的一些详细信息。</span><span class="sxs-lookup"><span data-stu-id="c9af2-561">In the `Button2_Click` method, the code accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property and displays some details of the connection point.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderConnectionPoint#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderConnectionPoint#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPoint/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-562">加载浏览器中的页面后，使用**显示模式**要切换页可连接模式下的下拉列表控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-562">After you load the page in a browser, use the **Display Mode** drop-down list control to switch the page to connect mode.</span></span> <span data-ttu-id="c9af2-563">单击 （标题栏中的向下箭头表示） 之一上的谓词菜单<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，并单击连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-563">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="c9af2-564">使用**连接 web 部件控件**按钮或提供的连接用户界面，以创建两个控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-564">Use the **Connect WebPart Controls** button, or the provided connection UI, to create a connection between the two controls.</span></span> <span data-ttu-id="c9af2-565">单击**连接点的详细信息**按钮以运行代码，演示<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-565">Click the **ConnectionPoint Details** button to run the code that demonstrates the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPoint%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ConnectionProviderAttribute" />
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" />
        <altmember cref="M:System.Web.UI.WebControls.WebParts.WebPartManager.GetProviderConnectionPoints(System.Web.UI.WebControls.WebParts.WebPart)" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-566">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-566">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ProviderConnectionPointID">
      <MemberSignature Language="C#" Value="public string ProviderConnectionPointID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ProviderConnectionPointID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID" />
      <MemberSignature Language="VB.NET" Value="Public Property ProviderConnectionPointID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ProviderConnectionPointID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ProviderConnectionPointID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("default")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-567">获取或设置连接上的属性值，该值引用作为该连接的提供者连接点的对象的 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-567">Gets or sets the property value on a connection that references the ID of the object serving as the provider connection point for that connection.</span></span></summary>
        <value><span data-ttu-id="c9af2-568">包含提供者连接点对象的 ID 的字符串。</span><span class="sxs-lookup"><span data-stu-id="c9af2-568">A string that contains the ID for a provider connection point object.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-569">对于在 Web 页的标记中声明静态连接，开发人员可以指定的提供者连接点将用于通过将分配到的值连接`ProviderConnectionPointID`特性，可以在`<asp:webpartconnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-569">For a static connection declared in the markup of a Web page, developers can specify which provider connection point will be used for the connection by assigning a value to the `ProviderConnectionPointID` attribute on the `<asp:webpartconnection>` element.</span></span> <span data-ttu-id="c9af2-570">如果不将值分配给该属性，<xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID>使用属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-570">If a value is not assigned to the attribute, the <xref:System.Web.UI.WebControls.WebParts.ConnectionPoint.DefaultID> property value is used.</span></span>  
  
 <span data-ttu-id="c9af2-571">在创建动态 （以编程方式） 连接时，通常您不应设置的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-571">When you create dynamic (programmatic) connections, normally you should not set the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property.</span></span> <span data-ttu-id="c9af2-572">您可以简单地调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件，将其传递给提供程序和提供程序连接点对象 （以及其他必需的参数），而该方法将确定要使用的提供程序的连接的正确 ID点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-572">You can simply call the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%2A> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control, passing to it the provider and provider connection point objects (along with the other required parameters), and that method determines the correct ID to use for the provider's connection point.</span></span> <span data-ttu-id="c9af2-573">同样，断开连接后，您可以调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.DisconnectWebParts%2A>方法，而无需指定<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-573">Similarly, when you disconnect, you can call the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.DisconnectWebParts%2A> method without needing to specify the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property value.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c9af2-574">当你指定时，可确定的提供者连接点 ID<xref:System.Web.UI.WebControls.WebParts.WebPart>或其他服务器控件作为提供程序。</span><span class="sxs-lookup"><span data-stu-id="c9af2-574">The ID of a provider's connection point can be determined when you designate a <xref:System.Web.UI.WebControls.WebParts.WebPart> or other server control as a provider.</span></span> <span data-ttu-id="c9af2-575">您必须标识中提供的包含数据的使用者的接口实例的提供程序的回调方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-575">You must identify a callback method in the provider that serves an instance of an interface containing data to a consumer.</span></span> <span data-ttu-id="c9af2-576">若要标识的方法，将其与标记`ConnectionProvider`code 属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-576">To identify the method, mark it with the `ConnectionProvider` code attribute.</span></span> <span data-ttu-id="c9af2-577">当添加此属性时，可以添加一个可选的字符串值参数，可提供程序的 ID 作为<xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-577">When you add this attribute, you can add an optional string value parameter that serves as an ID for the provider's <xref:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint> object.</span></span> <span data-ttu-id="c9af2-578">如果提供可选的 ID 参数的值，该值将成为的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>连接属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-578">If you supply a value for the optional ID parameter, that value becomes the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property for the connection.</span></span> <span data-ttu-id="c9af2-579">如果未提供 ID 值，<xref:System.Web.UI.WebControls.WebParts.WebPartManager>创建对象时，控制会分配一个默认 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-579">If you do not supply an ID value, the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control assigns a default ID when the object is created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-580">下面的代码示例演示如何声明和编程方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-580">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-581">该示例包含四个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-581">The example has four parts:</span></span>  
  
-   <span data-ttu-id="c9af2-582">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-582">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-583">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-583">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-584">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-584">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-585">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-585">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-586">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-586">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-587">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-587">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-588">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-588">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderConnectionPointID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderConnectionPointID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-589">代码示例的第二部分是为接口和使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-589">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-590">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-590">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-591">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-591">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-592">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-592">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-593">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-593">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-594">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-594">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ProviderConnectionPointID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ProviderConnectionPointID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-595">代码示例的第三部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-595">The third part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-596">请注意，在页标记中，声明一个连接使用`<StaticConnections>`和`<asp:WebPartsConnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-596">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="c9af2-597">连接声明包含所需`ProviderConnectionPointID`属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-597">The connection declaration includes the required `ProviderConnectionPointID` attribute.</span></span> <span data-ttu-id="c9af2-598">创建连接的第二个方法将出现在`Button1_Click`方法，其中代码将创建一个新的连接使用的连接点 （和 ID） 中定义的提供者控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-598">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point (and the ID) defined in the provider control.</span></span> <span data-ttu-id="c9af2-599">然后，在`Button2_Click`方法中，代码访问<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-599">Then, in the `Button2_Click` method, the code accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderConnectionPointID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderConnectionPointID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderConnectionPointID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-600">加载浏览器中的页面后，连接已存在由于页面中声明静态连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-600">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="c9af2-601">在提供程序控件中，输入一些文本，并记下它会显示在该连接由于使用者。</span><span class="sxs-lookup"><span data-stu-id="c9af2-601">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="c9af2-602">接下来，断开的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-602">Next, disconnect the controls.</span></span> <span data-ttu-id="c9af2-603">使用**显示模式**下拉列表控件中，切换页可连接模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-603">Using the **Display Mode** drop-down list control, switch the page to connect mode.</span></span> <span data-ttu-id="c9af2-604">单击 （标题栏中的向下箭头表示） 之一上的谓词菜单<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，并单击连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-604">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="c9af2-605">单击**断开连接**按钮。</span><span class="sxs-lookup"><span data-stu-id="c9af2-605">Click the **Disconnect** button.</span></span> <span data-ttu-id="c9af2-606">使用**连接 web 部件控件**按钮以重新创建两个控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-606">Use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="c9af2-607">单击**连接点的详细信息**按钮以运行访问的代码<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A>属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-607">Click the **ConnectionPoint Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderConnectionPointID%2A> property value.</span></span> <span data-ttu-id="c9af2-608">值标签控件的下方中写出。</span><span class="sxs-lookup"><span data-stu-id="c9af2-608">The value is written out in a label below the controls.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.ProviderConnectionPoint" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.ConnectionPoint.ID" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-609">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-609">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ProviderID">
      <MemberSignature Language="C#" Value="public string ProviderID { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ProviderID" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" />
      <MemberSignature Language="VB.NET" Value="Public Property ProviderID As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ProviderID { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ProviderID : string with get, set" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>set: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-610">获取或设置连接上的属性值，该值引用作为该连接的提供者的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> 控件的 ID。</span><span class="sxs-lookup"><span data-stu-id="c9af2-610">Gets or sets the property value on a connection that references the ID of the <see cref="T:System.Web.UI.WebControls.WebParts.WebPart" /> control acting as a provider for that connection.</span></span></summary>
        <value><span data-ttu-id="c9af2-611">包含提供者控件的 ID 的字符串。</span><span class="sxs-lookup"><span data-stu-id="c9af2-611">A string that contains the ID of the provider control.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-612"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>属性值是必需的当您创建两个连接<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-612">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property value is required when you create a connection between two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-613">如果值未分配给该属性，将引发异常时<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件尝试激活连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-613">If a value is not assigned to the property, an exception is thrown when the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control attempts to activate the connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-614">下面的代码示例演示如何声明和编程方式使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-614">The following code example shows the declarative and programmatic use of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-615">该示例包含四个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-615">The example has four parts:</span></span>  
  
-   <span data-ttu-id="c9af2-616">使你能够更改 Web 部件的用户控件在页面上显示模式。</span><span class="sxs-lookup"><span data-stu-id="c9af2-616">A user control that enables you to change the Web Parts display mode on a page.</span></span>  
  
-   <span data-ttu-id="c9af2-617">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-617">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-618">若要托管的所有控件和运行的代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-618">A Web page to host all the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-619">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-619">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-620">此代码示例的第一个部分是使用户能够更改网页上的显示模式的用户控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-620">The first part of this code example is the user control that enables users to change display modes on a Web page.</span></span> <span data-ttu-id="c9af2-621">将以下源代码保存到.ascx 文件，将其分配到的文件名称`Src`属性的`Register`指令对该用户控件，即托管的 Web 页面的顶部附近。</span><span class="sxs-lookup"><span data-stu-id="c9af2-621">Save the following source code to an .ascx file, giving it the file name that is assigned to the `Src` attribute of the `Register` directive for this user control, which is near the top of the hosting Web page.</span></span> <span data-ttu-id="c9af2-622">有关详细信息显示在此控件模式和对源代码的说明，请参见[演练：更改显示模式同时适用于 Web 部件页](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-622">For details about display modes and a description of the source code in this control, see [Walkthrough: Changing Display Modes on a Web Parts Page](https://msdn.microsoft.com/library/24e42f74-82dc-4c13-8574-130398985fc0).</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderID#6](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/CS/displaymodemenucs.ascx#6)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderID#6](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/VB/DisplayModeMenuVB.ascx#6)]  
  
 <span data-ttu-id="c9af2-623">代码示例的第二部分是为接口和使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-623">The second part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-624">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-624">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-625">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-625">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-626">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-626">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-627">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-627">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-628">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-628">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ProviderID#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ProviderID#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-629">代码示例的第三部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-629">The third part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-630">请注意，在页标记中，声明一个连接使用`<StaticConnections>`和`<asp:WebPartsConnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-630">Note that a connection is declared in the page markup, using the `<StaticConnections>` and `<asp:WebPartsConnection>` elements.</span></span> <span data-ttu-id="c9af2-631">连接声明包含所需`ProviderID`属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-631">The connection declaration includes the required `ProviderID` attribute.</span></span> <span data-ttu-id="c9af2-632">创建连接的第二个方法将出现在`Button1_Click`方法，该代码在其中创建新的连接，使用使用者控件中定义的连接点。</span><span class="sxs-lookup"><span data-stu-id="c9af2-632">A second method for creating the connection appears in the `Button1_Click` method, where the code creates a new connection, using the connection point defined in the consumer control.</span></span> <span data-ttu-id="c9af2-633">然后，在`Button2_Click`方法中，代码访问的值<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>属性并将其显示在标签中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-633">Then, in the `Button2_Click` method, the code accesses the value of the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property and displays it in a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ProviderID#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/CS/wpmgrConnectWebPartsCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ProviderID#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ProviderID/VB/wpmgrConnectWebPartsVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-634">加载浏览器中的页面后，连接已存在由于页面中声明静态连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-634">After you load the page in a browser, a connection already exists because of the static connection declared in the page.</span></span> <span data-ttu-id="c9af2-635">在提供程序控件中，输入一些文本，并记下它会显示在该连接由于使用者。</span><span class="sxs-lookup"><span data-stu-id="c9af2-635">Enter some text in the provider control, and note that it is displayed in the consumer due to the connection.</span></span> <span data-ttu-id="c9af2-636">接下来，断开的控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-636">Next, disconnect the controls.</span></span> <span data-ttu-id="c9af2-637">若要执行此操作，请使用**显示模式**要切换页可连接模式下的下拉列表控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-637">To do that, use the **Display Mode** drop-down list control to switch the page to connect mode.</span></span> <span data-ttu-id="c9af2-638">单击 （标题栏中的向下箭头表示） 之一上的谓词菜单<xref:System.Web.UI.WebControls.WebParts.WebPart>控件，并单击连接谓词。</span><span class="sxs-lookup"><span data-stu-id="c9af2-638">Click the verbs menu (represented by the downward arrow in the title bar) on one of the <xref:System.Web.UI.WebControls.WebParts.WebPart> controls, and click the connect verb.</span></span> <span data-ttu-id="c9af2-639">单击**断开连接**按钮和控件断开连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-639">Click the **Disconnect** button, and the controls are disconnected.</span></span> <span data-ttu-id="c9af2-640">接下来，使用**连接 web 部件控件**按钮以重新创建两个控件之间的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-640">Next, use the **Connect WebPart Controls** button to recreate a connection between the two controls.</span></span> <span data-ttu-id="c9af2-641">单击**使用者的详细信息**按钮以运行访问的代码<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A>属性值。</span><span class="sxs-lookup"><span data-stu-id="c9af2-641">Click the **Consumer Details** button to run the code that accesses the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ProviderID%2A> property value.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Provider" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-642">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-642">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ToString">
      <MemberSignature Language="C#" Value="public override string ToString ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance string ToString() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ToString () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::String ^ ToString();" />
      <MemberSignature Language="F#" Value="override this.ToString : unit -&gt; string" Usage="webPartConnection.ToString " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="c9af2-643">重写继承的 <see cref="M:System.Object.ToString" /> 方法，并返回连接对象的类型的简称。</span><span class="sxs-lookup"><span data-stu-id="c9af2-643">Overrides the inherited <see cref="M:System.Object.ToString" /> method and returns a short type name for the connection object.</span></span></summary>
        <returns><span data-ttu-id="c9af2-644">一个字符串，包含 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" /> 的类型简称（非限定名称）。</span><span class="sxs-lookup"><span data-stu-id="c9af2-644">A string that contains the short (unqualified) type name of a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartConnection" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-645">控件设计主要是为方便起见使用此方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-645">This method is used mostly for convenience by control designers.</span></span> <span data-ttu-id="c9af2-646">它可以提高连接对象的显示方式在设计视图中使用较短类型名称，而不是完全限定的类型名称。</span><span class="sxs-lookup"><span data-stu-id="c9af2-646">It improves how connection objects appear in Design view by using the shorter type name, as opposed to a fully qualified type name.</span></span> <span data-ttu-id="c9af2-647">但是，可以调用方法在代码中的任何时候你想要知道连接对象的类型名称。</span><span class="sxs-lookup"><span data-stu-id="c9af2-647">However, the method can be called at any point in your code where you want to know the type name of a connection object.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="c9af2-648">下面的代码示例演示如何调用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A>方法返回的短类型名称<xref:System.Web.UI.WebControls.WebParts.WebPartConnection>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-648">The following code example demonstrates how to call the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A> method to return the short type name of a <xref:System.Web.UI.WebControls.WebParts.WebPartConnection> object.</span></span>  
  
 <span data-ttu-id="c9af2-649">代码示例包含三个部分：</span><span class="sxs-lookup"><span data-stu-id="c9af2-649">The code example has three parts:</span></span>  
  
-   <span data-ttu-id="c9af2-650">源接口和两个代码<xref:System.Web.UI.WebControls.WebParts.WebPart>控件作为提供程序和使用者的连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-650">Source code for an interface and two <xref:System.Web.UI.WebControls.WebParts.WebPart> controls acting as the provider and the consumer for a connection.</span></span>  
  
-   <span data-ttu-id="c9af2-651">若要承载控件和运行代码示例网页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-651">A Web page to host the controls and run the code example.</span></span>  
  
-   <span data-ttu-id="c9af2-652">如何运行示例页的说明。</span><span class="sxs-lookup"><span data-stu-id="c9af2-652">An explanation of how to run the example page.</span></span>  
  
 <span data-ttu-id="c9af2-653">代码示例的第一部分是接口，并且使用者和提供程序控件的源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-653">The first part of the code example is the source code for the interface, and the consumer and provider controls.</span></span> <span data-ttu-id="c9af2-654">若要运行的代码示例，必须编译此源代码。</span><span class="sxs-lookup"><span data-stu-id="c9af2-654">For the code example to run, you must compile this source code.</span></span> <span data-ttu-id="c9af2-655">可以显式对其进行编译，并将生成的程序集放在网站的 Bin 文件夹或全局程序集缓存中。</span><span class="sxs-lookup"><span data-stu-id="c9af2-655">You can compile it explicitly and put the resulting assembly in your Web site's Bin folder or the global assembly cache.</span></span> <span data-ttu-id="c9af2-656">或者，您可以将源代码放在你网站的 App_Code 文件夹中，其中它将被动态编译在运行时。</span><span class="sxs-lookup"><span data-stu-id="c9af2-656">Alternatively, you can put the source code in your site's App_Code folder, where it will be dynamically compiled at run time.</span></span> <span data-ttu-id="c9af2-657">此代码示例使用动态编译。</span><span class="sxs-lookup"><span data-stu-id="c9af2-657">This code example uses dynamic compilation.</span></span> <span data-ttu-id="c9af2-658">有关演示如何编译的演练，请参阅[演练：开发和使用自定义 Web 服务器控件](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08)。</span><span class="sxs-lookup"><span data-stu-id="c9af2-658">For a walkthrough that demonstrates how to compile, see [Walkthrough: Developing and Using a Custom Web Server Control](https://msdn.microsoft.com/library/6d90782a-a1a4-45a6-b2d4-cf6362b83b08).</span></span>  
  
 [!code-csharp[WebParts_WebPartConnection_ToString#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ToString/CS/ZipCodeComponent.cs#2)]
 [!code-vb[WebParts_WebPartConnection_ToString#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ToString/VB/ZipCodeComponent.vb#2)]  
  
 <span data-ttu-id="c9af2-659">代码示例的第二部分是 Web 页。</span><span class="sxs-lookup"><span data-stu-id="c9af2-659">The second part of the code example is the Web page.</span></span> <span data-ttu-id="c9af2-660">顶部附近是`Register`指的是两个动态编译的源代码的指令<xref:System.Web.UI.WebControls.WebParts.WebPart>控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-660">Near the top is a `Register` directive that refers to the source code for the two dynamically compiled <xref:System.Web.UI.WebControls.WebParts.WebPart> controls.</span></span> <span data-ttu-id="c9af2-661">中声明静态连接`<StaticConnections>`页上的元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-661">The static connection is declared within the `<StaticConnections>` element on the page.</span></span> <span data-ttu-id="c9af2-662">`Button1_Click`方法调用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A>方法将连接的类型名称写入一个标签。</span><span class="sxs-lookup"><span data-stu-id="c9af2-662">The `Button1_Click` method calls the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A> method to write the type name of the connection to a label.</span></span>  
  
 [!code-aspx-csharp[WebParts_WebPartConnection_ToString#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_WebPartConnection_ToString/CS/wpConnectToStringCS.aspx#1)]
 [!code-aspx-vb[WebParts_WebPartConnection_ToString#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/WebParts_WebPartConnection_ToString/VB/wpConnectToStringVB.aspx#1)]  
  
 <span data-ttu-id="c9af2-663">在浏览器页面加载。</span><span class="sxs-lookup"><span data-stu-id="c9af2-663">Load the page in a browser.</span></span> <span data-ttu-id="c9af2-664">已创建静态连接。</span><span class="sxs-lookup"><span data-stu-id="c9af2-664">The static connection is already created.</span></span> <span data-ttu-id="c9af2-665">在提供程序控件中，输入一些文本，并记下的使用者控件中的显示文本。</span><span class="sxs-lookup"><span data-stu-id="c9af2-665">Enter some text in the provider control, and note that the text is displayed in the consumer control.</span></span> <span data-ttu-id="c9af2-666">单击**连接详细信息**按钮以执行<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="c9af2-666">Click the **Connection Details** button to execute the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.ToString%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Object.ToString" />
      </Docs>
    </Member>
    <Member MemberName="Transformer">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.WebPartTransformer Transformer { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.WebPartTransformer Transformer" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transformer As WebPartTransformer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::WebPartTransformer ^ Transformer { System::Web::UI::WebControls::WebParts::WebPartTransformer ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Transformer : System.Web.UI.WebControls.WebParts.WebPartTransformer" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.WebPartTransformer</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-667">获取一个 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> 对象，用于在 Web 部件连接中两个不兼容的连接点之间转换数据。</span><span class="sxs-lookup"><span data-stu-id="c9af2-667">Gets a <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> object that is used to transform data between two otherwise incompatible connection points in a Web Parts connection.</span></span></summary>
        <value><span data-ttu-id="c9af2-668"><see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />。</span><span class="sxs-lookup"><span data-stu-id="c9af2-668">A <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />.</span></span> <span data-ttu-id="c9af2-669">默认值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="c9af2-669">The default value is <see langword="null" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-670">在 Web 部件连接中，有两种方法可以连接在连接中的提供程序和使用者控件。</span><span class="sxs-lookup"><span data-stu-id="c9af2-670">In a Web Parts connection, there are two ways in which the provider and consumer controls in the connection can connect.</span></span> <span data-ttu-id="c9af2-671">可以建立直接连接，通过其各自<xref:System.Web.UI.WebControls.WebParts.ConnectionPoint>对象和理解的这两个控件的接口类型。</span><span class="sxs-lookup"><span data-stu-id="c9af2-671">They can connect directly, through their respective <xref:System.Web.UI.WebControls.WebParts.ConnectionPoint> objects and an interface type that is understood by both controls.</span></span> <span data-ttu-id="c9af2-672">或者，如果它们是不兼容，它们可以直接连接，使用<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>将来自提供程序接口实例转换为使用者所理解的类型的对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-672">Or, if they are incompatible, they can connect indirectly, using a <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object that transforms an interface instance from a provider into a type understood by a consumer.</span></span>  
  
 <span data-ttu-id="c9af2-673">转换器需要作为连接的一部分时<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer%2A>属性提供对引用<xref:System.Web.UI.WebControls.WebParts.WebPartTransformer>对象。</span><span class="sxs-lookup"><span data-stu-id="c9af2-673">When a transformer is needed as part of a connection, the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer%2A> property provides a reference to the <xref:System.Web.UI.WebControls.WebParts.WebPartTransformer> object.</span></span> <span data-ttu-id="c9af2-674">可以通过添加自定义转换器 （或其中一个 Web 部件控件集提供转换器） 的标记添加的网页，以声明方式在标记中的连接的转换器内,`<asp:WebPartConnection>`元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-674">You can add a transformer for a connection declaratively in the markup of a Web page, by adding a tag for a custom transformer (or one of the transformers provided with the Web Parts control set) within the `<asp:WebPartConnection>` element.</span></span> <span data-ttu-id="c9af2-675">您还可以添加转换器，以编程方式在代码中，创建它的一个实例并调用<xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%28System.Web.UI.WebControls.WebParts.WebPart%2CSystem.Web.UI.WebControls.WebParts.ProviderConnectionPoint%2CSystem.Web.UI.WebControls.WebParts.WebPart%2CSystem.Web.UI.WebControls.WebParts.ConsumerConnectionPoint%2CSystem.Web.UI.WebControls.WebParts.WebPartTransformer%29>方法<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件创建的连接，并向它传递转换器对象以及其他必需的参数。</span><span class="sxs-lookup"><span data-stu-id="c9af2-675">You can also add a transformer programmatically, creating an instance of it in your code, and calling the <xref:System.Web.UI.WebControls.WebParts.WebPartManager.ConnectWebParts%28System.Web.UI.WebControls.WebParts.WebPart%2CSystem.Web.UI.WebControls.WebParts.ProviderConnectionPoint%2CSystem.Web.UI.WebControls.WebParts.WebPart%2CSystem.Web.UI.WebControls.WebParts.ConsumerConnectionPoint%2CSystem.Web.UI.WebControls.WebParts.WebPartTransformer%29> method on the <xref:System.Web.UI.WebControls.WebParts.WebPartManager> control to create the connection, passing to it the transformer object along with the other required parameters.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-676">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-676">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Transformers">
      <MemberSignature Language="C#" Value="public System.Web.UI.WebControls.WebParts.WebPartTransformerCollection Transformers { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Web.UI.WebControls.WebParts.WebPartTransformerCollection Transformers" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transformers As WebPartTransformerCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Web::UI::WebControls::WebParts::WebPartTransformerCollection ^ Transformers { System::Web::UI::WebControls::WebParts::WebPartTransformerCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Transformers : System.Web.UI.WebControls.WebParts.WebPartTransformerCollection" Usage="System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Web.UI.PersistenceMode(System.Web.UI.PersistenceMode.InnerDefaultProperty)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.EditorBrowsable(System.ComponentModel.EditorBrowsableState.Never)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.WebPartTransformerCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="c9af2-677">获取由 Web 部件控件集内部使用的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> 对象的集合。</span><span class="sxs-lookup"><span data-stu-id="c9af2-677">Gets a collection of <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> objects used internally by the Web Parts control set.</span></span></summary>
        <value><span data-ttu-id="c9af2-678">一个包含 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformerCollection" /> 对象的 <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" />。</span><span class="sxs-lookup"><span data-stu-id="c9af2-678">A <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformerCollection" /> containing <see cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformer" /> objects.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c9af2-679"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers%2A>属性永远不会由开发人员应使用。</span><span class="sxs-lookup"><span data-stu-id="c9af2-679">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers%2A> property is never intended for use by developers.</span></span> <span data-ttu-id="c9af2-680">若要访问连接相关联的转换器，开发人员应始终使用<xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="c9af2-680">To access the transformer associated with a connection, developers should always use the <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer%2A> property.</span></span>  
  
 <span data-ttu-id="c9af2-681"><xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers%2A>属性在内部由 Web 部件控件集用来使页面开发人员内声明转换器元素`<asp:webpartconnection>`Web 页的标记中的元素。</span><span class="sxs-lookup"><span data-stu-id="c9af2-681">The <xref:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformers%2A> property is used internally by the Web Parts control set to enable page developers to declare transformer elements within the `<asp:webpartconnection>` element in the markup of a Web page.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartTransformerCollection" />
        <altmember cref="P:System.Web.UI.WebControls.WebParts.WebPartConnection.Transformer" />
        <related type="Article" href="https://docs.microsoft.com/previous-versions/aspnet/e0s9t4ck(v=vs.100)"><span data-ttu-id="c9af2-682">ASP.NET Web 部件控件</span><span class="sxs-lookup"><span data-stu-id="c9af2-682">ASP.NET Web Parts Controls</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>