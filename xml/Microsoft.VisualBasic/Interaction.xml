<Type Name="Interaction" FullName="Microsoft.VisualBasic.Interaction">
  <Metadata><Meta Name="ms.openlocfilehash" Value="57cc67b95b6fbf6eed94eab478442e8ba9345b46" /><Meta Name="ms.sourcegitcommit" Value="bc24a3ba616ee1df8b858f9400cae4f058ea3a7e" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="06/19/2019" /><Meta Name="ms.locfileid" Value="67238938" /></Metadata><TypeSignature Language="C#" Value="public sealed class Interaction" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit Interaction extends System.Object" />
  <TypeSignature Language="DocId" Value="T:Microsoft.VisualBasic.Interaction" />
  <TypeSignature Language="VB.NET" Value="Public Module Interaction" />
  <TypeSignature Language="C++ CLI" Value="public ref class Interaction sealed" />
  <TypeSignature Language="F#" Value="type Interaction = class" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic</AssemblyName>
    <AssemblyVersion>7.0.5000.0</AssemblyVersion>
    <AssemblyVersion>8.0.0.0</AssemblyVersion>
    <AssemblyVersion>10.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
    <AssemblyVersion>10.0.4.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>Microsoft.VisualBasic.CompilerServices.StandardModule</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="5479a-101"><see langword="Interaction" /> 模块包含用于与对象、应用程序和系统交互的过程。</span><span class="sxs-lookup"><span data-stu-id="5479a-101">The <see langword="Interaction" /> module contains procedures used to interact with objects, applications, and systems.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-102">此模块支持的 Visual Basic 语言关键字和运行时库成员，运行其他程序，调用方法或属性，从计算机发出提示音，提供的命令行字符串、 操作 COM 对象，并控制对话框。</span><span class="sxs-lookup"><span data-stu-id="5479a-102">This module supports the Visual Basic language keywords and run-time library members that run other programs, call a method or property, sound a beep from the computer, provide a command-line string, manipulate COM objects, and control dialog boxes.</span></span>  
  
## Examples  
 <span data-ttu-id="5479a-103">下面的示例使用`Shell`函数运行用户指定的应用程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-103">The following example uses the `Shell` function to run an application specified by the user.</span></span> <span data-ttu-id="5479a-104">指定<xref:Microsoft.VisualBasic.AppWinStyle.NormalFocus?displayProperty=nameWithType>为第二个参数将应用程序打开在正常大小，使其具有焦点。</span><span class="sxs-lookup"><span data-stu-id="5479a-104">Specifying <xref:Microsoft.VisualBasic.AppWinStyle.NormalFocus?displayProperty=nameWithType> as the second argument opens the application in normal size and gives it the focus.</span></span>  
  
```vb  
Dim procID As Integer  
' Run calculator.  
procID = Shell("C:\Windows\system32\calc.exe", AppWinStyle.NormalFocus)  
```  
  
 ]]></format>
    </remarks>
    <related type="Article" href="~/docs/visual-basic/language-reference/keywords/information-and-interaction-summary.md"><span data-ttu-id="5479a-105">信息和交互摘要</span><span class="sxs-lookup"><span data-stu-id="5479a-105">Information and Interaction Summary</span></span></related>
    <related type="Article" href="~/docs/visual-basic/language-reference/keywords/index.md"><span data-ttu-id="5479a-106">关键字 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5479a-106">Keywords (Visual Basic)</span></span></related>
    <related type="Article" href="~/docs/visual-basic/language-reference/runtime-library-members.md"><span data-ttu-id="5479a-107">Visual Basic 运行时库成员</span><span class="sxs-lookup"><span data-stu-id="5479a-107">Visual Basic Run-Time Library Members</span></span></related>
  </Docs>
  <Members>
    <MemberGroup MemberName="AppActivate">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="5479a-108">激活已经正在运行的应用程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-108">Activates an application that is already running.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="AppActivate">
      <MemberSignature Language="C#" Value="public static void AppActivate (int ProcessId);" />
      <MemberSignature Language="ILAsm" Value=".method public static void AppActivate(int32 ProcessId) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.AppActivate(System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub AppActivate (ProcessId As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void AppActivate(int ProcessId);" />
      <MemberSignature Language="F#" Value="static member AppActivate : int -&gt; unit" Usage="Microsoft.VisualBasic.Interaction.AppActivate ProcessId" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ProcessId" Type="System.Int32" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="ProcessId"><span data-ttu-id="5479a-109"><see langword="Integer" />，指定分配给该进程的 Win32 进程 ID 号。</span><span class="sxs-lookup"><span data-stu-id="5479a-109"><see langword="Integer" /> specifying the Win32 process ID number assigned to this process.</span></span> <span data-ttu-id="5479a-110">可以使用 <see cref="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" /> 返回的 ID，前提是该 ID 不为零。</span><span class="sxs-lookup"><span data-stu-id="5479a-110">You can use the ID returned by the <see cref="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" />, provided it is not zero.</span></span></param>
        <summary><span data-ttu-id="5479a-111">激活已经正在运行的应用程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-111">Activates an application that is already running.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-112">您使用`AppActivate`使应用程序的活动窗口成为焦点。</span><span class="sxs-lookup"><span data-stu-id="5479a-112">You use `AppActivate` to bring an application's active window into focus.</span></span> <span data-ttu-id="5479a-113">不可能有一个句柄或向活动窗口的引用，或甚至知道哪个窗口在给定时刻处于活动状态。</span><span class="sxs-lookup"><span data-stu-id="5479a-113">You might not have a handle or a reference to the active window, or even know which window is active at a given moment.</span></span> <span data-ttu-id="5479a-114">在这种情况下，不能使用<xref:System.Windows.Forms.Control.Focus%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="5479a-114">In such a case, you cannot use the <xref:System.Windows.Forms.Control.Focus%2A> method.</span></span>  
  
 <span data-ttu-id="5479a-115">`AppActivate`函数，将焦点更改到的命名应用程序或窗口，但不会影响是否是最大化或最小化。</span><span class="sxs-lookup"><span data-stu-id="5479a-115">The `AppActivate` function changes the focus to the named application or window but does not affect whether it is maximized or minimized.</span></span> <span data-ttu-id="5479a-116">当用户执行某些操作来更改焦点或关闭窗口时，焦点将移走激活的应用程序窗口。</span><span class="sxs-lookup"><span data-stu-id="5479a-116">Focus moves away from the activated application window when the user takes some action to change the focus or close the window.</span></span> <span data-ttu-id="5479a-117">可以使用`Shell`函数以启动应用程序并设置窗口样式。</span><span class="sxs-lookup"><span data-stu-id="5479a-117">You can use the `Shell` function to start an application and set the window style.</span></span>  
  
 <span data-ttu-id="5479a-118">如果您使用`Title`参数，`AppActivate`使用不区分大小写的比较，但要求的标题栏内容完全匹配。</span><span class="sxs-lookup"><span data-stu-id="5479a-118">If you use the `Title` parameter, `AppActivate` uses a case-insensitive comparison but otherwise requires an exact match with the contents of the title bar.</span></span> <span data-ttu-id="5479a-119">它首先会查找顶级窗口，然后通过子窗口。</span><span class="sxs-lookup"><span data-stu-id="5479a-119">It first looks through the top-level windows and then through the child windows.</span></span> <span data-ttu-id="5479a-120">如果它找不到匹配项，则会引发<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="5479a-120">If it cannot find a match, it throws an <xref:System.ArgumentException>.</span></span>  
  
 <span data-ttu-id="5479a-121">可以使用`AppActivate`仅与拥有 windows 的过程。</span><span class="sxs-lookup"><span data-stu-id="5479a-121">You can use `AppActivate` only with processes that own windows.</span></span> <span data-ttu-id="5479a-122">大多数的控制台应用程序是否拥有的 windows，这意味着，它们不会在列表中会显示处理`AppActivate`搜索。</span><span class="sxs-lookup"><span data-stu-id="5479a-122">Most console applications do not own windows, which means that they do not appear in the list of processes that `AppActivate` searches.</span></span> <span data-ttu-id="5479a-123">从一个控制台应用程序运行时，系统将创建单独的进程来运行应用程序，并将输出返回到控制台进程。</span><span class="sxs-lookup"><span data-stu-id="5479a-123">When running from a console application, the system creates a separate process to run the application and returns the output to the console process.</span></span> <span data-ttu-id="5479a-124">因此，当你请求的当前进程 ID，你获得此单独的进程的进程 ID 而不是控制台应用程序的进程 id。</span><span class="sxs-lookup"><span data-stu-id="5479a-124">Consequently, when you request the current process ID, you get the process ID of this separate process, rather than the console application's process ID.</span></span>  
  
 <span data-ttu-id="5479a-125">在运行时，`AppActivate`函数会激活任何运行的应用程序具有与匹配标题`Title`或具有匹配的进程 ID `ProcessId`。</span><span class="sxs-lookup"><span data-stu-id="5479a-125">At run time, the `AppActivate` function activates any running application with a title that matches `Title` or with a process ID that matches `ProcessId`.</span></span> <span data-ttu-id="5479a-126">如果没有完全匹配项，则会激活其标题字符串结尾的任何应用程序`Title`。</span><span class="sxs-lookup"><span data-stu-id="5479a-126">If there is no exact match, it activates any application whose title string ends with `Title`.</span></span> <span data-ttu-id="5479a-127">如果没有名为多个应用程序`Title`，则`AppActivate`函数随机选择一个用于激活。</span><span class="sxs-lookup"><span data-stu-id="5479a-127">If there is more than one application named `Title`, the `AppActivate` function arbitrarily chooses one to activate.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5479a-128">`AppActivate`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-128">The `AppActivate` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-129">有关更多信息，请参见<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="5479a-129">For more information, see <xref:System.Security.Permissions.UIPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-130">此示例演示了的各种用法`AppActivate`函数以激活应用程序窗口。</span><span class="sxs-lookup"><span data-stu-id="5479a-130">This example illustrates various uses of the `AppActivate` function to activate an application window.</span></span> <span data-ttu-id="5479a-131">如果未运行 Notepad 进程，则本示例引发<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="5479a-131">If a Notepad process is not running, the example throws an <xref:System.ArgumentException>.</span></span> <span data-ttu-id="5479a-132">`Shell`过程假设应用程序中指定的路径。</span><span class="sxs-lookup"><span data-stu-id="5479a-132">The `Shell` procedure assumes the applications are in the paths specified.</span></span>  
  
 [!code-vb[VbVbalrCatRef#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" />
        <altmember cref="M:System.Windows.Forms.Control.Focus" />
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <Member MemberName="AppActivate">
      <MemberSignature Language="C#" Value="public static void AppActivate (string Title);" />
      <MemberSignature Language="ILAsm" Value=".method public static void AppActivate(string Title) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.AppActivate(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub AppActivate (Title As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void AppActivate(System::String ^ Title);" />
      <MemberSignature Language="F#" Value="static member AppActivate : string -&gt; unit" Usage="Microsoft.VisualBasic.Interaction.AppActivate Title" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Title" Type="System.String" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="Title"><span data-ttu-id="5479a-133"><see langword="String" /> 表达式，用于指定要激活的应用程序的标题栏中的标题。</span><span class="sxs-lookup"><span data-stu-id="5479a-133"><see langword="String" /> expression specifying the title in the title bar of the application you want to activate.</span></span> <span data-ttu-id="5479a-134">可以使用启动应用程序后分配给该应用程序的标题。</span><span class="sxs-lookup"><span data-stu-id="5479a-134">You can use the title assigned to the application when it was launched.</span></span></param>
        <summary><span data-ttu-id="5479a-135">激活已经正在运行的应用程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-135">Activates an application that is already running.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-136">您使用`AppActivate`使应用程序的活动窗口成为焦点。</span><span class="sxs-lookup"><span data-stu-id="5479a-136">You use `AppActivate` to bring an application's active window into focus.</span></span> <span data-ttu-id="5479a-137">不可能有一个句柄或向活动窗口的引用，或甚至知道哪个窗口在给定时刻处于活动状态。</span><span class="sxs-lookup"><span data-stu-id="5479a-137">You might not have a handle or a reference to the active window, or even know which window is active at a given moment.</span></span> <span data-ttu-id="5479a-138">在这种情况下，不能使用<xref:System.Windows.Forms.Control.Focus%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="5479a-138">In such a case, you cannot use the <xref:System.Windows.Forms.Control.Focus%2A> method.</span></span>  
  
 <span data-ttu-id="5479a-139">`AppActivate`函数，将焦点更改到的命名应用程序或窗口，但不会影响是否是最大化或最小化。</span><span class="sxs-lookup"><span data-stu-id="5479a-139">The `AppActivate` function changes the focus to the named application or window but does not affect whether it is maximized or minimized.</span></span> <span data-ttu-id="5479a-140">当用户执行某些操作来更改焦点或关闭窗口时，焦点将移走激活的应用程序窗口。</span><span class="sxs-lookup"><span data-stu-id="5479a-140">Focus moves away from the activated application window when the user takes some action to change the focus or close the window.</span></span> <span data-ttu-id="5479a-141">可以使用`Shell`函数以启动应用程序并设置窗口样式。</span><span class="sxs-lookup"><span data-stu-id="5479a-141">You can use the `Shell` function to start an application and set the window style.</span></span>  
  
 <span data-ttu-id="5479a-142">如果您使用`Title`参数，`AppActivate`使用不区分大小写的比较，但要求的标题栏内容完全匹配。</span><span class="sxs-lookup"><span data-stu-id="5479a-142">If you use the `Title` parameter, `AppActivate` uses a case-insensitive comparison but otherwise requires an exact match with the contents of the title bar.</span></span> <span data-ttu-id="5479a-143">它首先会查找顶级窗口，然后通过子窗口。</span><span class="sxs-lookup"><span data-stu-id="5479a-143">It first looks through the top-level windows and then through the child windows.</span></span> <span data-ttu-id="5479a-144">如果它找不到匹配项，则会引发<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="5479a-144">If it cannot find a match, it throws an <xref:System.ArgumentException>.</span></span>  
  
 <span data-ttu-id="5479a-145">可以使用`AppActivate`仅与拥有 windows 的过程。</span><span class="sxs-lookup"><span data-stu-id="5479a-145">You can use `AppActivate` only with processes that own windows.</span></span> <span data-ttu-id="5479a-146">大多数的控制台应用程序是否拥有的 windows，这意味着，它们不会在列表中会显示处理`AppActivate`搜索。</span><span class="sxs-lookup"><span data-stu-id="5479a-146">Most console applications do not own windows, which means that they do not appear in the list of processes that `AppActivate` searches.</span></span> <span data-ttu-id="5479a-147">从一个控制台应用程序运行时，系统将创建单独的进程来运行应用程序，并将输出返回到控制台进程。</span><span class="sxs-lookup"><span data-stu-id="5479a-147">When running from a console application, the system creates a separate process to run the application and returns the output to the console process.</span></span> <span data-ttu-id="5479a-148">因此，当你请求的当前进程 ID，你获得此单独的进程的进程 ID 而不是控制台应用程序的进程 id。</span><span class="sxs-lookup"><span data-stu-id="5479a-148">Consequently, when you request the current process ID, you get the process ID of this separate process, rather than the console application's process ID.</span></span>  
  
 <span data-ttu-id="5479a-149">在运行时，`AppActivate`函数会激活任何运行的应用程序具有与匹配标题`Title`或具有匹配的进程 ID `ProcessId`。</span><span class="sxs-lookup"><span data-stu-id="5479a-149">At run time, the `AppActivate` function activates any running application with a title that matches `Title` or with a process ID that matches `ProcessId`.</span></span> <span data-ttu-id="5479a-150">如果没有完全匹配项，则会激活其标题字符串结尾的任何应用程序`Title`。</span><span class="sxs-lookup"><span data-stu-id="5479a-150">If there is no exact match, it activates any application whose title string ends with `Title`.</span></span> <span data-ttu-id="5479a-151">如果没有名为多个应用程序`Title`，则`AppActivate`函数随机选择一个用于激活。</span><span class="sxs-lookup"><span data-stu-id="5479a-151">If there is more than one application named `Title`, the `AppActivate` function arbitrarily chooses one to activate.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5479a-152">`AppActivate`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-152">The `AppActivate` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-153">有关更多信息，请参见<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="5479a-153">For more information, see <xref:System.Security.Permissions.UIPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-154">此示例演示了的各种用法`AppActivate`函数以激活应用程序窗口。</span><span class="sxs-lookup"><span data-stu-id="5479a-154">This example illustrates various uses of the `AppActivate` function to activate an application window.</span></span> <span data-ttu-id="5479a-155">如果未运行 Notepad 进程，则本示例引发<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="5479a-155">If a Notepad process is not running, the example throws an <xref:System.ArgumentException>.</span></span> <span data-ttu-id="5479a-156">`Shell`过程假设应用程序中指定的路径。</span><span class="sxs-lookup"><span data-stu-id="5479a-156">The `Shell` procedure assumes the applications are in the paths specified.</span></span>  
  
 [!code-vb[VbVbalrCatRef#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" />
        <altmember cref="M:System.Windows.Forms.Control.Focus" />
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <Member MemberName="Beep">
      <MemberSignature Language="C#" Value="public static void Beep ();" />
      <MemberSignature Language="ILAsm" Value=".method public static void Beep() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Beep" />
      <MemberSignature Language="VB.NET" Value="Public Sub Beep ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Beep();" />
      <MemberSignature Language="F#" Value="static member Beep : unit -&gt; unit" Usage="Microsoft.VisualBasic.Interaction.Beep " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="5479a-157">通过计算机扬声器提示音。</span><span class="sxs-lookup"><span data-stu-id="5479a-157">Sounds a tone through the computer's speaker.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-158">俯仰和提示音的持续时间取决于硬件和系统软件，因此有所不同的计算机。</span><span class="sxs-lookup"><span data-stu-id="5479a-158">The pitch and duration of the beep depend on your hardware and system software and therefore vary among computers.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5479a-159">`Beep`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-159">The `Beep` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-160">有关更多信息，请参见<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="5479a-160">For more information, see <xref:System.Security.Permissions.UIPermission>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-161">此示例使用 `Beep` 函数通过计算机的扬声器发出音调。</span><span class="sxs-lookup"><span data-stu-id="5479a-161">This example uses the `Beep` function to sound a tone through the computer's speaker.</span></span>  
  
 [!code-vb[VbVbalrCatRef#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#59)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="~/docs/visual-basic/language-reference/runtime-library-members.md"><span data-ttu-id="5479a-162">Visual Basic 运行时库成员</span><span class="sxs-lookup"><span data-stu-id="5479a-162">Visual Basic Run-Time Library Members</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/playing-sounds.md"><span data-ttu-id="5479a-163">播放声音</span><span class="sxs-lookup"><span data-stu-id="5479a-163">Playing Sounds</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CallByName">
      <MemberSignature Language="C#" Value="public static object CallByName (object ObjectRef, string ProcName, Microsoft.VisualBasic.CallType UseCallType, params object[] Args);" />
      <MemberSignature Language="ILAsm" Value=".method public static object CallByName(object ObjectRef, string ProcName, valuetype Microsoft.VisualBasic.CallType UseCallType, object[] Args) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.CallByName(System.Object,System.String,Microsoft.VisualBasic.CallType,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Function CallByName (ObjectRef As Object, ProcName As String, UseCallType As CallType, ParamArray Args As Object()) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ CallByName(System::Object ^ ObjectRef, System::String ^ ProcName, Microsoft::VisualBasic::CallType UseCallType, ... cli::array &lt;System::Object ^&gt; ^ Args);" />
      <MemberSignature Language="F#" Value="static member CallByName : obj * string * Microsoft.VisualBasic.CallType * obj[] -&gt; obj" Usage="Microsoft.VisualBasic.Interaction.CallByName (ObjectRef, ProcName, UseCallType, Args)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ObjectRef" Type="System.Object" />
        <Parameter Name="ProcName" Type="System.String" />
        <Parameter Name="UseCallType" Type="Microsoft.VisualBasic.CallType" />
        <Parameter Name="Args" Type="System.Object[]">
          <Attributes>
            <Attribute FrameworkAlternate="netcore-3.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="ObjectRef"><span data-ttu-id="5479a-164">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-164">Required.</span></span> <span data-ttu-id="5479a-165"><see langword="Object" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-165"><see langword="Object" />.</span></span> <span data-ttu-id="5479a-166">一个指向公开属性或方法的对象的指针。</span><span class="sxs-lookup"><span data-stu-id="5479a-166">A pointer to the object exposing the property or method.</span></span></param>
        <param name="ProcName"><span data-ttu-id="5479a-167">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-167">Required.</span></span> <span data-ttu-id="5479a-168"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-168"><see langword="String" />.</span></span> <span data-ttu-id="5479a-169">一个字符串表达式，包含对象的属性或方法的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-169">A string expression containing the name of the property or method on the object.</span></span></param>
        <param name="UseCallType"><span data-ttu-id="5479a-170">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-170">Required.</span></span> <span data-ttu-id="5479a-171">类型 <see cref="T:Microsoft.VisualBasic.CallType" /> 的一个枚举成员，它表示正在被调用的过程的类型。</span><span class="sxs-lookup"><span data-stu-id="5479a-171">An enumeration member of type <see cref="T:Microsoft.VisualBasic.CallType" /> representing the type of procedure being called.</span></span> <span data-ttu-id="5479a-172"><see langword="CallType" /> 的值可以是 <see langword="Method" />、<see langword="Get" /> 或 <see langword="Set" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-172">The value of <see langword="CallType" /> can be <see langword="Method" />, <see langword="Get" />, or <see langword="Set" />.</span></span></param>
        <param name="Args"><span data-ttu-id="5479a-173">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-173">Optional.</span></span> <span data-ttu-id="5479a-174"><see langword="ParamArray" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-174"><see langword="ParamArray" />.</span></span> <span data-ttu-id="5479a-175">一个形参数组，包含要传递给正在调用的属性或方法的实参。</span><span class="sxs-lookup"><span data-stu-id="5479a-175">A parameter array containing the arguments to be passed to the property or method being called.</span></span></param>
        <summary><span data-ttu-id="5479a-176">执行对象的方法，或者设置或返回对象的属性。</span><span class="sxs-lookup"><span data-stu-id="5479a-176">Executes a method on an object, or sets or returns a property on an object.</span></span></summary>
        <returns><span data-ttu-id="5479a-177">执行对象的方法，或者设置或返回对象的属性。</span><span class="sxs-lookup"><span data-stu-id="5479a-177">Executes a method on an object, or sets or returns a property on an object.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-178">`CallByName`函数用于在运行时获取的属性、 设置属性，或调用方法。</span><span class="sxs-lookup"><span data-stu-id="5479a-178">The `CallByName` function is used at runtime to get a property, set a property, or invoke a method.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-179">在以下示例中，使用第一行`CallByName`若要设置`Text`属性的文本框中，第二行检索的值`Text`属性，并在第三个行调用`Move`方法来移动文本框。</span><span class="sxs-lookup"><span data-stu-id="5479a-179">In the following example, the first line uses `CallByName` to set the `Text` property of a text box, the second line retrieves the value of the `Text` property, and the third line invokes the `Move` method to move the text box.</span></span>  
  
 [!code-vb[VbVbalrFunctions#99](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#99)]  
  
 [!code-vb[VbVbalrFunctions#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#20)]  
  
 <span data-ttu-id="5479a-180">下面的示例使用`CallByName`函数以调用`Add`和`Item`集合对象的方法。</span><span class="sxs-lookup"><span data-stu-id="5479a-180">The next example uses the `CallByName` function to invoke the `Add` and `Item` methods of a collection object.</span></span>  
  
 [!code-vb[VbVbalrFunctions#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-181">无效 <paramref name="UseCallType" /> 值；必须为 <see langword="Method" />、<see langword="Get" /> 或 <see langword="Set" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-181">Invalid <paramref name="UseCallType" /> value; must be <see langword="Method" />, <see langword="Get" />, or <see langword="Set" />.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.CallType" />
        <altmember cref="T:System.ArgumentException" />
        <related type="Article" href="~/docs/visual-basic/programming-guide/language-features/procedures/parameter-arrays.md"><span data-ttu-id="5479a-182">参数数组</span><span class="sxs-lookup"><span data-stu-id="5479a-182">Parameter Arrays</span></span></related>
        <related type="Article" href="~/docs/visual-basic/programming-guide/language-features/early-late-binding/calling-a-property-or-method-using-a-string-name.md"><span data-ttu-id="5479a-183">使用字符串名调用属性或方法</span><span class="sxs-lookup"><span data-stu-id="5479a-183">Calling a Property or Method Using a String Name</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Choose">
      <MemberSignature Language="C#" Value="public static object Choose (double Index, params object[] Choice);" />
      <MemberSignature Language="ILAsm" Value=".method public static object Choose(float64 Index, object[] Choice) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Choose(System.Double,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Function Choose (Index As Double, ParamArray Choice As Object()) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ Choose(double Index, ... cli::array &lt;System::Object ^&gt; ^ Choice);" />
      <MemberSignature Language="F#" Value="static member Choose : double * obj[] -&gt; obj" Usage="Microsoft.VisualBasic.Interaction.Choose (Index, Choice)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Index" Type="System.Double" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Choice" Type="System.Object[]" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <Attributes>
            <Attribute FrameworkAlternate="netframework-1.1">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="Index"><span data-ttu-id="5479a-184">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-184">Required.</span></span> <span data-ttu-id="5479a-185"><see langword="Double" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-185"><see langword="Double" />.</span></span> <span data-ttu-id="5479a-186">数值表达式，它得出的值在 1 和 <paramref name="Choice" /> 参数中传递的元素数量之间。</span><span class="sxs-lookup"><span data-stu-id="5479a-186">Numeric expression that results in a value between 1 and the number of elements passed in the <paramref name="Choice" /> argument.</span></span></param>
        <param name="Choice"><span data-ttu-id="5479a-187">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-187">Required.</span></span> <span data-ttu-id="5479a-188"><see langword="Object" /> 参数数组。</span><span class="sxs-lookup"><span data-stu-id="5479a-188"><see langword="Object" /> parameter array.</span></span> <span data-ttu-id="5479a-189">可以为以逗号分隔的 <see langword="Object" /> 变量或表达式列表或一维 <see langword="Object" /> 元素数组提供计算为 <see langword="Object" /> 数据类型的单个变量或表达式。</span><span class="sxs-lookup"><span data-stu-id="5479a-189">You can supply either a single variable or an expression that evaluates to the <see langword="Object" /> data type, to a list of <see langword="Object" /> variables or expressions separated by commas, or to a single-dimensional array of <see langword="Object" /> elements.</span></span></param>
        <summary><span data-ttu-id="5479a-190">从参数列表中选择和返回一个值。</span><span class="sxs-lookup"><span data-stu-id="5479a-190">Selects and returns a value from a list of arguments.</span></span></summary>
        <returns><span data-ttu-id="5479a-191">从参数列表中选择和返回一个值。</span><span class="sxs-lookup"><span data-stu-id="5479a-191">Selects and returns a value from a list of arguments.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-192">`Choose`函数返回列表中传递的成员`Choice()`的值根据`Index`。</span><span class="sxs-lookup"><span data-stu-id="5479a-192">The `Choose` function returns a member of the list passed in `Choice()`, based on the value of `Index`.</span></span> <span data-ttu-id="5479a-193">选择列表的第一个成员时`Index`为 1。</span><span class="sxs-lookup"><span data-stu-id="5479a-193">The first member of the list is selected when `Index` is 1.</span></span> <span data-ttu-id="5479a-194">选择列表的最后一个成员时`Index`是`UBound`(`Choice()`)。</span><span class="sxs-lookup"><span data-stu-id="5479a-194">The last member of the list is selected when `Index` is `UBound`(`Choice()`).</span></span> <span data-ttu-id="5479a-195">如果`Index`超出这些限制`Choose`返回`Nothing`。</span><span class="sxs-lookup"><span data-stu-id="5479a-195">If `Index` is outside these limits, `Choose` returns `Nothing`.</span></span>  
  
 <span data-ttu-id="5479a-196">如果`Index`不是整数，它正在计算之前四舍五入为最接近的整数。</span><span class="sxs-lookup"><span data-stu-id="5479a-196">If `Index` is not a whole number, it is rounded to the nearest whole number before being evaluated.</span></span>  
  
 <span data-ttu-id="5479a-197">可以使用`Choose`若要查找的值列表中的可能性。</span><span class="sxs-lookup"><span data-stu-id="5479a-197">You can use `Choose` to look up a value in a list of possibilities.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5479a-198">参数列表中的表达式可以包括函数调用。</span><span class="sxs-lookup"><span data-stu-id="5479a-198">The expressions in the argument list can include function calls.</span></span> <span data-ttu-id="5479a-199">作为准备为调用的参数列表的一部分`Choose`，Visual Basic 编译器在每个表达式中调用的每个函数。</span><span class="sxs-lookup"><span data-stu-id="5479a-199">As part of preparing the argument list for the call to `Choose`, the Visual Basic compiler calls every function in every expression.</span></span> <span data-ttu-id="5479a-200">这意味着您不能依赖于特定情况下选择了不同的表达式时未被调用函数`Index`。</span><span class="sxs-lookup"><span data-stu-id="5479a-200">This means that you cannot rely on a particular function not being called if a different expression is selected by `Index`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-201">此示例使用`Choose`函数来显示名称，以响应传递到过程中的索引`Ind`参数。</span><span class="sxs-lookup"><span data-stu-id="5479a-201">This example uses the `Choose` function to display a name in response to an index passed into the procedure in the `Ind` parameter.</span></span>  
  
 [!code-vb[VbVbalrFunctions#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#22)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.IIf(System.Boolean,System.Object,System.Object)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Switch(System.Object[])" />
        <related type="Article" href="~/docs/visual-basic/language-reference/statements/select-case-statement.md"><span data-ttu-id="5479a-202">Select...Case 语句 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5479a-202">Select...Case Statement (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Command">
      <MemberSignature Language="C#" Value="public static string Command ();" />
      <MemberSignature Language="ILAsm" Value=".method public static string Command() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Command" />
      <MemberSignature Language="VB.NET" Value="Public Function Command () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Command();" />
      <MemberSignature Language="F#" Value="static member Command : unit -&gt; string" Usage="Microsoft.VisualBasic.Interaction.Command " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="5479a-203">返回命令行的参数部分，该命令行用于启动 Visual Basic 或启动使用 Visual Basic 开发的可执行程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-203">Returns the argument portion of the command line used to start Visual Basic or an executable program developed with Visual Basic.</span></span> <span data-ttu-id="5479a-204"><see langword="My" /> 功能可以提供比 <see langword="Command" /> 函数更高的效率和更好的性能。</span><span class="sxs-lookup"><span data-stu-id="5479a-204">The <see langword="My" /> feature provides greater productivity and performance than the <see langword="Command" /> function.</span></span> <span data-ttu-id="5479a-205">有关详情，请参阅<see cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-205">For more information, see <see cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />.</span></span></summary>
        <returns><span data-ttu-id="5479a-206">命令行的参数部分，该命令行用于启动 Visual Basic 或启动使用 Visual Basic 开发的可执行程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-206">The argument portion of the command line used to start Visual Basic or an executable program developed with Visual Basic.</span></span>  
  
<span data-ttu-id="5479a-207"><see langword="My" /> 功能可以提供比 <see langword="Command" /> 函数更高的效率和更好的性能。</span><span class="sxs-lookup"><span data-stu-id="5479a-207">The <see langword="My" /> feature provides greater productivity and performance than the <see langword="Command" /> function.</span></span> <span data-ttu-id="5479a-208">有关更多信息，请参见<see cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-208">For more information, see <see cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-209">返回参数后，您可以搜索常见分隔符，例如空格、 向前或向后斜杠、 连字符或引号中，拆分或搜索每个参数的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-209">After the arguments are returned, you can search for common delimiters, such as spaces, backward or forward slashes, hyphens, or quotation marks, to split or search the string for individual parameters.</span></span>  
  
 <span data-ttu-id="5479a-210">有关使用 Visual Basic 开发和编译为.exe 文件，应用程序`Command`函数将返回命令行中，在此窗体上的应用程序的名称后显示的任何自变量： `MyApp(cmdlineargs)`。</span><span class="sxs-lookup"><span data-stu-id="5479a-210">For applications developed with Visual Basic and compiled to an .exe file, the `Command` function returns any arguments that appear after the name of the application on the command line, in this form: `MyApp(cmdlineargs)`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-211">此示例使用`Command`函数返回包含数组的对象的命令行参数。</span><span class="sxs-lookup"><span data-stu-id="5479a-211">This example uses the `Command` function to return the command-line arguments in an object that contains an array.</span></span>  
  
 [!code-vb[VbVbalrCatRef#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#58)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Environment.GetCommandLineArgs" />
        <altmember cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />
        <related type="Article" href="~/docs/visual-basic/language-reference/runtime-library-members.md"><span data-ttu-id="5479a-212">Visual Basic 运行时库成员</span><span class="sxs-lookup"><span data-stu-id="5479a-212">Visual Basic Run-Time Library Members</span></span></related>
        <related type="Article" href="~/docs/visual-basic/reference/command-line-compiler/index.md"><span data-ttu-id="5479a-213">Visual Basic 命令行编译器</span><span class="sxs-lookup"><span data-stu-id="5479a-213">Visual Basic command-line compiler</span></span></related>
        <related type="Article" href="~/docs/visual-basic/programming-guide/program-structure/structure-of-a-visual-basic-program.md"><span data-ttu-id="5479a-214">Visual Basic 程序的结构</span><span class="sxs-lookup"><span data-stu-id="5479a-214">Structure of a Visual Basic Program</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CreateObject">
      <MemberSignature Language="C#" Value="public static object CreateObject (string ProgId, string ServerName = &quot;&quot;);" />
      <MemberSignature Language="ILAsm" Value=".method public static object CreateObject(string ProgId, string ServerName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.CreateObject(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function CreateObject (ProgId As String, Optional ServerName As String = &quot;&quot;) As Object" />
      <MemberSignature Language="F#" Value="static member CreateObject : string * string -&gt; obj" Usage="Microsoft.VisualBasic.Interaction.CreateObject (ProgId, ServerName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ProgId" Type="System.String" />
        <Parameter Name="ServerName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="ProgId"><span data-ttu-id="5479a-215">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-215">Required.</span></span> <span data-ttu-id="5479a-216"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-216"><see langword="String" />.</span></span> <span data-ttu-id="5479a-217">要创建的对象的程序 ID。</span><span class="sxs-lookup"><span data-stu-id="5479a-217">The program ID of the object to create.</span></span></param>
        <param name="ServerName"><span data-ttu-id="5479a-218">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-218">Optional.</span></span> <span data-ttu-id="5479a-219"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-219"><see langword="String" />.</span></span> <span data-ttu-id="5479a-220">要在其上创建对象的网络服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-220">The name of the network server where the object will be created.</span></span> <span data-ttu-id="5479a-221">如果 <paramref name="ServerName" /> 是空字符串 ("")，则使用本地计算机。</span><span class="sxs-lookup"><span data-stu-id="5479a-221">If <paramref name="ServerName" /> is an empty string (""), the local computer is used.</span></span></param>
        <summary><span data-ttu-id="5479a-222">创建并返回对 COM 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="5479a-222">Creates and returns a reference to a COM object.</span></span> <span data-ttu-id="5479a-223">不能在 Visual Basic 中使用 <see langword="CreateObject" /> 创建这些类的实例，除非将类显式公开为 COM 组件。</span><span class="sxs-lookup"><span data-stu-id="5479a-223"><see langword="CreateObject" /> cannot be used to create instances of classes in Visual Basic unless those classes are explicitly exposed as COM components.</span></span></summary>
        <returns><span data-ttu-id="5479a-224">创建并返回对 COM 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="5479a-224">Creates and returns a reference to a COM object.</span></span> <span data-ttu-id="5479a-225">不能在 Visual Basic 中使用 <see langword="CreateObject" /> 创建这些类的实例，除非将类显式公开为 COM 组件。</span><span class="sxs-lookup"><span data-stu-id="5479a-225"><see langword="CreateObject" /> cannot be used to create instances of classes in Visual Basic unless those classes are explicitly exposed as COM components.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-226">若要创建 COM 组件的实例，请将返回的对象分配`CreateObject`给对象变量：</span><span class="sxs-lookup"><span data-stu-id="5479a-226">To create an instance of a COM component, assign the object returned by `CreateObject` to an object variable:</span></span>  
  
```vb  
Sub CreateADODB()  
   Dim adoApp As Object  
   adoApp = CreateObject("ADODB.Connection")  
End Sub  
```  
  
 <span data-ttu-id="5479a-227">用于存储返回的对象的对象变量的类型可能会影响应用程序的性能。</span><span class="sxs-lookup"><span data-stu-id="5479a-227">The type of object variable you use to store the returned object can affect your application's performance.</span></span> <span data-ttu-id="5479a-228">声明对象变量与`As Object`子句创建的变量可以包含对任何类型的对象的引用。</span><span class="sxs-lookup"><span data-stu-id="5479a-228">Declaring an object variable with the `As Object` clause creates a variable that can contain a reference to any type of object.</span></span> <span data-ttu-id="5479a-229">但是，对通过该变量的对象的访问是*后期绑定*，绑定，即发生在程序运行。</span><span class="sxs-lookup"><span data-stu-id="5479a-229">However, access to the object through that variable is *late-bound*, that is, the binding occurs when your program runs.</span></span> <span data-ttu-id="5479a-230">有很多原因应避免后期绑定，包括应用程序性能下降。</span><span class="sxs-lookup"><span data-stu-id="5479a-230">There are many reasons you should avoid late binding, including slower application performance.</span></span>  
  
 <span data-ttu-id="5479a-231">可以创建对象变量，即导致早期绑定的绑定时将编译该程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-231">You can create an object variable that results in early binding - that is, binding when the program is compiled.</span></span> <span data-ttu-id="5479a-232">为此，请添加对该对象的类型库的引用**COM**选项卡**添加引用**上的对话框**项目**菜单。</span><span class="sxs-lookup"><span data-stu-id="5479a-232">To do so, add a reference to the type library for your object from the **COM** tab of the **Add Reference** dialog box on the **Project** menu.</span></span> <span data-ttu-id="5479a-233">然后，声明您的对象的特定类型的对象变量。</span><span class="sxs-lookup"><span data-stu-id="5479a-233">Then declare the object variable of the specific type of your object.</span></span> <span data-ttu-id="5479a-234">在大多数情况下，它是使用更加高效`Dim`语句和主互操作程序集，以创建对象，它是使用比`CreateObject`函数。</span><span class="sxs-lookup"><span data-stu-id="5479a-234">In most cases, it is more efficient to use the `Dim` statement and a primary interop assembly to create objects than it is to use the `CreateObject` function.</span></span>  
  
## <a name="interacting-with-unmanaged-code"></a><span data-ttu-id="5479a-235">与非托管代码进行交互</span><span class="sxs-lookup"><span data-stu-id="5479a-235">Interacting with Unmanaged Code</span></span>  
 <span data-ttu-id="5479a-236">另一个问题是 COM 对象使用非托管的代码的代码而无需公共语言运行时的优势。</span><span class="sxs-lookup"><span data-stu-id="5479a-236">Another issue is that COM objects use unmanaged code - code without the benefit of the common language runtime.</span></span> <span data-ttu-id="5479a-237">没有了一定程度的复杂性涉及混合与非托管代码的托管的代码的 Visual Basic 从 com。</span><span class="sxs-lookup"><span data-stu-id="5479a-237">There is a fair degree of complexity involved in mixing the managed code of Visual Basic with unmanaged code from COM.</span></span> <span data-ttu-id="5479a-238">当添加对 COM 对象的引用时，Visual Basic 中搜索的主互操作程序集 (PIA) 的库;如果找到，则它使用它。</span><span class="sxs-lookup"><span data-stu-id="5479a-238">When you add a reference to a COM object, Visual Basic searches for a primary interop assembly (PIA) for that library; if it finds one, then it uses it.</span></span> <span data-ttu-id="5479a-239">如果找不到 PIA，然后创建包含本地互操作性类为每个类的 COM 库中的互操作性程序集。</span><span class="sxs-lookup"><span data-stu-id="5479a-239">If it does not find a PIA, then it creates an interoperability assembly that contains local interoperability classes for each class in the COM library.</span></span> <span data-ttu-id="5479a-240">有关详细信息，请参阅[.NET Framework 应用程序中的 COM 互操作性](~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="5479a-240">For more information, see [COM Interoperability in .NET Framework Applications](~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).</span></span>  
  
 <span data-ttu-id="5479a-241">通常应使用强绑定的对象和尽可能的主互操作程序集。</span><span class="sxs-lookup"><span data-stu-id="5479a-241">You should generally use strongly bound objects and primary interop assemblies whenever possible.</span></span> <span data-ttu-id="5479a-242">使用下面的示例`CreateObject`函数中演示的 Microsoft Office 对象仅目的。</span><span class="sxs-lookup"><span data-stu-id="5479a-242">The examples below use the `CreateObject` function with Microsoft Office objects for demonstration purposes only.</span></span> <span data-ttu-id="5479a-243">但是，这些对象是易于使用且更可靠，与相应的主互操作程序集一起使用时。</span><span class="sxs-lookup"><span data-stu-id="5479a-243">However, these objects are easier to use and more reliable when used with the appropriate primary interop assembly.</span></span>  
  
## <a name="creating-an-object-on-a-remote-computer"></a><span data-ttu-id="5479a-244">在远程计算机上创建的对象</span><span class="sxs-lookup"><span data-stu-id="5479a-244">Creating an Object on a Remote Computer</span></span>  
 <span data-ttu-id="5479a-245">通过将传递到计算机的名称，可以在一台联网的远程计算机上创建对象`ServerName`自变量的`CreateObject`函数。</span><span class="sxs-lookup"><span data-stu-id="5479a-245">You can create an object on a remote networked computer by passing the name of the computer to the `ServerName` argument of the `CreateObject` function.</span></span> <span data-ttu-id="5479a-246">该名称是共享名的计算机名称部分相同： 共享名为"\\\MyServer\Public，"`ServerName`是"MyServer"。</span><span class="sxs-lookup"><span data-stu-id="5479a-246">That name is the same as the Machine Name portion of a share name: for a share named "\\\MyServer\Public," `ServerName` is "MyServer."</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5479a-247">请参阅 COM 文档 （请参阅 Microsoft Developer Network） 上对应用程序的可访问远程网络计算机上的其他信息。</span><span class="sxs-lookup"><span data-stu-id="5479a-247">Refer to COM documentation (see Microsoft Developer Network) for additional information on making an application accessible on a remote networked computer.</span></span> <span data-ttu-id="5479a-248">您可能需要添加一个用于您的应用程序注册表项。</span><span class="sxs-lookup"><span data-stu-id="5479a-248">You may need to add a registry key for your application.</span></span>  
  
 <span data-ttu-id="5479a-249">以下代码将返回一个 Excel 的实例的版本号在名为的远程计算机上运行`MyServer`:</span><span class="sxs-lookup"><span data-stu-id="5479a-249">The following code returns the version number of an instance of Excel running on a remote computer named `MyServer`:</span></span>  
  
```vb  
Sub CreateRemoteExcelObj()  
    Dim xlApp As Object  
    ' Replace string "\\MyServer" with name of the remote computer.  
    xlApp = CreateObject("Excel.Application", "\\MyServer")  
    MsgBox(xlApp.Version)  
End Sub  
```  
  
 <span data-ttu-id="5479a-250">如果远程服务器名称不正确，或如果它不可用，会发生运行时错误。</span><span class="sxs-lookup"><span data-stu-id="5479a-250">If the remote server name is incorrect, or if it is unavailable, a run-time error occurs.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5479a-251">使用`CreateObject`时没有对象的当前实例。</span><span class="sxs-lookup"><span data-stu-id="5479a-251">Use `CreateObject` when there is no current instance of the object.</span></span> <span data-ttu-id="5479a-252">如果尚未运行对象的实例，启动的新实例，并创建指定类型的对象。</span><span class="sxs-lookup"><span data-stu-id="5479a-252">If an instance of the object is already running, a new instance is started, and an object of the specified type is created.</span></span> <span data-ttu-id="5479a-253">若要使用的当前实例，或启动应用程序并将其加载的文件，请使用`GetObject`函数。</span><span class="sxs-lookup"><span data-stu-id="5479a-253">To use the current instance, or to start the application and have it load a file, use the `GetObject` function.</span></span> <span data-ttu-id="5479a-254">如果对象已将自己注册为单实例对象，该对象的一个实例后，无论很多时候`CreateObject`执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-254">If an object has registered itself as a single-instance object, only one instance of the object is created, no matter how many times `CreateObject` is executed.</span></span>  
  
## <a name="creating-framework-objects"></a><span data-ttu-id="5479a-255">创建框架对象</span><span class="sxs-lookup"><span data-stu-id="5479a-255">Creating Framework Objects</span></span>  
 <span data-ttu-id="5479a-256">可以使用`CreateObject`函数只能用于创建 COM 对象。</span><span class="sxs-lookup"><span data-stu-id="5479a-256">You can use the `CreateObject` function only to create a COM object.</span></span> <span data-ttu-id="5479a-257">虽然没有完全等效机制用于创建.NET Framework 对象，但<xref:System.Activator>在<xref:System>命名空间包含用于创建本地或远程对象的方法。</span><span class="sxs-lookup"><span data-stu-id="5479a-257">While there is no exact equivalent mechanism for creating a .NET Framework object, the <xref:System.Activator> in the <xref:System> namespace contains methods to create local or remote objects.</span></span> <span data-ttu-id="5479a-258">具体而言，<xref:System.Activator.CreateInstance%2A>方法或<xref:System.Activator.CreateInstanceFrom%2A>方法可能会很有用。</span><span class="sxs-lookup"><span data-stu-id="5479a-258">In particular, the <xref:System.Activator.CreateInstance%2A> method or the <xref:System.Activator.CreateInstanceFrom%2A> method might be useful.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="5479a-259">`CreateObject`函数需要非托管的代码的权限，这可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-259">The `CreateObject` function requires unmanaged code permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-260">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>并[代码访问权限](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="5479a-260">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-261">下面的示例使用`CreateObject`函数创建一个 Microsoft Excel 工作表，并将工作表保存到文件。</span><span class="sxs-lookup"><span data-stu-id="5479a-261">The following example uses the `CreateObject` function to create a Microsoft Excel worksheet and saves the worksheet to a file.</span></span> <span data-ttu-id="5479a-262">若要使用此示例中，必须在运行此程序的计算机上安装 Excel。</span><span class="sxs-lookup"><span data-stu-id="5479a-262">To use this example, Excel must be installed on the computer where this program runs.</span></span> <span data-ttu-id="5479a-263">此外，必须添加对从类型库的引用**COM**选项卡**添加引用**上的对话框**项目**菜单。</span><span class="sxs-lookup"><span data-stu-id="5479a-263">Also, you must add a reference to the type library from the **COM** tab of the **Add Reference** dialog box on the **Project** menu.</span></span> <span data-ttu-id="5479a-264">类型库的名称各不相同，具体取决于您的计算机上安装的 Excel 的版本。</span><span class="sxs-lookup"><span data-stu-id="5479a-264">The name of the type library varies depending on the version of Excel installed on your computer.</span></span> <span data-ttu-id="5479a-265">例如，名为的类型库的 Microsoft Excel 2002 **Microsoft Excel 10.0 对象库**。</span><span class="sxs-lookup"><span data-stu-id="5479a-265">For example, the type library for Microsoft Excel 2002 is named **Microsoft Excel 10.0 Object Library**.</span></span>  
  
 [!code-vb[VbVbalrExcelObject#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrExcelObject/VB/Class1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Exception"><span data-ttu-id="5479a-266">服务器不可用。</span><span class="sxs-lookup"><span data-stu-id="5479a-266">Server is unavailable</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="5479a-267">不存在指定类型的对象。</span><span class="sxs-lookup"><span data-stu-id="5479a-267">No object of the specified type exists</span></span></exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetObject(System.String,System.String)" />
        <altmember cref="T:System.Exception" />
        <altmember cref="T:System.IO.FileNotFoundException" />
        <altmember cref="T:System.Activator" />
        <altmember cref="Overload:System.Activator.CreateInstance" />
        <altmember cref="Overload:System.Activator.CreateInstanceFrom" />
        <related type="Article" href="~/docs/visual-basic/language-reference/statements/dim-statement.md"><span data-ttu-id="5479a-268">Dim 语句 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5479a-268">Dim Statement (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/language-reference/statements/declare-statement.md"><span data-ttu-id="5479a-269">Declare Statement</span><span class="sxs-lookup"><span data-stu-id="5479a-269">Declare Statement</span></span></related>
        <related type="Article" href="~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md"><span data-ttu-id="5479a-270">.NET Framework 应用程序中的 COM 互操作性</span><span class="sxs-lookup"><span data-stu-id="5479a-270">COM Interoperability in .NET Framework Applications</span></span></related>
        <related type="Article" href="~/docs/framework/interop/index.md"><span data-ttu-id="5479a-271">与非托管代码交互操作</span><span class="sxs-lookup"><span data-stu-id="5479a-271">Interoperating with Unmanaged Code</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DeleteSetting">
      <MemberSignature Language="C#" Value="public static void DeleteSetting (string AppName, string Section = null, string Key = null);" />
      <MemberSignature Language="ILAsm" Value=".method public static void DeleteSetting(string AppName, string Section, string Key) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.DeleteSetting(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DeleteSetting (AppName As String, Optional Section As String = null, Optional Key As String = null)" />
      <MemberSignature Language="F#" Value="static member DeleteSetting : string * string * string -&gt; unit" Usage="Microsoft.VisualBasic.Interaction.DeleteSetting (AppName, Section, Key)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="AppName" Type="System.String" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Section" Type="System.String" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Key" Type="System.String" Index="2" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="AppName"><span data-ttu-id="5479a-272">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-272">Required.</span></span> <span data-ttu-id="5479a-273"><see langword="String" /> 表达式，包含应用节或项设置的应用程序或项目的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-273"><see langword="String" /> expression containing the name of the application or project to which the section or key setting applies.</span></span></param>
        <param name="Section"><span data-ttu-id="5479a-274">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-274">Required.</span></span> <span data-ttu-id="5479a-275"><see langword="String" /> 表达式，包含要从中删除项设置的节的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-275"><see langword="String" /> expression containing the name of the section from which the key setting is being deleted.</span></span> <span data-ttu-id="5479a-276">如果仅提供了 <paramref name="AppName" /> 和 <paramref name="Section" />，则将删除指定的节以及所有相关的项设置。</span><span class="sxs-lookup"><span data-stu-id="5479a-276">If only <paramref name="AppName" /> and <paramref name="Section" /> are provided, the specified section is deleted along with all related key settings.</span></span></param>
        <param name="Key"><span data-ttu-id="5479a-277">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-277">Optional.</span></span> <span data-ttu-id="5479a-278"><see langword="String" /> 表达式，包含要删除的项设置的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-278"><see langword="String" /> expression containing the name of the key setting being deleted.</span></span></param>
        <summary><span data-ttu-id="5479a-279">从 Windows 注册表中某个应用程序的项中删除一个节或一个项设置。</span><span class="sxs-lookup"><span data-stu-id="5479a-279">Deletes a section or key setting from an application's entry in the Windows registry.</span></span> <span data-ttu-id="5479a-280">与 <see langword="DeleteSetting" /> 函数相比，<see langword="My" /> 功能在注册表操作方面可为你提供更高的效率和更好的性能。</span><span class="sxs-lookup"><span data-stu-id="5479a-280">The <see langword="My" /> feature gives you greater productivity and performance in registry operations than the <see langword="DeleteSetting" /> function.</span></span> <span data-ttu-id="5479a-281">有关更多信息，请参见<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-281">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" /> .</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-282">如果未提供所有参数，则删除指定的设置。</span><span class="sxs-lookup"><span data-stu-id="5479a-282">If all arguments are provided, the specified setting is deleted.</span></span> <span data-ttu-id="5479a-283">如果您尝试使用会发生运行时错误`DeleteSetting`上不存在节或键设置。</span><span class="sxs-lookup"><span data-stu-id="5479a-283">A run-time error occurs if you attempt to use `DeleteSetting` on a nonexistent section or key setting.</span></span>  
  
 <span data-ttu-id="5479a-284">`DeleteSetting` 要求用户登录上将在操作由于`HKEY_LOCAL_USER`注册表项，直到用户以交互方式登录未处于活动状态。</span><span class="sxs-lookup"><span data-stu-id="5479a-284">`DeleteSetting` requires that a user be logged on since it operates under the `HKEY_LOCAL_USER` registry key, which is not active until a user logs on interactively.</span></span>  
  
 <span data-ttu-id="5479a-285">若要从非交互式进程 （如 Mtx.exe) 访问的注册表设置应存储在`HKEY_LOCAL_MACHINE\Software\`或`HKEY_USER\DEFAULT\Software`注册表项。</span><span class="sxs-lookup"><span data-stu-id="5479a-285">Registry settings that are to be accessed from a non-interactive process (such as Mtx.exe) should be stored under either the `HKEY_LOCAL_MACHINE\Software\` or the `HKEY_USER\DEFAULT\Software` registry keys.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-286">下面的示例首先使用`SaveSetting`过程来在 Windows 注册表中生成条目`MyApp`应用程序，然后使用`DeleteSetting`函数将其删除。</span><span class="sxs-lookup"><span data-stu-id="5479a-286">The following example first uses the `SaveSetting` procedure to make entries in the Windows registry for the `MyApp` application, and then uses the `DeleteSetting` function to remove them.</span></span> <span data-ttu-id="5479a-287">因为没有`Key`指定参数，则整个`Startup`则将删除节，其中包括节名称和所有其密钥。</span><span class="sxs-lookup"><span data-stu-id="5479a-287">Because no `Key` argument is specified, the whole `Startup` section is deleted, including the section name and all of its keys.</span></span>  
  
 [!code-vb[VbVbalrCatRef#45](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#45)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-288">用户没有登录。</span><span class="sxs-lookup"><span data-stu-id="5479a-288">User is not logged in.</span></span></exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetAllSettings(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.SaveSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Environ">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="5479a-289">返回与操作系统环境变量关联的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-289">Returns the string associated with an operating-system environment variable.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Environ">
      <MemberSignature Language="C#" Value="public static string Environ (int Expression);" />
      <MemberSignature Language="ILAsm" Value=".method public static string Environ(int32 Expression) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Environ(System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Environ (Expression As Integer) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Environ(int Expression);" />
      <MemberSignature Language="F#" Value="static member Environ : int -&gt; string" Usage="Microsoft.VisualBasic.Interaction.Environ Expression" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Expression" Type="System.Int32" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="Expression"><span data-ttu-id="5479a-290">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-290">Required.</span></span> <span data-ttu-id="5479a-291">此表达式用于计算包含环境变量名称的字符串，或对应于环境字符串表中环境字符串的数字顺序的整数。</span><span class="sxs-lookup"><span data-stu-id="5479a-291">Expression that evaluates either a string containing the name of an environment variable, or an integer corresponding to the numeric order of an environment string in the environment-string table.</span></span></param>
        <summary><span data-ttu-id="5479a-292">返回与操作系统环境变量关联的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-292">Returns the string associated with an operating-system environment variable.</span></span></summary>
        <returns><span data-ttu-id="5479a-293">与操作系统环境变量关联的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-293">The string associated with an operating-system environment variable.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-294">如果`Expression`包含一个字符串，<xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数在该环境变量的环境字符串表中返回分配给指定的环境字符串-即，后面等号 （=） 的文本的文本。</span><span class="sxs-lookup"><span data-stu-id="5479a-294">If `Expression` contains a string, the <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function returns the text assigned to the specified environment string - that is, the text following the equal sign (=) in the environment-string table for that environment variable.</span></span> <span data-ttu-id="5479a-295">如果在字符串`Expression`无法找到在环境字符串表中，一个零长度字符串 ("") 返回。</span><span class="sxs-lookup"><span data-stu-id="5479a-295">If the string in `Expression` cannot be found in the environment-string table, a zero-length string ("") is returned.</span></span>  
  
 <span data-ttu-id="5479a-296">如果`Expression`包含一个整数，占用的环境字符串表中的数字位置返回的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-296">If `Expression` contains an integer, the string occupying that numeric position in the environment-string table is returned.</span></span> <span data-ttu-id="5479a-297">在这种情况下，<xref:Microsoft.VisualBasic.Interaction.Environ%2A>返回所有文本，包括环境变量的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-297">In this case, <xref:Microsoft.VisualBasic.Interaction.Environ%2A> returns all of the text, including the name of the environment variable.</span></span> <span data-ttu-id="5479a-298">如果在指定位置中没有任何环境字符串<xref:Microsoft.VisualBasic.Interaction.Environ%2A>返回长度为零的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-298">If there is no environment string in the specified position, <xref:Microsoft.VisualBasic.Interaction.Environ%2A> returns a zero-length string.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="5479a-299"><xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数需要环境的权限，这可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-299">The <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function requires environment permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-300">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>并[代码访问权限](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="5479a-300">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-301">此示例使用<xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数提供入口数目和长度的`PATH`环境字符串表中的语句。</span><span class="sxs-lookup"><span data-stu-id="5479a-301">This example uses the <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function to supply the entry number and length of the `PATH` statement from the environment-string table.</span></span>  
  
 [!code-vb[VbVbalrCatRef#28](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-302">缺少 <paramref name="Expression" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-302"><paramref name="Expression" /> is missing.</span></span></exception>
        <altmember cref="T:System.ArgumentException" />
        <related type="Article" href="~/docs/visual-basic/language-reference/runtime-library-members.md"><span data-ttu-id="5479a-303">Visual Basic 运行时库成员</span><span class="sxs-lookup"><span data-stu-id="5479a-303">Visual Basic Run-Time Library Members</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Environ">
      <MemberSignature Language="C#" Value="public static string Environ (string Expression);" />
      <MemberSignature Language="ILAsm" Value=".method public static string Environ(string Expression) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Environ(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function Environ (Expression As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Environ(System::String ^ Expression);" />
      <MemberSignature Language="F#" Value="static member Environ : string -&gt; string" Usage="Microsoft.VisualBasic.Interaction.Environ Expression" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Expression" Type="System.String" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="Expression"><span data-ttu-id="5479a-304">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-304">Required.</span></span> <span data-ttu-id="5479a-305">此表达式用于计算包含环境变量名称的字符串，或对应于环境字符串表中环境字符串的数字顺序的整数。</span><span class="sxs-lookup"><span data-stu-id="5479a-305">Expression that evaluates either a string containing the name of an environment variable, or an integer corresponding to the numeric order of an environment string in the environment-string table.</span></span></param>
        <summary><span data-ttu-id="5479a-306">返回与操作系统环境变量关联的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-306">Returns the string associated with an operating-system environment variable.</span></span></summary>
        <returns><span data-ttu-id="5479a-307">与操作系统环境变量关联的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-307">The string associated with an operating-system environment variable.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-308">如果`Expression`包含一个字符串，<xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数在该环境变量的环境字符串表中返回分配给指定的环境字符串-即，后面等号 （=） 的文本的文本。</span><span class="sxs-lookup"><span data-stu-id="5479a-308">If `Expression` contains a string, the <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function returns the text assigned to the specified environment string - that is, the text following the equal sign (=) in the environment-string table for that environment variable.</span></span> <span data-ttu-id="5479a-309">如果在字符串`Expression`无法找到在环境字符串表中，一个零长度字符串 ("") 返回。</span><span class="sxs-lookup"><span data-stu-id="5479a-309">If the string in `Expression` cannot be found in the environment-string table, a zero-length string ("") is returned.</span></span>  
  
 <span data-ttu-id="5479a-310">如果`Expression`包含一个整数，占用的环境字符串表中的数字位置返回的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-310">If `Expression` contains an integer, the string occupying that numeric position in the environment-string table is returned.</span></span> <span data-ttu-id="5479a-311">在这种情况下，<xref:Microsoft.VisualBasic.Interaction.Environ%2A>返回所有文本，包括环境变量的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-311">In this case, <xref:Microsoft.VisualBasic.Interaction.Environ%2A> returns all of the text, including the name of the environment variable.</span></span> <span data-ttu-id="5479a-312">如果在指定位置中没有任何环境字符串<xref:Microsoft.VisualBasic.Interaction.Environ%2A>返回长度为零的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-312">If there is no environment string in the specified position, <xref:Microsoft.VisualBasic.Interaction.Environ%2A> returns a zero-length string.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="5479a-313"><xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数需要环境的权限，这可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-313">The <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function requires environment permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-314">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>并[代码访问权限](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="5479a-314">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-315">此示例使用<xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数提供入口数目和长度的`PATH`环境字符串表中的语句。</span><span class="sxs-lookup"><span data-stu-id="5479a-315">This example uses the <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function to supply the entry number and length of the `PATH` statement from the environment-string table.</span></span>  
  
 [!code-vb[VbVbalrCatRef#28](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-316">缺少 <paramref name="Expression" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-316"><paramref name="Expression" /> is missing.</span></span></exception>
        <altmember cref="T:System.ArgumentException" />
        <related type="Article" href="~/docs/visual-basic/language-reference/runtime-library-members.md"><span data-ttu-id="5479a-317">Visual Basic 运行时库成员</span><span class="sxs-lookup"><span data-stu-id="5479a-317">Visual Basic Run-Time Library Members</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetAllSettings">
      <MemberSignature Language="C#" Value="public static string[,] GetAllSettings (string AppName, string Section);" />
      <MemberSignature Language="ILAsm" Value=".method public static string[,] GetAllSettings(string AppName, string Section) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.GetAllSettings(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetAllSettings (AppName As String, Section As String) As String(,)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^, 2&gt; ^ GetAllSettings(System::String ^ AppName, System::String ^ Section);" />
      <MemberSignature Language="F#" Value="static member GetAllSettings : string * string -&gt; string[,]" Usage="Microsoft.VisualBasic.Interaction.GetAllSettings (AppName, Section)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[,]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="AppName" Type="System.String" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Section" Type="System.String" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="AppName"><span data-ttu-id="5479a-318">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-318">Required.</span></span> <span data-ttu-id="5479a-319"><see langword="String" /> 表达式，包含请求其项设置的应用程序或项目的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-319"><see langword="String" /> expression containing the name of the application or project whose key settings are requested.</span></span></param>
        <param name="Section"><span data-ttu-id="5479a-320">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-320">Required.</span></span> <span data-ttu-id="5479a-321">一个 <see langword="String" /> 表达式，其中包含请求其关键设置的节的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-321"><see langword="String" /> expression containing the name of the section whose key settings are requested.</span></span> <span data-ttu-id="5479a-322"><see langword="GetAllSettings" /> 返回一个包含二维字符串数组的对象。</span><span class="sxs-lookup"><span data-stu-id="5479a-322"><see langword="GetAllSettings" /> returns an object that contains a two-dimensional array of strings.</span></span> <span data-ttu-id="5479a-323">这些字符串包含指定节中的所有项设置及其相应的值。</span><span class="sxs-lookup"><span data-stu-id="5479a-323">The strings contain all the key settings in the specified section, plus their corresponding values.</span></span></param>
        <summary><span data-ttu-id="5479a-324">从 Windows 注册表中某个应用程序的项返回项设置及其各自的值（最初通过 <see langword="SaveSetting" /> 创建）的列表。</span><span class="sxs-lookup"><span data-stu-id="5479a-324">Returns a list of key settings and their respective values (originally created with <see langword="SaveSetting" />) from an application's entry in the Windows registry.</span></span> <span data-ttu-id="5479a-325">与 <see langword="My" /> 相比，<see langword="GetAllSettings" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span><span class="sxs-lookup"><span data-stu-id="5479a-325">Using the <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="GetAllSettings" />.</span></span> <span data-ttu-id="5479a-326">有关详情，请参阅<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-326">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />.</span></span></summary>
        <returns><span data-ttu-id="5479a-327">Windows 注册表中某个应用程序的项中的项设置及其各自的值（最初通过 <see langword="SaveSetting" /> 创建）的列表。</span><span class="sxs-lookup"><span data-stu-id="5479a-327">A list of key settings and their respective values (originally created with <see langword="SaveSetting" />) from an application's entry in the Windows registry.</span></span>  
  
<span data-ttu-id="5479a-328">与 <see langword="My" /> 相比，<see langword="GetAllSettings" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span><span class="sxs-lookup"><span data-stu-id="5479a-328">Using the <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="GetAllSettings" />.</span></span> <span data-ttu-id="5479a-329">有关更多信息，请参见<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-329">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-330">`GetAllSettings` 返回未初始化`Object`如果任一`AppName`或`Section`不存在。</span><span class="sxs-lookup"><span data-stu-id="5479a-330">`GetAllSettings` returns an uninitialized `Object` if either `AppName` or `Section` does not exist.</span></span>  
  
 <span data-ttu-id="5479a-331">因为它将在操作`HKEY_LOCAL_USER`注册表项，该项未处于活动状态直至用户以交互方式登录，`GetAllSettings`要求用户进行登录。</span><span class="sxs-lookup"><span data-stu-id="5479a-331">Because it operates under the `HKEY_LOCAL_USER` registry key, which is not active until a user logs on interactively, `GetAllSettings` requires that a user be logged on.</span></span>  
  
 <span data-ttu-id="5479a-332">若要从非交互式进程 （如 Mtx.exe) 访问的注册表设置应存储在`HKEY_LOCAL_MACHINE\Software\`或`HKEY_USER\DEFAULT\Software`注册表项。</span><span class="sxs-lookup"><span data-stu-id="5479a-332">Registry settings that are to be accessed from a non-interactive process (such as Mtx.exe) should be stored under either the `HKEY_LOCAL_MACHINE\Software\` or the `HKEY_USER\DEFAULT\Software` registry keys.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-333">此示例首先使用`SaveSetting`函数来为指定的应用程序在 Windows 注册表中生成条目`AppName`，然后使用`GetAllSettings`函数以显示的设置。</span><span class="sxs-lookup"><span data-stu-id="5479a-333">This example first uses the `SaveSetting` function to make entries in the Windows registry for the application specified as `AppName`, then uses the `GetAllSettings` function to display the settings.</span></span> <span data-ttu-id="5479a-334">请注意该应用程序名称和`Section`名称不能使用检索`GetAllSettings`。</span><span class="sxs-lookup"><span data-stu-id="5479a-334">Note that application names and `Section` names cannot be retrieved with `GetAllSettings`.</span></span> <span data-ttu-id="5479a-335">最后，`DeleteSetting`函数会删除应用程序的条目。</span><span class="sxs-lookup"><span data-stu-id="5479a-335">Finally, the `DeleteSetting` function removes the application's entries.</span></span>  
  
 [!code-vb[VbVbalrCatRef#68](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#68)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-336">用户没有登录。</span><span class="sxs-lookup"><span data-stu-id="5479a-336">User is not logged in.</span></span></exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.DeleteSetting(System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.SaveSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="T:System.ArgumentException" />
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="5479a-337">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5479a-337">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetObject">
      <MemberSignature Language="C#" Value="public static object GetObject (string PathName = null, string Class = null);" />
      <MemberSignature Language="ILAsm" Value=".method public static object GetObject(string PathName, string Class) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.GetObject(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetObject (Optional PathName As String = null, Optional Class As String = null) As Object" />
      <MemberSignature Language="F#" Value="static member GetObject : string * string -&gt; obj" Usage="Microsoft.VisualBasic.Interaction.GetObject (PathName, Class)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="PathName" Type="System.String" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Class" Type="System.String" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="PathName"><span data-ttu-id="5479a-338">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-338">Optional.</span></span> <span data-ttu-id="5479a-339"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-339"><see langword="String" />.</span></span> <span data-ttu-id="5479a-340">包含要检索的对象的文件的完整路径和名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-340">The full path and name of the file containing the object to retrieve.</span></span> <span data-ttu-id="5479a-341">如果省略了 <paramref name="PathName" />，则 <paramref name="Class" /> 为必选。</span><span class="sxs-lookup"><span data-stu-id="5479a-341">If <paramref name="PathName" /> is omitted, <paramref name="Class" /> is required.</span></span></param>
        <param name="Class"><span data-ttu-id="5479a-342">如果未提供 <paramref name="PathName" />，则为必选。</span><span class="sxs-lookup"><span data-stu-id="5479a-342">Required if <paramref name="PathName" /> is not supplied.</span></span> <span data-ttu-id="5479a-343"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-343"><see langword="String" />.</span></span> <span data-ttu-id="5479a-344">表示对象的类的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-344">A string representing the class of the object.</span></span> <span data-ttu-id="5479a-345"><paramref name="Class" /> 参数具有以下语法和部分：</span><span class="sxs-lookup"><span data-stu-id="5479a-345">The <paramref name="Class" /> argument has the following syntax and parts:</span></span> 
 <span data-ttu-id="5479a-346"><c>appname</c><c>.</c><c>objecttype</c></span><span class="sxs-lookup"><span data-stu-id="5479a-346"><c>appname</c><c>.</c><c>objecttype</c></span></span>  
  
<span data-ttu-id="5479a-347">[1|1] 参数</span><span class="sxs-lookup"><span data-stu-id="5479a-347">[1|1] Parameter</span></span> 
<span data-ttu-id="5479a-348">[1|2]“描述”</span><span class="sxs-lookup"><span data-stu-id="5479a-348">[1|2] Description</span></span> 
<span data-ttu-id="5479a-349">[2|1] <c>appname</c></span><span class="sxs-lookup"><span data-stu-id="5479a-349">[2|1] <c>appname</c></span></span>  
  
<span data-ttu-id="5479a-350">[2|2]“所需的”。</span><span class="sxs-lookup"><span data-stu-id="5479a-350">[2|2] Required.</span></span> <span data-ttu-id="5479a-351"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-351"><see langword="String" />.</span></span> <span data-ttu-id="5479a-352">提供对象的应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-352">The name of the application providing the object.</span></span>  
  
<span data-ttu-id="5479a-353">[3|1] <c>objecttype</c></span><span class="sxs-lookup"><span data-stu-id="5479a-353">[3|1] <c>objecttype</c></span></span>  
  
<span data-ttu-id="5479a-354">[3|2]“所需的”。</span><span class="sxs-lookup"><span data-stu-id="5479a-354">[3|2] Required.</span></span> <span data-ttu-id="5479a-355"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-355"><see langword="String" />.</span></span> <span data-ttu-id="5479a-356">要创建的对象的类型或类。</span><span class="sxs-lookup"><span data-stu-id="5479a-356">The type or class of object to create.</span></span></param>
        <summary><span data-ttu-id="5479a-357">返回对 COM 组件提供的对象的引用。</span><span class="sxs-lookup"><span data-stu-id="5479a-357">Returns a reference to an object provided by a COM component.</span></span></summary>
        <returns><span data-ttu-id="5479a-358">对 COM 组件提供的对象的引用。</span><span class="sxs-lookup"><span data-stu-id="5479a-358">A reference to an object provided by a COM component.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-359">使用`GetObject`函数以从文件加载到 COM 组件的实例。</span><span class="sxs-lookup"><span data-stu-id="5479a-359">Use the `GetObject` function to load an instance of a COM component from a file.</span></span> <span data-ttu-id="5479a-360">下面的示例阐释了这一点。</span><span class="sxs-lookup"><span data-stu-id="5479a-360">The following example illustrates this.</span></span>  
  
```vb  
Dim CADObject As Object  
CADObject = GetObject("C:\CAD\schema.cad")  
```  
  
 <span data-ttu-id="5479a-361">当此代码运行时，指定关联的应用程序`PathName`启动和激活指定的文件中的对象。</span><span class="sxs-lookup"><span data-stu-id="5479a-361">When this code runs, the application associated with the specified `PathName` is started and the object in the specified file is activated.</span></span>  
  
## <a name="default-cases"></a><span data-ttu-id="5479a-362">默认情况下</span><span class="sxs-lookup"><span data-stu-id="5479a-362">Default Cases</span></span>  
 <span data-ttu-id="5479a-363">如果`PathName`是一个零长度字符串 (`""`)，`GetObject`返回指定的类类型的新对象实例。</span><span class="sxs-lookup"><span data-stu-id="5479a-363">If `PathName` is a zero-length string (`""`), `GetObject` returns a new object instance of the specified class type.</span></span> <span data-ttu-id="5479a-364">如果`PathName`省略参数，则`GetObject`返回当前处于活动状态中指定的类类型的对象`Class`。</span><span class="sxs-lookup"><span data-stu-id="5479a-364">If the `PathName` argument is omitted, `GetObject` returns a currently active object of the class type specified in `Class`.</span></span> <span data-ttu-id="5479a-365">如果不存在的对象的指定类型，就会出错。</span><span class="sxs-lookup"><span data-stu-id="5479a-365">If no object of the specified type exists, an error occurs.</span></span>  
  
## <a name="accessing-a-subobject"></a><span data-ttu-id="5479a-366">访问子对象</span><span class="sxs-lookup"><span data-stu-id="5479a-366">Accessing a Subobject</span></span>  
 <span data-ttu-id="5479a-367">某些应用程序允许您激活与文件关联的子对象。</span><span class="sxs-lookup"><span data-stu-id="5479a-367">Some applications allow you to activate a subobject associated with a file.</span></span> <span data-ttu-id="5479a-368">若要执行此操作，将添加一个感叹号 (`!`) 到末尾的文件的名称并遵循其标识文件的一部分的字符串与你想要激活。</span><span class="sxs-lookup"><span data-stu-id="5479a-368">To do this, add an exclamation point (`!`) to the end of the file name and follow it with a string that identifies the part of the file you want to activate.</span></span> <span data-ttu-id="5479a-369">有关如何创建此字符串的信息，请参阅创建对象的应用程序的文档。</span><span class="sxs-lookup"><span data-stu-id="5479a-369">For information on how to create this string, see the documentation for the application that created the object.</span></span>  
  
 <span data-ttu-id="5479a-370">例如，一个绘图应用程序中可能具有多个层在文件中存储的图形。</span><span class="sxs-lookup"><span data-stu-id="5479a-370">For example, in a drawing application you might have multiple layers to a drawing stored in a file.</span></span> <span data-ttu-id="5479a-371">可以使用以下代码以激活调用`schema.cad`。</span><span class="sxs-lookup"><span data-stu-id="5479a-371">You could use the following code to activate a layer within a drawing called `schema.cad`.</span></span>  
  
```vb  
layerObject = GetObject("C:\CAD\schema.cad!Layer3")  
```  
  
## <a name="specifying-a-class"></a><span data-ttu-id="5479a-372">指定某个类</span><span class="sxs-lookup"><span data-stu-id="5479a-372">Specifying a Class</span></span>  
 <span data-ttu-id="5479a-373">如果未指定对象的`Class`，自动化确定启动和对象的应用程序，若要激活，基于所提供的文件名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-373">If you do not specify the object's `Class`, Automation determines the application to start and the object to activate, based on the file name you provide.</span></span> <span data-ttu-id="5479a-374">但是，一些文件，可以支持多个对象的类。</span><span class="sxs-lookup"><span data-stu-id="5479a-374">Some files, however, can support more than one class of object.</span></span> <span data-ttu-id="5479a-375">例如，绘图可能支持三种不同类型的对象：`Application`对象，`Drawing`对象，和一个`Toolbar`对象，所有这些都是相同的文件的一部分。</span><span class="sxs-lookup"><span data-stu-id="5479a-375">For example, a drawing might support three different types of objects: an `Application` object, a `Drawing` object, and a `Toolbar` object, all of which are part of the same file.</span></span> <span data-ttu-id="5479a-376">若要指定想要激活的对象文件中，使用可选`Class`参数。</span><span class="sxs-lookup"><span data-stu-id="5479a-376">To specify which object in a file you want to activate, use the optional `Class` argument.</span></span> <span data-ttu-id="5479a-377">下面的示例阐释了这一点。</span><span class="sxs-lookup"><span data-stu-id="5479a-377">The following example illustrates this.</span></span>  
  
```vb  
Dim drawObj As Object  
drawObj = GetObject("C:\Drawings\sample.drw", "Figment.Drawing")  
```  
  
 <span data-ttu-id="5479a-378">在前面的示例中，`Figment`是一个绘图应用程序的名称和`Drawing`是它支持的对象类型之一。</span><span class="sxs-lookup"><span data-stu-id="5479a-378">In the preceding example, `Figment` is the name of a drawing application and `Drawing` is one of the object types it supports.</span></span>  
  
## <a name="using-the-object"></a><span data-ttu-id="5479a-379">使用对象</span><span class="sxs-lookup"><span data-stu-id="5479a-379">Using the Object</span></span>  
 <span data-ttu-id="5479a-380">一旦激活一个对象，则引用它在代码中使用对象变量声明。</span><span class="sxs-lookup"><span data-stu-id="5479a-380">Once an object is activated, you refer to it in code using the object variable you declared.</span></span> <span data-ttu-id="5479a-381">在前面的示例中，您可以访问使用对象变量的新对象的属性和方法`drawObj`。</span><span class="sxs-lookup"><span data-stu-id="5479a-381">In the preceding example, you access properties and methods of the new object using the object variable `drawObj`.</span></span> <span data-ttu-id="5479a-382">下面的示例阐释了这一点。</span><span class="sxs-lookup"><span data-stu-id="5479a-382">The following example illustrates this.</span></span>  
  
```vb  
drawObj.Line(9, 90)  
drawObj.InsertText(9, 100, "Hello, world.")  
drawObj.SaveAs("C:\Drawings\sample.drw")  
```  
  
> [!NOTE]
>  <span data-ttu-id="5479a-383">使用`GetObject`函数对象的当前实例时，或者如果你想要使用已加载的文件创建对象。</span><span class="sxs-lookup"><span data-stu-id="5479a-383">Use the `GetObject` function when there is a current instance of the object or if you want to create the object with a file loaded.</span></span> <span data-ttu-id="5479a-384">如果没有当前实例，并且您不希望开始使用的对象加载的文件，请使用<xref:Microsoft.VisualBasic.Interaction.CreateObject%2A>函数。</span><span class="sxs-lookup"><span data-stu-id="5479a-384">If there is no current instance, and you do not want the object started with a file loaded, use the <xref:Microsoft.VisualBasic.Interaction.CreateObject%2A> function.</span></span>  
>   
>  <span data-ttu-id="5479a-385">如果对象已将自己注册为 ActiveX 单实例对象，该对象的一个实例后，无论很多时候`CreateObject`调用。</span><span class="sxs-lookup"><span data-stu-id="5479a-385">If an object has registered itself as an ActiveX single-instance object, only one instance of the object is created, no matter how many times `CreateObject` is called.</span></span> <span data-ttu-id="5479a-386">与单实例对象，`GetObject`始终返回同一实例时使用长度为零的字符串调用 (`""`) 的语法，它会导致错误如果`PathName`省略参数。</span><span class="sxs-lookup"><span data-stu-id="5479a-386">With a single-instance object, `GetObject` always returns the same instance when called with the zero-length string (`""`) syntax, and it causes an error if the `PathName` argument is omitted.</span></span> <span data-ttu-id="5479a-387">不能使用`GetObject`以获取对使用 Visual Basic 创建的类的引用。</span><span class="sxs-lookup"><span data-stu-id="5479a-387">You cannot use `GetObject` to obtain a reference to a class created with Visual Basic.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="5479a-388">`GetObject`函数需要非托管的代码的权限，这可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-388">The `GetObject` function requires unmanaged code permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-389">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>并[代码访问权限](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="5479a-389">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-390">下面的示例使用`GetObject`函数获取对特定的 Microsoft Excel 工作表的引用 (`excelObj`)。</span><span class="sxs-lookup"><span data-stu-id="5479a-390">The following example uses the `GetObject` function to obtain a reference to a specific Microsoft Excel worksheet (`excelObj`).</span></span> <span data-ttu-id="5479a-391">它使用工作表的`Application`属性让 Excel 显示出来，以关闭它，并执行其他操作。</span><span class="sxs-lookup"><span data-stu-id="5479a-391">It uses the worksheet's `Application` property to make Excel visible, to close it, and to perform other actions.</span></span> <span data-ttu-id="5479a-392">使用两个 API 调用，`detectExcel`过程查找 Excel，且如果它正在运行，将进入它在运行对象表中。</span><span class="sxs-lookup"><span data-stu-id="5479a-392">Using two API calls, the `detectExcel` procedure looks for Excel, and if it is running, enters it in the Running Object table.</span></span> <span data-ttu-id="5479a-393">首次调用`GetObject`会导致错误，如果 Excel 尚未运行，在此示例会导致`excelWasNotRunning`标志设置为`True`。</span><span class="sxs-lookup"><span data-stu-id="5479a-393">The first call to `GetObject` causes an error if Excel is not already running, which in this example causes the `excelWasNotRunning` flag to be set to `True`.</span></span> <span data-ttu-id="5479a-394">第二次调用`GetObject`指定要打开的文件。</span><span class="sxs-lookup"><span data-stu-id="5479a-394">The second call to `GetObject` specifies a file to open.</span></span> <span data-ttu-id="5479a-395">如果尚未运行 Excel，第二次调用启动外接程序，并返回到指定的文件，由表示工作表的引用`test.xls`。</span><span class="sxs-lookup"><span data-stu-id="5479a-395">If Excel is not already running, the second call starts it and returns a reference to the worksheet represented by the specified file, `test.xls`.</span></span> <span data-ttu-id="5479a-396">该文件必须存在于指定位置;否则，Visual Basic 将引发<xref:System.IO.FileNotFoundException>。</span><span class="sxs-lookup"><span data-stu-id="5479a-396">The file must exist in the specified location; otherwise, Visual Basic throws a <xref:System.IO.FileNotFoundException>.</span></span> <span data-ttu-id="5479a-397">接下来，示例代码会使 Excel 和包含指定的工作表可见的窗口。</span><span class="sxs-lookup"><span data-stu-id="5479a-397">Next, the example code makes both Excel and the window containing the specified worksheet visible.</span></span>  
  
 <span data-ttu-id="5479a-398">此示例需要`Option Strict Off`因为它使用后期绑定，其中对象分配给类型的变量`Object`。</span><span class="sxs-lookup"><span data-stu-id="5479a-398">This example requires `Option Strict Off` because it uses late binding, where objects are assigned to variables of type `Object`.</span></span> <span data-ttu-id="5479a-399">您可以指定`Option Strict On`，并声明特定对象类型的对象，如果添加对从 Excel 类型库的引用**COM**选项卡**添加引用**对话框中的**项目**Visual Studio 菜单中的。</span><span class="sxs-lookup"><span data-stu-id="5479a-399">You can specify `Option Strict On` and declare objects of specific object types if you add a reference to the Excel type library from the **COM** tab of the **Add Reference** dialog box of the **Project** menu in Visual Studio.</span></span>  
  
 [!code-vb[VbVbalrExcelObject#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrExcelObject/VB/Class1.vb#2)]  
  
 [!code-vb[VbVbalrExcelObject#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrExcelObject/VB/Class1.vb#4)]  
  
 [!code-vb[VbVbalrExcelObject#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrExcelObject/VB/Class1.vb#5)]  
  
 <span data-ttu-id="5479a-400">当您调用`getExcel`函数，则进行检查以查看是否已运行 Excel。</span><span class="sxs-lookup"><span data-stu-id="5479a-400">When you call the `getExcel` function, a check is made to see if Excel is already running.</span></span> <span data-ttu-id="5479a-401">如果不是这样，被创建实例。</span><span class="sxs-lookup"><span data-stu-id="5479a-401">If it is not, then an instance is created.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="5479a-402">为简单起见，前面的示例假定任何窗口调用`XLMAIN`属于 Microsoft Excel 的实例。</span><span class="sxs-lookup"><span data-stu-id="5479a-402">For simplicity, the preceding example assumes that any window called `XLMAIN` belongs to an instance of Microsoft Excel.</span></span> <span data-ttu-id="5479a-403">如果另一个对象，可能是由非法篡改启动具有该名称创建一个窗口，它将接收适用于 Excel 的所有消息。</span><span class="sxs-lookup"><span data-stu-id="5479a-403">If another object, possibly launched by illicit tampering, created a window with that name, it would receive all the messages you intended for Excel.</span></span> <span data-ttu-id="5479a-404">在用于生产的应用程序，应包括一些更严格测试，以验证`XLMAIN`确实属于 Excel。</span><span class="sxs-lookup"><span data-stu-id="5479a-404">In an application to be used for production, you should include some more rigorous testing to verify that `XLMAIN` really belongs to Excel.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Exception"><span data-ttu-id="5479a-405">不存在指定类类型的对象。</span><span class="sxs-lookup"><span data-stu-id="5479a-405">No object of the specified class type exists.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="5479a-406">不存在具有指定路径和文件名的对象。</span><span class="sxs-lookup"><span data-stu-id="5479a-406">No object with the specified path and file name exists.</span></span></exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.CreateObject(System.String,System.String)" />
        <altmember cref="T:System.Exception" />
        <altmember cref="T:System.IO.FileNotFoundException" />
        <related type="Article" href="~/docs/visual-basic/language-reference/statements/declare-statement.md"><span data-ttu-id="5479a-407">Declare Statement</span><span class="sxs-lookup"><span data-stu-id="5479a-407">Declare Statement</span></span></related>
        <related type="Article" href="~/docs/visual-basic/language-reference/statements/option-strict-statement.md"><span data-ttu-id="5479a-408">Option Strict Statement</span><span class="sxs-lookup"><span data-stu-id="5479a-408">Option Strict Statement</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetSetting">
      <MemberSignature Language="C#" Value="public static string GetSetting (string AppName, string Section, string Key, string Default = &quot;&quot;);" />
      <MemberSignature Language="ILAsm" Value=".method public static string GetSetting(string AppName, string Section, string Key, string Default) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.GetSetting(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetSetting (AppName As String, Section As String, Key As String, Optional Default As String = &quot;&quot;) As String" />
      <MemberSignature Language="F#" Value="static member GetSetting : string * string * string * string -&gt; string" Usage="Microsoft.VisualBasic.Interaction.GetSetting (AppName, Section, Key, Default)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="AppName" Type="System.String" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Section" Type="System.String" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Key" Type="System.String" Index="2" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Default" Type="System.String" Index="3" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="AppName"><span data-ttu-id="5479a-409">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-409">Required.</span></span> <span data-ttu-id="5479a-410"><see langword="String" /> 表达式，包含请求其项设置的应用程序或项目的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-410"><see langword="String" /> expression containing the name of the application or project whose key setting is requested.</span></span></param>
        <param name="Section"><span data-ttu-id="5479a-411">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-411">Required.</span></span> <span data-ttu-id="5479a-412"><see langword="String" /> 表达式，包含在其中找到项设置的节的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-412"><see langword="String" /> expression containing the name of the section in which the key setting is found.</span></span></param>
        <param name="Key"><span data-ttu-id="5479a-413">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-413">Required.</span></span> <span data-ttu-id="5479a-414"><see langword="String" /> 表达式，包含要返回的项设置的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-414"><see langword="String" /> expression containing the name of the key setting to return.</span></span></param>
        <param name="Default"><span data-ttu-id="5479a-415">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-415">Optional.</span></span> <span data-ttu-id="5479a-416">包含要返回的值的表达式（如果没有在 <paramref name="Key" /> 设置中设置值）。</span><span class="sxs-lookup"><span data-stu-id="5479a-416">Expression containing the value to return if no value is set in the <paramref name="Key" /> setting.</span></span> <span data-ttu-id="5479a-417">如果省略，则假定 <paramref name="Default" /> 为零长度字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="5479a-417">If omitted, <paramref name="Default" /> is assumed to be a zero-length string ("").</span></span></param>
        <summary><span data-ttu-id="5479a-418">从 Windows 注册表中应用程序的项返回项设置值。</span><span class="sxs-lookup"><span data-stu-id="5479a-418">Returns a key setting value from an application's entry in the Windows registry.</span></span> <span data-ttu-id="5479a-419">与 <see langword="My" /> 相比，<see langword="GetAllSettings" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span><span class="sxs-lookup"><span data-stu-id="5479a-419">The <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="GetAllSettings" />.</span></span> <span data-ttu-id="5479a-420">有关详情，请参阅<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-420">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />.</span></span></summary>
        <returns><span data-ttu-id="5479a-421">Windows 注册表中某个应用程序的项中的项设置值。</span><span class="sxs-lookup"><span data-stu-id="5479a-421">A key setting value from an application's entry in the Windows registry.</span></span>  
  
<span data-ttu-id="5479a-422">与 <see langword="My" /> 相比，<see langword="GetAllSettings" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span><span class="sxs-lookup"><span data-stu-id="5479a-422">The <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="GetAllSettings" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-423">如果在任何一项名为`GetSetting`自变量不存在，`GetSetting`返回的值为`Default`。</span><span class="sxs-lookup"><span data-stu-id="5479a-423">If any of the items named in the `GetSetting` arguments do not exist, `GetSetting` returns a value of `Default`.</span></span>  
  
 <span data-ttu-id="5479a-424">因为它将在操作`HKEY_LOCAL_USER`注册表项，该项未处于活动状态直至用户以交互方式登录，`GetSetting`要求用户进行登录。</span><span class="sxs-lookup"><span data-stu-id="5479a-424">Because it operates under the `HKEY_LOCAL_USER` registry key, which is not active until a user logs on interactively, `GetSetting` requires that a user be logged on.</span></span>  
  
 <span data-ttu-id="5479a-425">若要从非交互式进程 （如 Mtx.exe) 访问的注册表设置应存储在`HKEY_LOCAL_MACHINE\Software\`或`HKEY_USER\DEFAULT\Software`注册表项。</span><span class="sxs-lookup"><span data-stu-id="5479a-425">Registry settings that are to be accessed from a non-interactive process (such as Mtx.exe) should be stored under either the `HKEY_LOCAL_MACHINE\Software\` or the `HKEY_USER\DEFAULT\Software` registry keys.</span></span>  
  
 <span data-ttu-id="5479a-426">`GetSetting` 需要`Read` <xref:System.Security.Permissions.RegistryPermission> 。</span><span class="sxs-lookup"><span data-stu-id="5479a-426">`GetSetting` requires `Read`<xref:System.Security.Permissions.RegistryPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-427">此示例首先使用`SaveSetting`函数来为指定的应用程序在 Windows 注册表中生成条目`AppName`，然后使用`GetSetting`函数以显示设置之一。</span><span class="sxs-lookup"><span data-stu-id="5479a-427">This example first uses the `SaveSetting` function to make entries in the Windows registry for the application specified as `AppName`, and then uses the `GetSetting` function to display one of the settings.</span></span> <span data-ttu-id="5479a-428">因为`Default`指定参数，则某些保证值返回。</span><span class="sxs-lookup"><span data-stu-id="5479a-428">Because the `Default` argument is specified, some value is guaranteed to be returned.</span></span> <span data-ttu-id="5479a-429">请注意，`Section`名称不能使用检索`GetSetting`。</span><span class="sxs-lookup"><span data-stu-id="5479a-429">Notice that `Section` names cannot be retrieved with `GetSetting`.</span></span> <span data-ttu-id="5479a-430">最后，`DeleteSetting`函数会删除应用程序的所有条目。</span><span class="sxs-lookup"><span data-stu-id="5479a-430">Finally, the `DeleteSetting` function removes all the application's entries.</span></span>  
  
 [!code-vb[VbVbalrCatRef#61](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#61)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-431">一个或多个参数不是 <see langword="String" /> 表达式，或用户没有登录。</span><span class="sxs-lookup"><span data-stu-id="5479a-431">One or more arguments are not <see langword="String" /> expressions, or user is not logged in.</span></span></exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.DeleteSetting(System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetAllSettings(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.SaveSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="T:System.ArgumentException" />
        <altmember cref="T:System.Security.Permissions.RegistryPermission" />
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="5479a-432">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5479a-432">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="IIf">
      <MemberSignature Language="C#" Value="public static object IIf (bool Expression, object TruePart, object FalsePart);" />
      <MemberSignature Language="ILAsm" Value=".method public static object IIf(bool Expression, object TruePart, object FalsePart) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.IIf(System.Boolean,System.Object,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function IIf (Expression As Boolean, TruePart As Object, FalsePart As Object) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ IIf(bool Expression, System::Object ^ TruePart, System::Object ^ FalsePart);" />
      <MemberSignature Language="F#" Value="static member IIf : bool * obj * obj -&gt; obj" Usage="Microsoft.VisualBasic.Interaction.IIf (Expression, TruePart, FalsePart)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Expression" Type="System.Boolean" />
        <Parameter Name="TruePart" Type="System.Object" />
        <Parameter Name="FalsePart" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="Expression"><span data-ttu-id="5479a-433">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-433">Required.</span></span> <span data-ttu-id="5479a-434"><see langword="Boolean" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-434"><see langword="Boolean" />.</span></span> <span data-ttu-id="5479a-435">要计算的表达式。</span><span class="sxs-lookup"><span data-stu-id="5479a-435">The expression you want to evaluate.</span></span></param>
        <param name="TruePart"><span data-ttu-id="5479a-436">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-436">Required.</span></span> <span data-ttu-id="5479a-437"><see langword="Object" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-437"><see langword="Object" />.</span></span> <span data-ttu-id="5479a-438">当 <paramref name="Expression" /> 计算结果为 <see langword="True" /> 时返回。</span><span class="sxs-lookup"><span data-stu-id="5479a-438">Returned if <paramref name="Expression" /> evaluates to <see langword="True" />.</span></span></param>
        <param name="FalsePart"><span data-ttu-id="5479a-439">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-439">Required.</span></span> <span data-ttu-id="5479a-440"><see langword="Object" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-440"><see langword="Object" />.</span></span> <span data-ttu-id="5479a-441">当 <paramref name="Expression" /> 计算结果为 <see langword="False" /> 时返回。</span><span class="sxs-lookup"><span data-stu-id="5479a-441">Returned if <paramref name="Expression" /> evaluates to <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="5479a-442">根据表达式的计算，返回两个对象中的一个。</span><span class="sxs-lookup"><span data-stu-id="5479a-442">Returns one of two objects, depending on the evaluation of an expression.</span></span></summary>
        <returns><span data-ttu-id="5479a-443">根据表达式的计算，返回两个对象中的一个。</span><span class="sxs-lookup"><span data-stu-id="5479a-443">Returns one of two objects, depending on the evaluation of an expression.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-444">`IIf`函数提供了对应的三元[条件运算符:？:](https://msdn.microsoft.com/library/88643ee8-7100-4f86-880a-705ec22b6271)视觉对象中C++。</span><span class="sxs-lookup"><span data-stu-id="5479a-444">The `IIf` function provides a counterpart for the ternary [Conditional Operator: ? :](https://msdn.microsoft.com/library/88643ee8-7100-4f86-880a-705ec22b6271) in Visual C++.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-445">此示例使用`IIf`函数来计算`testMe`参数的`checkIt`过程并返回单词"大型"if 金额大于 1000年; 否则，它返回单词"小"。</span><span class="sxs-lookup"><span data-stu-id="5479a-445">This example uses the `IIf` function to evaluate the `testMe` parameter of the `checkIt` procedure and returns the word "Large" if the amount is greater than 1000; otherwise, it returns the word "Small".</span></span>  
  
 [!code-vb[VbVbalrFunctions#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#33)]  
  
 <span data-ttu-id="5479a-446">请注意，如果`Option Strict`是`On`，则必须使用`CStr`关键字的返回值显式转换`Object`到`String`。</span><span class="sxs-lookup"><span data-stu-id="5479a-446">Note that if `Option Strict` is `On`, you must use the `CStr` keyword to explicitly convert the return from `Object` to `String`.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Choose(System.Double,System.Object[])" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Switch(System.Object[])" />
        <related type="Article" href="~/docs/visual-basic/language-reference/statements/option-strict-statement.md"><span data-ttu-id="5479a-447">Option Strict Statement</span><span class="sxs-lookup"><span data-stu-id="5479a-447">Option Strict Statement</span></span></related>
        <related type="Article" href="~/docs/visual-basic/language-reference/functions/type-conversion-functions.md"><span data-ttu-id="5479a-448">Type Conversion Functions</span><span class="sxs-lookup"><span data-stu-id="5479a-448">Type Conversion Functions</span></span></related>
        <related type="Article" href="~/docs/visual-basic/language-reference/statements/if-then-else-statement.md"><span data-ttu-id="5479a-449">If...Then...Else 语句 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5479a-449">If...Then...Else Statement (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/language-reference/statements/select-case-statement.md"><span data-ttu-id="5479a-450">Select...Case 语句 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5479a-450">Select...Case Statement (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="InputBox">
      <MemberSignature Language="C#" Value="public static string InputBox (string Prompt, string Title = &quot;&quot;, string DefaultResponse = &quot;&quot;, int XPos = -1, int YPos = -1);" />
      <MemberSignature Language="ILAsm" Value=".method public static string InputBox(string Prompt, string Title, string DefaultResponse, int32 XPos, int32 YPos) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.InputBox(System.String,System.String,System.String,System.Int32,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function InputBox (Prompt As String, Optional Title As String = &quot;&quot;, Optional DefaultResponse As String = &quot;&quot;, Optional XPos As Integer = -1, Optional YPos As Integer = -1) As String" />
      <MemberSignature Language="F#" Value="static member InputBox : string * string * string * int * int -&gt; string" Usage="Microsoft.VisualBasic.Interaction.InputBox (Prompt, Title, DefaultResponse, XPos, YPos)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Prompt" Type="System.String" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Title" Type="System.String" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="DefaultResponse" Type="System.String" Index="2" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="XPos" Type="System.Int32" Index="3" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="YPos" Type="System.Int32" Index="4" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="Prompt"><span data-ttu-id="5479a-451">必选的 <see langword="String" /> 表达式，作为消息显示在对话框中。</span><span class="sxs-lookup"><span data-stu-id="5479a-451">Required <see langword="String" /> expression displayed as the message in the dialog box.</span></span> <span data-ttu-id="5479a-452"><paramref name="Prompt" /> 的最大长度大约为 1024 个字符，具体取决于所用字符的宽度。</span><span class="sxs-lookup"><span data-stu-id="5479a-452">The maximum length of <paramref name="Prompt" /> is approximately 1024 characters, depending on the width of the characters used.</span></span> <span data-ttu-id="5479a-453">如果 <paramref name="Prompt" /> 包含多行，可以使用回车符 (<see langword="Chr(" />13<see langword=")" />) 或换行符 (<see langword="Chr(" />10<see langword=")" />)，或组合使用回车符/换行符 (<see langword="Chr(" />13<see langword=")" /> &amp; <see langword="Chr(" />10<see langword=")" />) 来分隔每行。</span><span class="sxs-lookup"><span data-stu-id="5479a-453">If <paramref name="Prompt" /> consists of more than one line, you can separate the lines using a carriage return character (<see langword="Chr(" />13<see langword=")" />), a line feed character (<see langword="Chr(" />10<see langword=")" />), or a carriage return/line feed combination (<see langword="Chr(" />13<see langword=")" /> &amp; <see langword="Chr(" />10<see langword=")" />) between each line.</span></span></param>
        <param name="Title"><span data-ttu-id="5479a-454">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-454">Optional.</span></span> <span data-ttu-id="5479a-455">显示在对话框标题栏中的 <see langword="String" /> 表达式。</span><span class="sxs-lookup"><span data-stu-id="5479a-455"><see langword="String" /> expression displayed in the title bar of the dialog box.</span></span> <span data-ttu-id="5479a-456">如果省略 <paramref name="Title" />，则标题栏中显示应用程序名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-456">If you omit <paramref name="Title" />, the application name is placed in the title bar.</span></span></param>
        <param name="DefaultResponse"><span data-ttu-id="5479a-457">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-457">Optional.</span></span> <span data-ttu-id="5479a-458"><see langword="String" /> 表达式。如果未提供其他输入，则作为默认响应显示在文本框中。</span><span class="sxs-lookup"><span data-stu-id="5479a-458"><see langword="String" /> expression displayed in the text box as the default response if no other input is provided.</span></span> <span data-ttu-id="5479a-459">如果省略 <paramref name="DefaultResponse" />，则显示的文本框为空。</span><span class="sxs-lookup"><span data-stu-id="5479a-459">If you omit <paramref name="DefaultResponse" />, the displayed text box is empty.</span></span></param>
        <param name="XPos"><span data-ttu-id="5479a-460">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-460">Optional.</span></span> <span data-ttu-id="5479a-461">数值表达式，指定屏幕左边缘与对话框左边缘之间的距离（以缇为单位）。</span><span class="sxs-lookup"><span data-stu-id="5479a-461">Numeric expression that specifies, in twips, the distance of the left edge of the dialog box from the left edge of the screen.</span></span> <span data-ttu-id="5479a-462">如果省略 <paramref name="XPos" />，则对话框水平居中。</span><span class="sxs-lookup"><span data-stu-id="5479a-462">If you omit <paramref name="XPos" />, the dialog box is centered horizontally.</span></span></param>
        <param name="YPos"><span data-ttu-id="5479a-463">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-463">Optional.</span></span> <span data-ttu-id="5479a-464">数值表达式，指定屏幕顶部与对话框上边缘之间的距离（以缇为单位）。</span><span class="sxs-lookup"><span data-stu-id="5479a-464">Numeric expression that specifies, in twips, the distance of the upper edge of the dialog box from the top of the screen.</span></span> <span data-ttu-id="5479a-465">如果省略 <paramref name="YPos" />，则对话框垂直定位在屏幕向下大约三分之一处。</span><span class="sxs-lookup"><span data-stu-id="5479a-465">If you omit <paramref name="YPos" />, the dialog box is positioned vertically approximately one-third of the way down the screen.</span></span></param>
        <summary><span data-ttu-id="5479a-466">在对话框中显示提示，等待用户输入文本或单击按钮，然后返回包含文本框内容的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-466">Displays a prompt in a dialog box, waits for the user to input text or click a button, and then returns a string containing the contents of the text box.</span></span></summary>
        <returns><span data-ttu-id="5479a-467">在对话框中显示提示，等待用户输入文本或单击按钮，然后返回包含文本框内容的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-467">Displays a prompt in a dialog box, waits for the user to input text or click a button, and then returns a string containing the contents of the text box.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-468">如果用户单击**取消**，则返回长度为零的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-468">If the user clicks **Cancel**, a zero-length string is returned.</span></span>  
  
 <span data-ttu-id="5479a-469">若要指定多个第一个参数，必须使用`InputBox`在表达式中的函数。</span><span class="sxs-lookup"><span data-stu-id="5479a-469">To specify more than the first argument, you must use the `InputBox` function in an expression.</span></span> <span data-ttu-id="5479a-470">如果省略任何位置实参，你必须保留相应的逗号分隔符。</span><span class="sxs-lookup"><span data-stu-id="5479a-470">If you omit any positional arguments, you must retain the corresponding comma delimiter.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5479a-471">`InputBox`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-471">The `InputBox` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-472">有关详细信息，请参阅[请求权限](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/yd267cce(v%3dvs.100))和<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="5479a-472">For more information, see [Requesting Permissions](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/yd267cce(v%3dvs.100)) and <xref:System.Security.Permissions.UIPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-473">此示例演示各种方法来使用`InputBox`函数来提示用户输入的值。</span><span class="sxs-lookup"><span data-stu-id="5479a-473">This example shows various ways to use the `InputBox` function to prompt the user to enter a value.</span></span> <span data-ttu-id="5479a-474">如果 x 和 y 位置省略、 各自的轴自动居中显示对话框。</span><span class="sxs-lookup"><span data-stu-id="5479a-474">If the x and y positions are omitted, the dialog box is automatically centered for the respective axes.</span></span> <span data-ttu-id="5479a-475">该变量`MyValue`包含由用户输入，如果用户单击确定或按 ENTER 键的值。</span><span class="sxs-lookup"><span data-stu-id="5479a-475">The variable `MyValue` contains the value entered by the user if the user clicks OK or presses the ENTER key.</span></span>  
  
 [!code-vb[VbVbalrCatRef#67](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#67)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.MsgBox(System.Object,Microsoft.VisualBasic.MsgBoxStyle,System.Object)" />
        <altmember cref="M:Microsoft.VisualBasic.Strings.Chr(System.Int32)" />
        <altmember cref="M:Microsoft.VisualBasic.Strings.ChrW(System.Int32)" />
      </Docs>
    </Member>
    <Member MemberName="MsgBox">
      <MemberSignature Language="C#" Value="public static Microsoft.VisualBasic.MsgBoxResult MsgBox (object Prompt, Microsoft.VisualBasic.MsgBoxStyle Buttons = Microsoft.VisualBasic.MsgBoxStyle.ApplicationModal, object Title = null);" />
      <MemberSignature Language="ILAsm" Value=".method public static valuetype Microsoft.VisualBasic.MsgBoxResult MsgBox(object Prompt, valuetype Microsoft.VisualBasic.MsgBoxStyle Buttons, object Title) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.MsgBox(System.Object,Microsoft.VisualBasic.MsgBoxStyle,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function MsgBox (Prompt As Object, Optional Buttons As MsgBoxStyle = Microsoft.VisualBasic.MsgBoxStyle.ApplicationModal, Optional Title As Object = null) As MsgBoxResult" />
      <MemberSignature Language="F#" Value="static member MsgBox : obj * Microsoft.VisualBasic.MsgBoxStyle * obj -&gt; Microsoft.VisualBasic.MsgBoxResult" Usage="Microsoft.VisualBasic.Interaction.MsgBox (Prompt, Buttons, Title)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.MsgBoxResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Prompt" Type="System.Object" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Buttons" Type="Microsoft.VisualBasic.MsgBoxStyle" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Title" Type="System.Object" Index="2" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="Prompt"><span data-ttu-id="5479a-476">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-476">Required.</span></span> <span data-ttu-id="5479a-477">作为消息显示在对话框中的 <see langword="String" /> 表达式。</span><span class="sxs-lookup"><span data-stu-id="5479a-477"><see langword="String" /> expression displayed as the message in the dialog box.</span></span> <span data-ttu-id="5479a-478"><paramref name="Prompt" /> 的最大长度大约为 1024 个字符，具体取决于所用字符的宽度。</span><span class="sxs-lookup"><span data-stu-id="5479a-478">The maximum length of <paramref name="Prompt" /> is approximately 1024 characters, depending on the width of the characters used.</span></span> <span data-ttu-id="5479a-479">如果 <paramref name="Prompt" /> 包含多行，可以使用回车符 (<see langword="Chr(" />13<see langword=")" />) 或换行符 (<see langword="Chr(" />10<see langword=")" />)，或组合使用回车符/换行符 (<see langword="Chr(" />13<see langword=")" /> &amp; <see langword="Chr(" />10<see langword=")" />) 来分隔每行。</span><span class="sxs-lookup"><span data-stu-id="5479a-479">If <paramref name="Prompt" /> consists of more than one line, you can separate the lines using a carriage return character (<see langword="Chr(" />13<see langword=")" />), a line feed character (<see langword="Chr(" />10<see langword=")" />), or a carriage return/linefeed character combination (<see langword="Chr(" />13<see langword=")" /> &amp; <see langword="Chr(" />10<see langword=")" />) between each line.</span></span></param>
        <param name="Buttons"><span data-ttu-id="5479a-480">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-480">Optional.</span></span> <span data-ttu-id="5479a-481">数值表达式，它是值的总和，指定显示的按钮数目及按钮类型，使用的图标样式，默认按钮的标识以及消息框的样式等。</span><span class="sxs-lookup"><span data-stu-id="5479a-481">Numeric expression that is the sum of values specifying the number and type of buttons to display, the icon style to use, the identity of the default button, and the modality of the message box.</span></span> <span data-ttu-id="5479a-482">如果省略 <paramref name="Buttons" />，则默认值为 0。</span><span class="sxs-lookup"><span data-stu-id="5479a-482">If you omit <paramref name="Buttons" />, the default value is zero.</span></span></param>
        <param name="Title"><span data-ttu-id="5479a-483">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-483">Optional.</span></span> <span data-ttu-id="5479a-484">显示在对话框标题栏中的 <see langword="String" /> 表达式。</span><span class="sxs-lookup"><span data-stu-id="5479a-484"><see langword="String" /> expression displayed in the title bar of the dialog box.</span></span> <span data-ttu-id="5479a-485">如果省略 <paramref name="Title" />，则标题栏中显示应用程序名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-485">If you omit <paramref name="Title" />, the application name is placed in the title bar.</span></span></param>
        <summary><span data-ttu-id="5479a-486">在对话框中显示消息，等待用户单击按钮，然后返回一个整数，该整数指示用户单击的按钮。</span><span class="sxs-lookup"><span data-stu-id="5479a-486">Displays a message in a dialog box, waits for the user to click a button, and then returns an integer indicating which button the user clicked.</span></span></summary>
        <returns><list type="table">
            <item>
              <term> <span data-ttu-id="5479a-487">返回的常量</span><span class="sxs-lookup"><span data-stu-id="5479a-487">Constant</span></span> 
 </term>
              <description> <span data-ttu-id="5479a-488">值</span><span class="sxs-lookup"><span data-stu-id="5479a-488">Value</span></span> 
 </description>
            </item>
            <item>
              <term>
                <see langword="OK" />
              </term>
              <description> <span data-ttu-id="5479a-489">1</span><span class="sxs-lookup"><span data-stu-id="5479a-489">1</span></span> 
 </description>
            </item>
            <item>
              <term>
                <see langword="Cancel" />
              </term>
              <description> <span data-ttu-id="5479a-490">2</span><span class="sxs-lookup"><span data-stu-id="5479a-490">2</span></span> 
 </description>
            </item>
            <item>
              <term>
                <see langword="Abort" />
              </term>
              <description> <span data-ttu-id="5479a-491">3</span><span class="sxs-lookup"><span data-stu-id="5479a-491">3</span></span> 
 </description>
            </item>
            <item>
              <term>
                <see langword="Retry" />
              </term>
              <description> <span data-ttu-id="5479a-492">4</span><span class="sxs-lookup"><span data-stu-id="5479a-492">4</span></span> 
 </description>
            </item>
            <item>
              <term>
                <see langword="Ignore" />
              </term>
              <description> <span data-ttu-id="5479a-493">5</span><span class="sxs-lookup"><span data-stu-id="5479a-493">5</span></span> 
 </description>
            </item>
            <item>
              <term>
                <see langword="Yes" />
              </term>
              <description> <span data-ttu-id="5479a-494">6</span><span class="sxs-lookup"><span data-stu-id="5479a-494">6</span></span> 
 </description>
            </item>
            <item>
              <term>
                <see langword="No" />
              </term>
              <description> <span data-ttu-id="5479a-495">7</span><span class="sxs-lookup"><span data-stu-id="5479a-495">7</span></span> 
 </description>
            </item>
          </list></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-496">如果省略任何位置实参，你必须保留相应的逗号分隔符。</span><span class="sxs-lookup"><span data-stu-id="5479a-496">If you omit any positional arguments, you must retain the corresponding comma delimiter.</span></span>  
  
 <span data-ttu-id="5479a-497">如果对话框显示**取消**按钮，则按 ESC 键具有相同的效果与单击**取消**</span><span class="sxs-lookup"><span data-stu-id="5479a-497">If the dialog box displays a **Cancel** button, pressing the ESC key has the same effect as clicking **Cancel**</span></span>  
  
 <span data-ttu-id="5479a-498">如果对话框包含**帮助**按钮，为对话框提供上下文相关帮助。</span><span class="sxs-lookup"><span data-stu-id="5479a-498">If the dialog box contains a **Help** button, context-sensitive Help is provided for the dialog box.</span></span> <span data-ttu-id="5479a-499">但是，在关闭其他任一按钮前，不会返回任何值。</span><span class="sxs-lookup"><span data-stu-id="5479a-499">However, no value is returned until one of the other buttons is chosen.</span></span> <span data-ttu-id="5479a-500">在 Windows 窗体应用程序中，选择**帮助**按钮执行<xref:System.Windows.Forms.Control.HelpRequested>窗体的事件。</span><span class="sxs-lookup"><span data-stu-id="5479a-500">In Windows Form applications, choosing the **Help** button executes the <xref:System.Windows.Forms.Control.HelpRequested> event for the form.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5479a-501">`MsgBox`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-501">The `MsgBox` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-502">有关更多信息，请参见<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="5479a-502">For more information, see <xref:System.Security.Permissions.UIPermission>.</span></span>  
  
 <span data-ttu-id="5479a-503">`MsgBoxStyle`下表列出了枚举值。</span><span class="sxs-lookup"><span data-stu-id="5479a-503">The `MsgBoxStyle` enumeration values are listed in the following table.</span></span>  
  
|<span data-ttu-id="5479a-504">成员</span><span class="sxs-lookup"><span data-stu-id="5479a-504">Member</span></span>|<span data-ttu-id="5479a-505">值</span><span class="sxs-lookup"><span data-stu-id="5479a-505">Value</span></span>|<span data-ttu-id="5479a-506">描述</span><span class="sxs-lookup"><span data-stu-id="5479a-506">Description</span></span>|  
|-|-|-|  
|<span data-ttu-id="5479a-507">成员</span><span class="sxs-lookup"><span data-stu-id="5479a-507">Member</span></span>|<span data-ttu-id="5479a-508">值</span><span class="sxs-lookup"><span data-stu-id="5479a-508">Value</span></span>|<span data-ttu-id="5479a-509">描述</span><span class="sxs-lookup"><span data-stu-id="5479a-509">Description</span></span>|  
|`OKOnly`|<span data-ttu-id="5479a-510">0</span><span class="sxs-lookup"><span data-stu-id="5479a-510">0</span></span>|<span data-ttu-id="5479a-511">仅显示确定按钮。</span><span class="sxs-lookup"><span data-stu-id="5479a-511">Displays OK button only.</span></span>|  
|`OKCancel`|<span data-ttu-id="5479a-512">1</span><span class="sxs-lookup"><span data-stu-id="5479a-512">1</span></span>|<span data-ttu-id="5479a-513">显示确定和取消按钮。</span><span class="sxs-lookup"><span data-stu-id="5479a-513">Displays OK and Cancel buttons.</span></span>|  
|`AbortRetryIgnore`|<span data-ttu-id="5479a-514">2</span><span class="sxs-lookup"><span data-stu-id="5479a-514">2</span></span>|<span data-ttu-id="5479a-515">显示中止、 重试，和忽略按钮。</span><span class="sxs-lookup"><span data-stu-id="5479a-515">Displays Abort, Retry, and Ignore buttons.</span></span>|  
|`YesNoCancel`|<span data-ttu-id="5479a-516">3</span><span class="sxs-lookup"><span data-stu-id="5479a-516">3</span></span>|<span data-ttu-id="5479a-517">显示是、 否和取消按钮。</span><span class="sxs-lookup"><span data-stu-id="5479a-517">Displays Yes, No, and Cancel buttons.</span></span>|  
|`YesNo`|<span data-ttu-id="5479a-518">4</span><span class="sxs-lookup"><span data-stu-id="5479a-518">4</span></span>|<span data-ttu-id="5479a-519">显示是和无按钮。</span><span class="sxs-lookup"><span data-stu-id="5479a-519">Displays Yes and No buttons.</span></span>|  
|`RetryCancel`|<span data-ttu-id="5479a-520">5</span><span class="sxs-lookup"><span data-stu-id="5479a-520">5</span></span>|<span data-ttu-id="5479a-521">显示重试和取消按钮。</span><span class="sxs-lookup"><span data-stu-id="5479a-521">Displays Retry and Cancel buttons.</span></span>|  
|`Critical`|<span data-ttu-id="5479a-522">16</span><span class="sxs-lookup"><span data-stu-id="5479a-522">16</span></span>|<span data-ttu-id="5479a-523">显示关键消息图标。</span><span class="sxs-lookup"><span data-stu-id="5479a-523">Displays Critical Message icon.</span></span>|  
|`Question`|<span data-ttu-id="5479a-524">32</span><span class="sxs-lookup"><span data-stu-id="5479a-524">32</span></span>|<span data-ttu-id="5479a-525">显示警告查询图标。</span><span class="sxs-lookup"><span data-stu-id="5479a-525">Displays Warning Query icon.</span></span>|  
|`Exclamation`|<span data-ttu-id="5479a-526">48</span><span class="sxs-lookup"><span data-stu-id="5479a-526">48</span></span>|<span data-ttu-id="5479a-527">显示警告消息图标。</span><span class="sxs-lookup"><span data-stu-id="5479a-527">Displays Warning Message icon.</span></span>|  
|`Information`|<span data-ttu-id="5479a-528">64</span><span class="sxs-lookup"><span data-stu-id="5479a-528">64</span></span>|<span data-ttu-id="5479a-529">显示信息性消息图标。</span><span class="sxs-lookup"><span data-stu-id="5479a-529">Displays Information Message icon.</span></span>|  
|`DefaultButton1`|<span data-ttu-id="5479a-530">0</span><span class="sxs-lookup"><span data-stu-id="5479a-530">0</span></span>|<span data-ttu-id="5479a-531">第一个按钮是默认值。</span><span class="sxs-lookup"><span data-stu-id="5479a-531">First button is default.</span></span>|  
|`DefaultButton2`|<span data-ttu-id="5479a-532">256</span><span class="sxs-lookup"><span data-stu-id="5479a-532">256</span></span>|<span data-ttu-id="5479a-533">第二个按钮是默认值。</span><span class="sxs-lookup"><span data-stu-id="5479a-533">Second button is default.</span></span>|  
|`DefaultButton3`|<span data-ttu-id="5479a-534">512</span><span class="sxs-lookup"><span data-stu-id="5479a-534">512</span></span>|<span data-ttu-id="5479a-535">第三个按钮是默认值。</span><span class="sxs-lookup"><span data-stu-id="5479a-535">Third button is default.</span></span>|  
|`ApplicationModal`|<span data-ttu-id="5479a-536">0</span><span class="sxs-lookup"><span data-stu-id="5479a-536">0</span></span>|<span data-ttu-id="5479a-537">应用程序是模式化。</span><span class="sxs-lookup"><span data-stu-id="5479a-537">Application is modal.</span></span> <span data-ttu-id="5479a-538">用户必须响应消息框，才能继续在当前应用程序中工作。</span><span class="sxs-lookup"><span data-stu-id="5479a-538">The user must respond to the message box before continuing work in the current application.</span></span>|  
|`SystemModal`|<span data-ttu-id="5479a-539">4096</span><span class="sxs-lookup"><span data-stu-id="5479a-539">4096</span></span>|<span data-ttu-id="5479a-540">系统为模式。</span><span class="sxs-lookup"><span data-stu-id="5479a-540">System is modal.</span></span> <span data-ttu-id="5479a-541">所有应用程序挂起，直到用户响应消息框。</span><span class="sxs-lookup"><span data-stu-id="5479a-541">All applications are suspended until the user responds to the message box.</span></span>|  
|`MsgBoxSetForeground`|<span data-ttu-id="5479a-542">65536</span><span class="sxs-lookup"><span data-stu-id="5479a-542">65536</span></span>|<span data-ttu-id="5479a-543">指定消息框窗口作为前台窗口。</span><span class="sxs-lookup"><span data-stu-id="5479a-543">Specifies the message box window as the foreground window.</span></span>|  
|`MsgBoxRight`|<span data-ttu-id="5479a-544">524288</span><span class="sxs-lookup"><span data-stu-id="5479a-544">524288</span></span>|<span data-ttu-id="5479a-545">文本是右对齐。</span><span class="sxs-lookup"><span data-stu-id="5479a-545">Text is right-aligned.</span></span>|  
|`MsgBoxRtlReading`|<span data-ttu-id="5479a-546">1048576</span><span class="sxs-lookup"><span data-stu-id="5479a-546">1048576</span></span>|<span data-ttu-id="5479a-547">指定文本应显示为右到左读取希伯来语和阿拉伯语系统上。</span><span class="sxs-lookup"><span data-stu-id="5479a-547">Specifies text should appear as right-to-left reading on Hebrew and Arabic systems.</span></span>|  
  
 <span data-ttu-id="5479a-548">第一组值 (0-5) 描述的数量和类型显示在对话框中的按钮。</span><span class="sxs-lookup"><span data-stu-id="5479a-548">The first group of values (0-5) describes the number and type of buttons displayed in the dialog box.</span></span> <span data-ttu-id="5479a-549">第二个组 （16、 32、 48、 64） 描述图标样式。</span><span class="sxs-lookup"><span data-stu-id="5479a-549">The second group (16, 32, 48, 64) describes the icon style.</span></span> <span data-ttu-id="5479a-550">第三个组 （0、 256、 512） 确定哪个按钮是默认值。</span><span class="sxs-lookup"><span data-stu-id="5479a-550">The third group (0, 256, 512) determines which button is the default.</span></span> <span data-ttu-id="5479a-551">第四个组 （0，4096） 确定的消息框中，模式和第五个组指定消息框窗口是前台窗口，以及对齐和中文本的方向。</span><span class="sxs-lookup"><span data-stu-id="5479a-551">The fourth group (0, 4096) determines the modality of the message box, and the fifth group specifies whether or not the message box window is the foreground window, along with the alignment and direction of the text.</span></span> <span data-ttu-id="5479a-552">当添加数字以创建为一个最终值`Buttons`参数，使用每个组中只有一个数字。</span><span class="sxs-lookup"><span data-stu-id="5479a-552">When adding numbers to create a final value for the `Buttons` argument, use only one number from each group.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-553">此示例使用`MsgBox`函数具有是和无按钮的对话框中显示的严重错误消息。</span><span class="sxs-lookup"><span data-stu-id="5479a-553">This example uses the `MsgBox` function to display a critical-error message in a dialog box with Yes and No buttons.</span></span> <span data-ttu-id="5479a-554">否按钮指定为默认响应。</span><span class="sxs-lookup"><span data-stu-id="5479a-554">The No button is specified as the default response.</span></span> <span data-ttu-id="5479a-555">这是通过组合`MsgBox`到一个数值表达式的常量值。</span><span class="sxs-lookup"><span data-stu-id="5479a-555">This is done by combining the `MsgBox` constant values into one numeric expression.</span></span> <span data-ttu-id="5479a-556">在这种情况下，加上 4 (是/否按钮组合) 和 16 (**关键消息**窗口) 和 256 （作为默认按钮的第二个按钮） 得到的 276 总计。</span><span class="sxs-lookup"><span data-stu-id="5479a-556">In this case, adding 4 (the Yes/No button combination) and 16 (the **Critical Message** window) and 256 (the second button as default button) gives a total of 276.</span></span> <span data-ttu-id="5479a-557">返回的值`MsgBox`函数取决于用户选择的按钮：是返回的值为 6;没有返回一个值为 7。</span><span class="sxs-lookup"><span data-stu-id="5479a-557">The value returned by the `MsgBox` function depends on the button chosen by the user: Yes returns a value of 6; No returns a value of 7.</span></span>  
  
 [!code-vb[VbVbalrCatRef#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-558"><paramref name="Prompt" /> 不是一个 <see langword="String" /> 表达式，或者 <paramref name="Title" /> 无效。</span><span class="sxs-lookup"><span data-stu-id="5479a-558"><paramref name="Prompt" /> is not a <see langword="String" /> expression, or <paramref name="Title" /> is invalid.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="5479a-559">进程不是以 User Interactive 模式运行。</span><span class="sxs-lookup"><span data-stu-id="5479a-559">Process is not running in User Interactive mode.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="5479a-560">一个或多个参数，而不是 <see langword="MsgBoxResult" /> 或 <see langword="MsgBoxStyle" /> 枚举的成员。</span><span class="sxs-lookup"><span data-stu-id="5479a-560">One or more parameters not a member of <see langword="MsgBoxResult" /> or <see langword="MsgBoxStyle" /> enumeration.</span></span></exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.InputBox(System.String,System.String,System.String,System.Int32,System.Int32)" />
        <altmember cref="M:System.Windows.Forms.MessageBox.Show(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="Partition">
      <MemberSignature Language="C#" Value="public static string Partition (long Number, long Start, long Stop, long Interval);" />
      <MemberSignature Language="ILAsm" Value=".method public static string Partition(int64 Number, int64 Start, int64 Stop, int64 Interval) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Partition(System.Int64,System.Int64,System.Int64,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function Partition (Number As Long, Start As Long, Stop As Long, Interval As Long) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Partition(long Number, long Start, long Stop, long Interval);" />
      <MemberSignature Language="F#" Value="static member Partition : int64 * int64 * int64 * int64 -&gt; string" Usage="Microsoft.VisualBasic.Interaction.Partition (Number, Start, Stop, Interval)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Number" Type="System.Int64" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Start" Type="System.Int64" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Stop" Type="System.Int64" Index="2" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Interval" Type="System.Int64" Index="3" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="Number"><span data-ttu-id="5479a-561">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-561">Required.</span></span> <span data-ttu-id="5479a-562"><see langword="Long" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-562"><see langword="Long" />.</span></span> <span data-ttu-id="5479a-563">要在一个计算范围中找到的整数。</span><span class="sxs-lookup"><span data-stu-id="5479a-563">Whole number that you want to locate within one of the calculated ranges.</span></span></param>
        <param name="Start"><span data-ttu-id="5479a-564">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-564">Required.</span></span> <span data-ttu-id="5479a-565"><see langword="Long" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-565"><see langword="Long" />.</span></span> <span data-ttu-id="5479a-566">一个整数，指示计算出的范围集的开始值。</span><span class="sxs-lookup"><span data-stu-id="5479a-566">Whole number that indicates the start of the set of calculated ranges.</span></span> <span data-ttu-id="5479a-567"><paramref name="Start" /> 不能小于 0。</span><span class="sxs-lookup"><span data-stu-id="5479a-567"><paramref name="Start" /> cannot be less than 0.</span></span></param>
        <param name="Stop"><span data-ttu-id="5479a-568">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-568">Required.</span></span> <span data-ttu-id="5479a-569"><see langword="Long" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-569"><see langword="Long" />.</span></span> <span data-ttu-id="5479a-570">一个整数，指示计算出的范围集的结束值。</span><span class="sxs-lookup"><span data-stu-id="5479a-570">Whole number that indicates the end of the set of calculated ranges.</span></span> <span data-ttu-id="5479a-571"><paramref name="Stop" /> 不能小于或等于 <paramref name="Start" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-571"><paramref name="Stop" /> cannot be less than or equal to <paramref name="Start" />.</span></span></param>
        <param name="Interval"><span data-ttu-id="5479a-572">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-572">Required.</span></span> <span data-ttu-id="5479a-573"><see langword="Long" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-573"><see langword="Long" />.</span></span> <span data-ttu-id="5479a-574">一个整数，指示在 <paramref name="Start" /> 和 <paramref name="Stop" /> 之间计算的每个范围大小。</span><span class="sxs-lookup"><span data-stu-id="5479a-574">Whole number that indicates the size of each range calculated between <paramref name="Start" /> and <paramref name="Stop" />.</span></span> <span data-ttu-id="5479a-575"><paramref name="Interval" /> 不能小于 1。</span><span class="sxs-lookup"><span data-stu-id="5479a-575"><paramref name="Interval" /> cannot be less than 1.</span></span></param>
        <summary><span data-ttu-id="5479a-576">返回一个字符串，该字符串表示包含某个数字的计算范围。</span><span class="sxs-lookup"><span data-stu-id="5479a-576">Returns a string representing the calculated range that contains a number.</span></span></summary>
        <returns><span data-ttu-id="5479a-577">一个字符串，该字符串表示包含某个数字的计算范围。</span><span class="sxs-lookup"><span data-stu-id="5479a-577">A string representing the calculated range that contains a number.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-578">`Partition`函数计算的一组数值范围，每个都包含由指定的值的数目`Interval`。</span><span class="sxs-lookup"><span data-stu-id="5479a-578">The `Partition` function calculates a set of numeric ranges, each containing the number of values specified by `Interval`.</span></span> <span data-ttu-id="5479a-579">第一个范围开始处`Start`，并最后一个范围结束于`Stop`。</span><span class="sxs-lookup"><span data-stu-id="5479a-579">The first range begins at `Start`, and the last range ends at `Stop`.</span></span> <span data-ttu-id="5479a-580">`Partition`函数然后确定哪一个范围包含`Number`，并返回一个描述该范围内的字符串。</span><span class="sxs-lookup"><span data-stu-id="5479a-580">The `Partition` function then identifies which range contains `Number` and returns a string describing that range.</span></span> <span data-ttu-id="5479a-581">范围表示为字符串中"*较*:*值*"，其中范围的低端 (*较*) 分开的高端 (*值*) 一个冒号 （:）。</span><span class="sxs-lookup"><span data-stu-id="5479a-581">The range is represented in the string as "*lowervalue*:*uppervalue*", where the low end of the range (*lowervalue*) is separated from the high end (*uppervalue*) by a colon (:).</span></span>  
  
 <span data-ttu-id="5479a-582">如果有必要，请`Partition`函数将插入前的前导空格*较*并*值*，以便它们都具有相同数量的字符的值 （以字符串表示形式`Stop` + 1)。</span><span class="sxs-lookup"><span data-stu-id="5479a-582">If necessary, the `Partition` function inserts leading spaces before *lowervalue* and *uppervalue* so that they both have the same number of characters as the string representation of the value (`Stop` + 1).</span></span> <span data-ttu-id="5479a-583">这可确保，如果使用的输出`Partition`函数中的多个值`Number`，生成的文本都可以正确处理任何后续排序操作过程。</span><span class="sxs-lookup"><span data-stu-id="5479a-583">This ensures that if you use the output of the `Partition` function with several values of `Number`, the resulting text will be handled properly during any subsequent sort operation.</span></span>  
  
 <span data-ttu-id="5479a-584">下表显示了使用三组计算的范围某些示例字符串`Start`， `Stop`，和`Interval`。</span><span class="sxs-lookup"><span data-stu-id="5479a-584">The following table shows some sample strings for ranges calculated using three sets of `Start`, `Stop`, and `Interval`.</span></span> <span data-ttu-id="5479a-585">"第一个范围"和"最后一个范围"列显示在给定的值时可能的最低和最高范围`Start`和`Stop`。</span><span class="sxs-lookup"><span data-stu-id="5479a-585">The "First range" and "Last range" columns show the lowest and highest ranges possible given the values of `Start` and `Stop`.</span></span> <span data-ttu-id="5479a-586">"之前第一个范围"和"之后，最后一个范围"列显示返回的值的字符串`Number`少于`Start`且大于`Stop`分别。</span><span class="sxs-lookup"><span data-stu-id="5479a-586">The "Before first range" and "After last range" columns show the strings returned for values of `Number` less than `Start` and greater than `Stop`, respectively.</span></span>  
  
|`Start`|`Stop`|`Interval`|<span data-ttu-id="5479a-587">第一个范围之前</span><span class="sxs-lookup"><span data-stu-id="5479a-587">Before first range</span></span>|<span data-ttu-id="5479a-588">第一个范围</span><span class="sxs-lookup"><span data-stu-id="5479a-588">First range</span></span>|<span data-ttu-id="5479a-589">最后一个范围</span><span class="sxs-lookup"><span data-stu-id="5479a-589">Last range</span></span>|<span data-ttu-id="5479a-590">最后一个范围之后</span><span class="sxs-lookup"><span data-stu-id="5479a-590">After last range</span></span>|  
|-|-|-|-|-|-|-|  
|<span data-ttu-id="5479a-591">0</span><span class="sxs-lookup"><span data-stu-id="5479a-591">0</span></span>|<span data-ttu-id="5479a-592">99</span><span class="sxs-lookup"><span data-stu-id="5479a-592">99</span></span>|<span data-ttu-id="5479a-593">5</span><span class="sxs-lookup"><span data-stu-id="5479a-593">5</span></span>|<span data-ttu-id="5479a-594">"   : -1"</span><span class="sxs-lookup"><span data-stu-id="5479a-594">"   : -1"</span></span>|<span data-ttu-id="5479a-595">"  0:4"</span><span class="sxs-lookup"><span data-stu-id="5479a-595">"  0:  4"</span></span>|<span data-ttu-id="5479a-596">" 95:99"</span><span class="sxs-lookup"><span data-stu-id="5479a-596">" 95: 99"</span></span>|<span data-ttu-id="5479a-597">"100:   "</span><span class="sxs-lookup"><span data-stu-id="5479a-597">"100:   "</span></span>|  
|<span data-ttu-id="5479a-598">20</span><span class="sxs-lookup"><span data-stu-id="5479a-598">20</span></span>|<span data-ttu-id="5479a-599">199</span><span class="sxs-lookup"><span data-stu-id="5479a-599">199</span></span>|<span data-ttu-id="5479a-600">10</span><span class="sxs-lookup"><span data-stu-id="5479a-600">10</span></span>|<span data-ttu-id="5479a-601">"   :19"</span><span class="sxs-lookup"><span data-stu-id="5479a-601">"   : 19"</span></span>|<span data-ttu-id="5479a-602">" 20:29"</span><span class="sxs-lookup"><span data-stu-id="5479a-602">" 20: 29"</span></span>|<span data-ttu-id="5479a-603">"190:199"</span><span class="sxs-lookup"><span data-stu-id="5479a-603">"190:199"</span></span>|<span data-ttu-id="5479a-604">"200:   "</span><span class="sxs-lookup"><span data-stu-id="5479a-604">"200:   "</span></span>|  
|<span data-ttu-id="5479a-605">100</span><span class="sxs-lookup"><span data-stu-id="5479a-605">100</span></span>|<span data-ttu-id="5479a-606">1010</span><span class="sxs-lookup"><span data-stu-id="5479a-606">1010</span></span>|<span data-ttu-id="5479a-607">20</span><span class="sxs-lookup"><span data-stu-id="5479a-607">20</span></span>|<span data-ttu-id="5479a-608">"    :99"</span><span class="sxs-lookup"><span data-stu-id="5479a-608">"    : 99"</span></span>|<span data-ttu-id="5479a-609">" 100:119"</span><span class="sxs-lookup"><span data-stu-id="5479a-609">" 100: 119"</span></span>|<span data-ttu-id="5479a-610">"1000:1010"</span><span class="sxs-lookup"><span data-stu-id="5479a-610">"1000:1010"</span></span>|<span data-ttu-id="5479a-611">"1011:    "</span><span class="sxs-lookup"><span data-stu-id="5479a-611">"1011:    "</span></span>|  
  
 <span data-ttu-id="5479a-612">在上表中，第三行显示结果时`Start`并`Stop`定义一组不能通过平均划分的数字`Interval`。</span><span class="sxs-lookup"><span data-stu-id="5479a-612">In the preceding table, the third line shows the result when `Start` and `Stop` define a set of numbers that cannot be evenly divided by `Interval`.</span></span> <span data-ttu-id="5479a-613">最后一个范围结束于`Stop`，使其仅有 11 个字符，即使`Interval`为 20。</span><span class="sxs-lookup"><span data-stu-id="5479a-613">The last range ends at `Stop`, making it only 11 numbers long, even though `Interval` is 20.</span></span>  
  
 <span data-ttu-id="5479a-614">如果`Interval`为 1，范围是"`Number`:`Number`"，则无论什么`Start`和`Stop`参数。</span><span class="sxs-lookup"><span data-stu-id="5479a-614">If `Interval` is 1, the range is "`Number`:`Number`", regardless of the `Start` and `Stop` arguments.</span></span> <span data-ttu-id="5479a-615">例如，如果`Number`是 267，`Stop`为 1000，并`Interval`为 1，`Partition`返回"267:267".</span><span class="sxs-lookup"><span data-stu-id="5479a-615">For example, if `Number` is 267, `Stop` is 1000, and `Interval` is 1, `Partition` returns " 267: 267".</span></span>  
  
 <span data-ttu-id="5479a-616">`Partition` 构建数据库查询时，可以很有用。</span><span class="sxs-lookup"><span data-stu-id="5479a-616">`Partition` can be useful when constructing database queries.</span></span> <span data-ttu-id="5479a-617">可以创建显示订单数，例如用发票值从 1 到 1000，各种值范围内发生 1001年到 2000年等等的 SELECT 查询。</span><span class="sxs-lookup"><span data-stu-id="5479a-617">You can create a SELECT query that shows how many orders occur within various value ranges, for example with invoice values from 1 to 1000, 1001 to 2000, and so on.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-618">下面的示例设置范围的一系列几十年来从通过 2049年 1950 年。</span><span class="sxs-lookup"><span data-stu-id="5479a-618">The following example sets up a series of ranges for decades from 1950 through 2049.</span></span> <span data-ttu-id="5479a-619">它查找的值`year`内的适当的范围和返回`String`显示范围的值。</span><span class="sxs-lookup"><span data-stu-id="5479a-619">It locates the value of `year` within the appropriate range and returns a `String` value showing the range.</span></span> <span data-ttu-id="5479a-620">如果`year`的值为 1984，例如，`Partition`返回"1980: 1989"。</span><span class="sxs-lookup"><span data-stu-id="5479a-620">If `year` has a value of 1984, for example, `Partition` returns "1980:1989".</span></span>  
  
 [!code-vb[VbVbalrFunctions#45](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#45)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-621"><paramref name="Start" /> &lt; 0、<paramref name="Stop" /> &lt;= <paramref name="Start" /> 或 <paramref name="Interval" /> &lt; 1。</span><span class="sxs-lookup"><span data-stu-id="5479a-621"><paramref name="Start" /> &lt; 0, <paramref name="Stop" /> &lt;= <paramref name="Start" />, or <paramref name="Interval" /> &lt; 1.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="SaveSetting">
      <MemberSignature Language="C#" Value="public static void SaveSetting (string AppName, string Section, string Key, string Setting);" />
      <MemberSignature Language="ILAsm" Value=".method public static void SaveSetting(string AppName, string Section, string Key, string Setting) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.SaveSetting(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SaveSetting (AppName As String, Section As String, Key As String, Setting As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SaveSetting(System::String ^ AppName, System::String ^ Section, System::String ^ Key, System::String ^ Setting);" />
      <MemberSignature Language="F#" Value="static member SaveSetting : string * string * string * string -&gt; unit" Usage="Microsoft.VisualBasic.Interaction.SaveSetting (AppName, Section, Key, Setting)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="AppName" Type="System.String" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Section" Type="System.String" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Key" Type="System.String" Index="2" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Setting" Type="System.String" Index="3" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="AppName"><span data-ttu-id="5479a-622">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-622">Required.</span></span> <span data-ttu-id="5479a-623"><see langword="String" /> 表达式，包含应用该设置的应用程序或项目的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-623"><see langword="String" /> expression containing the name of the application or project to which the setting applies.</span></span></param>
        <param name="Section"><span data-ttu-id="5479a-624">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-624">Required.</span></span> <span data-ttu-id="5479a-625"><see langword="String" /> 表达式，包含在其中保存项设置的节的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-625"><see langword="String" /> expression containing the name of the section in which the key setting is being saved.</span></span></param>
        <param name="Key"><span data-ttu-id="5479a-626">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-626">Required.</span></span> <span data-ttu-id="5479a-627"><see langword="String" /> 表达式，包含将保存的项设置的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-627"><see langword="String" /> expression containing the name of the key setting being saved.</span></span></param>
        <param name="Setting"><span data-ttu-id="5479a-628">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-628">Required.</span></span> <span data-ttu-id="5479a-629">包含值的表达式，<paramref name="Key" /> 将被设置为该值。</span><span class="sxs-lookup"><span data-stu-id="5479a-629">Expression containing the value to which <paramref name="Key" /> is being set.</span></span></param>
        <summary><span data-ttu-id="5479a-630">在 Windows 注册表中保存或创建应用程序项。</span><span class="sxs-lookup"><span data-stu-id="5479a-630">Saves or creates an application entry in the Windows registry.</span></span> <span data-ttu-id="5479a-631">与 <see langword="My" /> 相比，<see langword="SaveSetting" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span><span class="sxs-lookup"><span data-stu-id="5479a-631">The <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="SaveSetting" />.</span></span> <span data-ttu-id="5479a-632">有关更多信息，请参见<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-632">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-633">`SaveSetting`函数将添加到密钥`HKEY_CURRENT_USER\Software\VB and VBA Program Settings`。</span><span class="sxs-lookup"><span data-stu-id="5479a-633">The `SaveSetting` function adds the key to `HKEY_CURRENT_USER\Software\VB and VBA Program Settings`.</span></span>  
  
 <span data-ttu-id="5479a-634">如果出于任何原因而无法保存项设置，将会出错。</span><span class="sxs-lookup"><span data-stu-id="5479a-634">If the key setting cannot be saved for any reason, an error occurs.</span></span>  
  
 <span data-ttu-id="5479a-635">`SaveSetting` 要求用户登录上将在操作由于`HKEY_LOCAL_USER`注册表项，直到用户以交互方式登录未处于活动状态。</span><span class="sxs-lookup"><span data-stu-id="5479a-635">`SaveSetting` requires that a user be logged on since it operates under the `HKEY_LOCAL_USER` registry key, which is not active until a user logs on interactively.</span></span>  
  
 <span data-ttu-id="5479a-636">若要从非交互式进程 （如 Mtx.exe) 访问的注册表设置应存储在`HKEY_LOCAL_MACHINE\Software\`或`HKEY_USER\DEFAULT\Software`注册表项。</span><span class="sxs-lookup"><span data-stu-id="5479a-636">Registry settings that are to be accessed from a non-interactive process (such as Mtx.exe) should be stored under either the `HKEY_LOCAL_MACHINE\Software\` or the `HKEY_USER\DEFAULT\Software` registry keys.</span></span>  
  
 <span data-ttu-id="5479a-637">`SaveSetting` 需要`Write`并`Create` <xref:System.Security.Permissions.RegistryPermission> 。</span><span class="sxs-lookup"><span data-stu-id="5479a-637">`SaveSetting` requires `Write` and `Create`<xref:System.Security.Permissions.RegistryPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-638">下面的示例首先使用`SaveSetting`函数来在 Windows 注册表中生成条目`MyApp`应用程序，然后使用`DeleteSetting`函数将其删除。</span><span class="sxs-lookup"><span data-stu-id="5479a-638">The following example first uses the `SaveSetting` function to make entries in the Windows registry for the `MyApp` application, and then uses the `DeleteSetting` function to remove them.</span></span>  
  
 [!code-vb[VbVbalrCatRef#56](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#56)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-639">未能创建注册表项，或用户没有登录。</span><span class="sxs-lookup"><span data-stu-id="5479a-639">Key registry could not be created, or user is not logged in.</span></span></exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.DeleteSetting(System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetAllSettings(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="T:System.Security.Permissions.RegistryPermission" />
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="5479a-640">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5479a-640">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Shell">
      <MemberSignature Language="C#" Value="public static int Shell (string Pathname, Microsoft.VisualBasic.AppWinStyle Style = Microsoft.VisualBasic.AppWinStyle.MinimizedFocus, bool Wait = false, int Timeout = -1);" FrameworkAlternate="netframework-1.1" />
      <MemberSignature Language="ILAsm" Value=".method public static int32 Shell(string Pathname, valuetype Microsoft.VisualBasic.AppWinStyle Style, bool Wait, int32 Timeout) cil managed" FrameworkAlternate="netframework-1.1" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberSignature Language="VB.NET" Value="Public Function Shell (Pathname As String, Optional Style As AppWinStyle = Microsoft.VisualBasic.AppWinStyle.MinimizedFocus, Optional Wait As Boolean = false, Optional Timeout As Integer = -1) As Integer" FrameworkAlternate="netframework-1.1" />
      <MemberSignature Language="C#" Value="public static int Shell (string PathName, Microsoft.VisualBasic.AppWinStyle Style = Microsoft.VisualBasic.AppWinStyle.MinimizedFocus, bool Wait = false, int Timeout = -1);" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberSignature Language="ILAsm" Value=".method public static int32 Shell(string PathName, valuetype Microsoft.VisualBasic.AppWinStyle Style, bool Wait, int32 Timeout) cil managed" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberSignature Language="VB.NET" Value="Public Function Shell (PathName As String, Optional Style As AppWinStyle = Microsoft.VisualBasic.AppWinStyle.MinimizedFocus, Optional Wait As Boolean = false, Optional Timeout As Integer = -1) As Integer" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberSignature Language="F#" Value="static member Shell : string * Microsoft.VisualBasic.AppWinStyle * bool * int -&gt; int" Usage="Microsoft.VisualBasic.Interaction.Shell (PathName, Style, Wait, Timeout)" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" FrameworkAlternate="netframework-2.0;netframework-1.1" />
      <MemberSignature Language="F#" Value="static member Shell : string * Microsoft.VisualBasic.AppWinStyle * bool * int -&gt; int" Usage="Microsoft.VisualBasic.Interaction.Shell (PathName, Style, Wait, Timeout)" FrameworkAlternate="netframework-2.0;netframework-1.1" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Pathname" Type="System.String" Index="0" FrameworkAlternate="netframework-1.1" />
        <Parameter Name="PathName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Style" Type="Microsoft.VisualBasic.AppWinStyle" Index="1" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Wait" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="Timeout" Type="System.Int32" Index="3" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="Pathname"><span data-ttu-id="5479a-641">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-641">Required.</span></span> <span data-ttu-id="5479a-642"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-642"><see langword="String" />.</span></span> <span data-ttu-id="5479a-643">要执行的程序的名称，以及所有必需的参数和命令行开关。</span><span class="sxs-lookup"><span data-stu-id="5479a-643">Name of the program to execute, together with any required arguments and command-line switches.</span></span> <span data-ttu-id="5479a-644"><paramref name="PathName" /> 也可以包含驱动器和目录路径或文件夹。</span><span class="sxs-lookup"><span data-stu-id="5479a-644"><paramref name="PathName" /> can also include the drive and the directory path or folder.</span></span>
<span data-ttu-id="5479a-645">如果不知道程序的路径，则可以使用 <see cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles" /> 进行定位。</span><span class="sxs-lookup"><span data-stu-id="5479a-645">If you do not know the path to the program, you can use the <see cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles" /> to locate it.</span></span> <span data-ttu-id="5479a-646">例如，你可以调用 <c>My.Computer.FileSystem.GetFiles("C:\", True, "testFile.txt")</c>，这将返回驱动器 C:\\ 上任意位置每个名为 <c>testFile.txt</c> 的文件的完整路径。</span><span class="sxs-lookup"><span data-stu-id="5479a-646">For example, you can call <c>My.Computer.FileSystem.GetFiles("C:\", True, "testFile.txt")</c>, which returns the full path of every file named <c>testFile.txt</c> anywhere on drive C:\\.</span></span></param>
        <param name="PathName"><span data-ttu-id="5479a-647">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-647">Required.</span></span> <span data-ttu-id="5479a-648"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-648"><see langword="String" />.</span></span> <span data-ttu-id="5479a-649">要执行的程序的名称，以及所有必需的参数和命令行开关。</span><span class="sxs-lookup"><span data-stu-id="5479a-649">Name of the program to execute, together with any required arguments and command-line switches.</span></span> <span data-ttu-id="5479a-650"><paramref name="PathName" /> 也可以包含驱动器和目录路径或文件夹。</span><span class="sxs-lookup"><span data-stu-id="5479a-650"><paramref name="PathName" /> can also include the drive and the directory path or folder.</span></span>  
 <span data-ttu-id="5479a-651">如果不知道程序的路径，则可以使用 <see cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles" /> 进行定位。</span><span class="sxs-lookup"><span data-stu-id="5479a-651">If you do not know the path to the program, you can use the <see cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles" /> to locate it.</span></span> <span data-ttu-id="5479a-652">例如，你可以调用 <c>My.Computer.FileSystem.GetFiles("C:\", True, "testFile.txt")</c>，这将返回驱动器 C:\\ 上任意位置每个名为 <c>testFile.txt</c> 的文件的完整路径。</span><span class="sxs-lookup"><span data-stu-id="5479a-652">For example, you can call <c>My.Computer.FileSystem.GetFiles("C:\", True, "testFile.txt")</c>, which returns the full path of every file named <c>testFile.txt</c> anywhere on drive C:\\.</span></span></param>
        <param name="Style"><span data-ttu-id="5479a-653">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-653">Optional.</span></span> <span data-ttu-id="5479a-654"><see langword="AppWinStyle" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-654"><see langword="AppWinStyle" />.</span></span> <span data-ttu-id="5479a-655">从 <see cref="T:Microsoft.VisualBasic.AppWinStyle" /> 中选择的一个值，该值指定将要在其中运行程序的窗口的样式。</span><span class="sxs-lookup"><span data-stu-id="5479a-655">A value chosen from the <see cref="T:Microsoft.VisualBasic.AppWinStyle" /> specifying the style of the window in which the program is to run.</span></span> <span data-ttu-id="5479a-656">如果省略 <paramref name="Style" />，<see langword="Shell" /> 将使用 <see langword="AppWinStyle.MinimizedFocus" /> 以最小化方式启动该程序并获得焦点。</span><span class="sxs-lookup"><span data-stu-id="5479a-656">If <paramref name="Style" /> is omitted, <see langword="Shell" /> uses <see langword="AppWinStyle.MinimizedFocus" />, which starts the program minimized and with focus.</span></span></param>
        <param name="Wait"><span data-ttu-id="5479a-657">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-657">Optional.</span></span> <span data-ttu-id="5479a-658"><see langword="Boolean" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-658"><see langword="Boolean" />.</span></span> <span data-ttu-id="5479a-659">一个指示 <see langword="Shell" /> 函数是否应等待程序完成的值。</span><span class="sxs-lookup"><span data-stu-id="5479a-659">A value indicating whether the <see langword="Shell" /> function should wait for completion of the program.</span></span> <span data-ttu-id="5479a-660">如果省略 <paramref name="Wait" />，则 <see langword="Shell" /> 将使用 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-660">If <paramref name="Wait" /> is omitted, <see langword="Shell" /> uses <see langword="False" />.</span></span></param>
        <param name="Timeout"><span data-ttu-id="5479a-661">可选。</span><span class="sxs-lookup"><span data-stu-id="5479a-661">Optional.</span></span> <span data-ttu-id="5479a-662"><see langword="Integer" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-662"><see langword="Integer" />.</span></span> <span data-ttu-id="5479a-663">如果 <paramref name="Wait" /> 为 <see langword="True" />，则为等待完成的毫秒数。</span><span class="sxs-lookup"><span data-stu-id="5479a-663">The number of milliseconds to wait for completion if <paramref name="Wait" /> is <see langword="True" />.</span></span> <span data-ttu-id="5479a-664">如果省略 <paramref name="Timeout" />，则 <see langword="Shell" /> 使用 -1，表示没有超时设置并且 <see langword="Shell" /> 到程序结束时才返回。</span><span class="sxs-lookup"><span data-stu-id="5479a-664">If <paramref name="Timeout" /> is omitted, <see langword="Shell" /> uses -1, which means there is no timeout and <see langword="Shell" /> does not return until the program finishes.</span></span> <span data-ttu-id="5479a-665">因此，如果省略 <paramref name="Timeout" /> 或将其设置为 -1，则 <see langword="Shell" /> 可能永远不会将控制返回给您的程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-665">Therefore, if you omit <paramref name="Timeout" /> or set it to -1, it is possible that <see langword="Shell" /> might never return control to your program.</span></span></param>
        <summary><span data-ttu-id="5479a-666">运行一个可执行程序，并且如果该程序仍在运行则返回一个包含该程序的进程 ID 的整数。</span><span class="sxs-lookup"><span data-stu-id="5479a-666">Runs an executable program and returns an integer containing the program's process ID if it is still running.</span></span></summary>
        <returns><span data-ttu-id="5479a-667">一个整数，包含该程序仍在运行时的进程 ID。</span><span class="sxs-lookup"><span data-stu-id="5479a-667">An integer containing the program's process ID if it is still running.</span></span> <span data-ttu-id="5479a-668">如果该程序已完成执行，则为 0。</span><span class="sxs-lookup"><span data-stu-id="5479a-668">0 if the program already finished executing.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-669">返回值`Shell`函数取决于程序是否在名为`PathName`仍在执行时`Shell`返回。</span><span class="sxs-lookup"><span data-stu-id="5479a-669">The return value of the `Shell` function depends on whether the program named in `PathName` is still executing when `Shell` returns.</span></span> <span data-ttu-id="5479a-670">如果您设置`Wait`到`True`并在程序完成之前超时到期，`Shell`返回零。</span><span class="sxs-lookup"><span data-stu-id="5479a-670">If you set `Wait` to `True` and the program finishes before the timeout expires, `Shell` returns zero.</span></span> <span data-ttu-id="5479a-671">如果在超时到期，或省略`Wait`或将其设置为`False`，`Shell`返回该程序的进程 ID。</span><span class="sxs-lookup"><span data-stu-id="5479a-671">If the timeout expires, or if you omit `Wait` or set it to `False`, `Shell` returns the process ID of the program.</span></span> <span data-ttu-id="5479a-672">进程 ID 是标识正在运行的程序的唯一编号。</span><span class="sxs-lookup"><span data-stu-id="5479a-672">The process ID is a unique number that identifies the running program.</span></span>  
  
## <a name="failure-to-start"></a><span data-ttu-id="5479a-673">启动失败</span><span class="sxs-lookup"><span data-stu-id="5479a-673">Failure to Start</span></span>  
 <span data-ttu-id="5479a-674">如果`Shell`函数不能启动指定的程序，<xref:System.IO.FileNotFoundException>发生错误。</span><span class="sxs-lookup"><span data-stu-id="5479a-674">If the `Shell` function cannot start the named program, a <xref:System.IO.FileNotFoundException> error occurs.</span></span> <span data-ttu-id="5479a-675">可以这样做，例如，当您尝试运行 16 位程序，如`command.com`，从应用程序中使用<xref:System.Windows.Forms?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="5479a-675">This can happen, for example, when you attempt to run a 16-bit program, such as `command.com`, from an application using <xref:System.Windows.Forms?displayProperty=nameWithType>.</span></span> <span data-ttu-id="5479a-676">有关解决方法，可以运行调用所需的 16 位程序的 32 位程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-676">For a workaround, you can run a 32-bit program that calls the desired 16-bit program.</span></span> <span data-ttu-id="5479a-677">情况下`command.com`，可以运行`cmd.exe`作为替代方法。</span><span class="sxs-lookup"><span data-stu-id="5479a-677">In the case of `command.com`, you can run `cmd.exe` as an alternative.</span></span>  
  
## <a name="waiting-for-completion"></a><span data-ttu-id="5479a-678">等待完成</span><span class="sxs-lookup"><span data-stu-id="5479a-678">Waiting for Completion</span></span>  
 <span data-ttu-id="5479a-679">默认情况下，`Shell`函数以异步方式运行该程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-679">By default, the `Shell` function runs the program asynchronously.</span></span> <span data-ttu-id="5479a-680">这意味着程序入门`Shell`函数可能无法完成执行之后的语句之前`Shell`函数执行的。</span><span class="sxs-lookup"><span data-stu-id="5479a-680">This means that a program started with the `Shell` function might not finish executing before the statements following the `Shell` function are executed.</span></span> <span data-ttu-id="5479a-681">如果你想要等待计划完成，然后您再继续，请设置`Wait`到`True`。</span><span class="sxs-lookup"><span data-stu-id="5479a-681">If you want to wait for the program to finish before you continue, set `Wait` to `True`.</span></span>  
  
## <a name="determining-the-exit-code"></a><span data-ttu-id="5479a-682">确定退出代码</span><span class="sxs-lookup"><span data-stu-id="5479a-682">Determining the Exit Code</span></span>  
 <span data-ttu-id="5479a-683">一个过程可以返回*退出代码*终止时。</span><span class="sxs-lookup"><span data-stu-id="5479a-683">A process can return an *exit code* when it terminates.</span></span> <span data-ttu-id="5479a-684">但是，不能使用`Shell`来检索此退出代码，因为`Shell`如果等待终止，则返回零，也因为进程运行在不同的对象中`Shell`。</span><span class="sxs-lookup"><span data-stu-id="5479a-684">However, you cannot use `Shell` to retrieve this exit code, because `Shell` returns zero if it waits for termination, and also because the process runs in a different object from `Shell`.</span></span>  
  
 <span data-ttu-id="5479a-685">若要检索从进程的退出代码，必须编写您自己的代码以启动过程并等待终止。</span><span class="sxs-lookup"><span data-stu-id="5479a-685">To retrieve the exit code from a process, you must write your own code to initiate the process and wait for termination.</span></span> <span data-ttu-id="5479a-686">下面的示例演示如何启动过程，等待其终止，并检索其退出代码。</span><span class="sxs-lookup"><span data-stu-id="5479a-686">The following example shows how to initiate a process, wait for it to terminate, and retrieve its exit code.</span></span>  
  
```vb  
Dim procID As Integer  
Dim newProc As Diagnostics.Process  
newProc = Diagnostics.Process.Start("C:\WINDOWS\NOTEPAD.EXE")  
procID = newProc.Id  
newProc.WaitForExit()  
Dim procEC As Integer = -1  
If newProc.HasExited Then  
    procEC = newProc.ExitCode  
End If  
MsgBox("Process with ID " & CStr(ProcID) & _  
    " terminated with exit code " & CStr(procEC))  
```  
  
## <a name="protecting-the-file-specification"></a><span data-ttu-id="5479a-687">保护的文件规范</span><span class="sxs-lookup"><span data-stu-id="5479a-687">Protecting the File Specification</span></span>  
 <span data-ttu-id="5479a-688">始终应将整个路径和文件名规范括在引号内，如以下示例所示。</span><span class="sxs-lookup"><span data-stu-id="5479a-688">You should always enclose the entire path and file specification in quotation marks, as the following example shows.</span></span>  
  
```vb  
ID = Shell("""C:\Program Files\display.exe"" -a -q", , True, 100000)  
```  
  
 <span data-ttu-id="5479a-689">每对相邻两个双引号 (`" "`) 在字符串文本解释为一个双引号字符在字符串中。</span><span class="sxs-lookup"><span data-stu-id="5479a-689">Each pair of adjacent double quotation marks (`" "`) within the string literal is interpreted as one double quotation character in the string.</span></span> <span data-ttu-id="5479a-690">因此，前面的示例中显示的下列字符串`Shell`函数：</span><span class="sxs-lookup"><span data-stu-id="5479a-690">Therefore, the preceding example presents the following string to the `Shell` function:</span></span>  
  
```console  
"C:\Program Files\display.exe" -a -q  
```  
  
 <span data-ttu-id="5479a-691">如果您没有用引号括起来的路径，Windows 将查找名为的文件`Program.exe`在 C:\ 目录中，而不是`display.exe`C:\Program Files 目录中。</span><span class="sxs-lookup"><span data-stu-id="5479a-691">If you did not have the path enclosed in quotation marks, Windows would look for a file called `Program.exe` in the C:\ directory, instead of `display.exe` in the C:\Program Files directory.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="5479a-692">如果不要将路径和文件名规范括在引号中，如果该文件名或路径节点中包含空格则安全风险。</span><span class="sxs-lookup"><span data-stu-id="5479a-692">If you do not enclose the path and file specification in quotation marks, there is a security risk if the file name or a path node contains spaces.</span></span> <span data-ttu-id="5479a-693">在前面的示例中，路径节点`\Program Files`中包含空格。</span><span class="sxs-lookup"><span data-stu-id="5479a-693">In the preceding example, the path node `\Program Files` includes a space.</span></span> <span data-ttu-id="5479a-694">如果规范未在单引号中，名为的程序内`Program.exe`已安装在 c:\\，例如由非法篡改，Windows 将执行它而不是`display.exe`。</span><span class="sxs-lookup"><span data-stu-id="5479a-694">If the specification were not inside quotation marks and a program named `Program.exe` had been installed in C:\\, for example by illicit tampering, Windows would execute it instead of `display.exe`.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="5479a-695">`Shell`函数需要非托管的代码的权限，这可能会影响在部分信任情况下执行。</span><span class="sxs-lookup"><span data-stu-id="5479a-695">The `Shell` function requires unmanaged code permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="5479a-696">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>并[代码访问权限](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="5479a-696">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](https://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-697">下面的示例使用`Shell`函数运行用户指定的应用程序。</span><span class="sxs-lookup"><span data-stu-id="5479a-697">The following example uses the `Shell` function to run an application specified by the user.</span></span> <span data-ttu-id="5479a-698">指定<xref:Microsoft.VisualBasic.AppWinStyle.NormalFocus?displayProperty=nameWithType>为第二个参数将应用程序打开在正常大小，使其具有焦点。</span><span class="sxs-lookup"><span data-stu-id="5479a-698">Specifying <xref:Microsoft.VisualBasic.AppWinStyle.NormalFocus?displayProperty=nameWithType> as the second argument opens the application in normal size and gives it the focus.</span></span>  
  
 [!code-vb[VbVbalrFunctions#47](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#47)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-699"><paramref name="Style" /> 不在 0 到 9（包含 0 和 9）范围内。</span><span class="sxs-lookup"><span data-stu-id="5479a-699"><paramref name="Style" /> is not within range 0 through 9, inclusive.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="5479a-700"><see langword="Shell" /> 找不到 <paramref name="PathName" /> 文件。</span><span class="sxs-lookup"><span data-stu-id="5479a-700"><see langword="Shell" /> cannot find the <paramref name="PathName" /> file.</span></span></exception>
        <exception cref="T:System.NullReferenceException"><span data-ttu-id="5479a-701"><paramref name="PathName" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="5479a-701"><paramref name="PathName" /> is <see langword="Nothing" />.</span></span></exception>
        <altmember cref="T:Microsoft.VisualBasic.AppWinStyle" />
        <altmember cref="T:System.ArgumentException" />
        <altmember cref="T:System.IO.FileNotFoundException" />
        <altmember cref="T:System.NullReferenceException" />
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles" />
        <altmember cref="Overload:Microsoft.VisualBasic.Interaction.AppActivate" />
      </Docs>
    </Member>
    <Member MemberName="Switch">
      <MemberSignature Language="C#" Value="public static object Switch (params object[] VarExpr);" />
      <MemberSignature Language="ILAsm" Value=".method public static object Switch(object[] VarExpr) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Switch(System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Function Switch (ParamArray VarExpr As Object()) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ Switch(... cli::array &lt;System::Object ^&gt; ^ VarExpr);" />
      <MemberSignature Language="F#" Value="static member Switch : obj[] -&gt; obj" Usage="Microsoft.VisualBasic.Interaction.Switch VarExpr" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>7.0.5000.0</AssemblyVersion>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="VarExpr" Type="System.Object[]" Index="0" FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <Attributes>
            <Attribute FrameworkAlternate="netframework-1.1">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="VarExpr"><span data-ttu-id="5479a-702">必需。</span><span class="sxs-lookup"><span data-stu-id="5479a-702">Required.</span></span> <span data-ttu-id="5479a-703"><see langword="Object" /> 参数数组。</span><span class="sxs-lookup"><span data-stu-id="5479a-703"><see langword="Object" /> parameter array.</span></span> <span data-ttu-id="5479a-704">必须具有偶数个元素。</span><span class="sxs-lookup"><span data-stu-id="5479a-704">Must have an even number of elements.</span></span> <span data-ttu-id="5479a-705">可以提供以逗号分隔的 <see langword="Object" /> 变量或表达式的列表，或一维 <see langword="Object" /> 元素数组。</span><span class="sxs-lookup"><span data-stu-id="5479a-705">You can supply a list of <see langword="Object" /> variables or expressions separated by commas, or a single-dimensional array of <see langword="Object" /> elements.</span></span></param>
        <summary><span data-ttu-id="5479a-706">计算表达式列表，并返回与列表中第一个为 <see langword="Object" /> 的表达式对应的 <see langword="True" /> 值。</span><span class="sxs-lookup"><span data-stu-id="5479a-706">Evaluates a list of expressions and returns an <see langword="Object" /> value corresponding to the first expression in the list that is <see langword="True" />.</span></span></summary>
        <returns><span data-ttu-id="5479a-707">计算表达式列表，并返回与列表中第一个为 <see langword="Object" /> 的表达式对应的 <see langword="True" /> 值。</span><span class="sxs-lookup"><span data-stu-id="5479a-707">Evaluates a list of expressions and returns an <see langword="Object" /> value corresponding to the first expression in the list that is <see langword="True" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="5479a-708">自变量提供给`VarExpr`成对的表达式和值组成。</span><span class="sxs-lookup"><span data-stu-id="5479a-708">The argument supplied to `VarExpr` consists of paired expressions and values.</span></span> <span data-ttu-id="5479a-709">`Switch`函数计算奇数表达式，从最低到最高的索引，在`VarExpr`，并返回与第一个表达式的计算结果为关联的偶数值`True`。</span><span class="sxs-lookup"><span data-stu-id="5479a-709">The `Switch` function evaluates the odd-numbered expressions from lowest to highest index in `VarExpr`, and returns the even-numbered value associated with the first expression that evaluates to `True`.</span></span> <span data-ttu-id="5479a-710">例如，如果`VarExpr(0)`是`True`，`Switch`返回`VarExpr(1)`，并且如果`VarExpr(0)`是`False`但`VarExpr(2)`是`True`，`Switch`返回`VarExpr(3)`，依次类推。</span><span class="sxs-lookup"><span data-stu-id="5479a-710">For example, if `VarExpr(0)` is `True`, `Switch` returns `VarExpr(1)`, and if `VarExpr(0)` is `False` but `VarExpr(2)` is `True`, `Switch` returns `VarExpr(3)`, and so on.</span></span>  
  
 <span data-ttu-id="5479a-711">如果未提供`VarExpr`参数，`Switch`返回`Nothing`。</span><span class="sxs-lookup"><span data-stu-id="5479a-711">If you do not supply the `VarExpr` argument, `Switch` returns `Nothing`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5479a-712">参数列表中的表达式可以包括函数调用。</span><span class="sxs-lookup"><span data-stu-id="5479a-712">The expressions in the argument list can include function calls.</span></span> <span data-ttu-id="5479a-713">作为准备为调用的参数列表的一部分`Switch`，Visual Basic 编译器在每个表达式中调用的每个函数。</span><span class="sxs-lookup"><span data-stu-id="5479a-713">As part of preparing the argument list for the call to `Switch`, the Visual Basic compiler calls every function in every expression.</span></span> <span data-ttu-id="5479a-714">这意味着您不能依赖于特定函数参数列表中前面的表达式为时未调用`True`。</span><span class="sxs-lookup"><span data-stu-id="5479a-714">This means that you cannot rely on a particular function not being called if an expression earlier in the argument list is `True`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="5479a-715">下面的示例使用`Switch`函数以返回与匹配的城市名称的语言的名称。</span><span class="sxs-lookup"><span data-stu-id="5479a-715">The following example uses the `Switch` function to return the name of a language that matches the name of a city.</span></span> <span data-ttu-id="5479a-716">该配置要求`Option Strict`是`Off`。</span><span class="sxs-lookup"><span data-stu-id="5479a-716">It requires that `Option Strict` be `Off`.</span></span>  
  
 [!code-vb[VbVbalrFunctions#48](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#48)]  
  
 <span data-ttu-id="5479a-717">因为<xref:System.Diagnostics>命名空间还包含一个名为类<xref:System.Diagnostics.Switch>，调用`Switch`函数必须使用限定<xref:Microsoft.VisualBasic>命名空间。</span><span class="sxs-lookup"><span data-stu-id="5479a-717">Because the <xref:System.Diagnostics> namespace also contains a class called <xref:System.Diagnostics.Switch>, a call to the `Switch` function must be qualified with the <xref:Microsoft.VisualBasic> namespace.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="5479a-718">参数数目为奇数。</span><span class="sxs-lookup"><span data-stu-id="5479a-718">Number of arguments is odd.</span></span></exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Choose(System.Double,System.Object[])" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.IIf(System.Boolean,System.Object,System.Object)" />
        <related type="Article" href="~/docs/visual-basic/language-reference/statements/select-case-statement.md"><span data-ttu-id="5479a-719">Select...Case 语句 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5479a-719">Select...Case Statement (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/programming-guide/language-features/procedures/parameter-arrays.md"><span data-ttu-id="5479a-720">参数数组</span><span class="sxs-lookup"><span data-stu-id="5479a-720">Parameter Arrays</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>